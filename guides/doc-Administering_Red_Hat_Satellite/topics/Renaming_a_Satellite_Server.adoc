[[sect-Red_Hat_Satellite-Administering_Red_Hat_Satellite-Renaming_a_Satellite_Server]]
=== Renaming Satellite Server

The host name of Satellite{nbsp}Server is used by Satellite{nbsp}Server components, all Capsule{nbsp}Servers, and hosts registered to it for communication. This procedure ensures that you update all references to the new host name.

If you use external authentication, you must reconfigure Satellite Server for external authentication after you run the `satellite-change-hostname` script. The `satellite-change-hostname` script breaks external authentication for Satellite Server. For more information about configuring external authentication, see xref:chap-Red_Hat_Satellite-Administering_Red_Hat_Satellite-Configuring_External_Authentication[].

If you use virt-who, you must update the virt-who configuration files with the new host name after you run the `satellite-change-hostname` script. For more information, see link:https://access.redhat.com/documentation/en-us/red_hat_satellite/{ProductVersion}/html/configuring_virtual_machine_subscriptions_in_red_hat_satellite/troubleshooting-virt-who#modifying-virt-who-configuration_vm-subs-satellite[Modifying a virt-who Configuration] in _Configuring Virtual Machine Subscriptions in Red Hat Satellite_.

.Prerequisites

* Backup Satellite{nbsp}Server. The `satellite-change-hostname` script makes irreversible changes to Satellite{nbsp}Server. If the renaming process is not successful, you must restore it from a backup. For more information, see xref:backing-up-satellite-server-and-capsule-server[].

* Optional: If Satellite{nbsp}Server has a custom SSL certificate installed, a new certificate must be obtained for the host's new name. For more information, see https://access.redhat.com/documentation/en-us/red_hat_satellite/{ProductVersion}/html/installing_satellite_server_from_a_connected_network/performing-additional-configuration#configuring-satellite-custom-server-certificate_satellite[Configuring Satellite Server with a Custom SSL Certificate] in _Installing Satellite Server from a Connected Network_.

.Procedure

. On Satellite{nbsp}Server, choose the appropriate method to run the `satellite-change-hostname` script, providing the new host name and Satellite credentials:
+
* If your Satellite Server is installed with default self-signed SSL certificates, enter the following command:
+
[options="nowrap" subs="+quotes,verbatim"]
----
# satellite-change-hostname _new_satellite_ \
--username _admin_ \
--password _password_
----

* If your Satellite Server is installed with custom SSL certificates:
+
[options="nowrap" subs="+quotes,verbatim"]
----
# satellite-change-hostname _new_satellite_ \
--username _admin_ \
--password _password_ \
--custom-cert "/root/ownca/test.com/test.com.crt" \
--custom-key "/root/ownca/test.com/test.com.key"
----

. Optional: If you have created a custom SSL certificate for the new Satellite{nbsp}Server host name, run the Satellite installation script to install the certificate. For more information about installing a custom SSL certificate, see https://access.redhat.com/documentation/en-us/red_hat_satellite/{ProductVersion}/html/installing_satellite_server_from_a_connected_network/performing-additional-configuration#deploying-a-custom-ssl-certificate-to-satellite-server_satellite[Deploying a Custom SSL Certificate to Satellite Server] in _Installing Satellite Server from a Connected Network_.

. On all Satellite clients, enter the following commands to reinstall the bootstrap RPM, reregister clients, and refresh their subscriptions.
+
You can use remote execution feature to perform this step. For more information, see https://access.redhat.com/documentation/en-us/red_hat_satellite/{ProductVersion}/html/managing_hosts/running_jobs_on_hosts#sect-Managing_Hosts-Configuring_and_Running_Remote_Commands[Configuring and Running Remote Jobs] in _Managing Hosts_.
+
[options="nowrap" subs="+quotes,verbatim"]
----
# yum remove -y katello-ca-consumer*

# rpm -Uvh http://_new-satellite.example.com_/pub/katello-ca-consumer-latest.noarch.rpm

# subscription-manager register \
--org="_Default_Organization_" \
--environment="_Library_" \
--force

# subscription-manager refresh
----

. On all Capsule{nbsp}Servers, run the Satellite installation script to update references to the new host name:
+
[options="nowrap" subs="+quotes,verbatim"]
----
# satellite-installer \
--foreman-proxy-content-parent-fqdn _new-satellite.example.com_ \
--foreman-proxy-foreman-base-url https://_new-satellite.example.com_ \
--foreman-proxy-trusted-hosts _new-satellite.example.com_
----

. On Satellite{nbsp}Server, list all Capsule{nbsp}Servers:
+
----
# hammer capsule list
----

. On Satellite{nbsp}Server, synchronize content for each Capsule{nbsp}Server:
+
[options="nowrap" subs="+quotes,verbatim"]
----
# hammer capsule content synchronize \
--id _capsule_id_number_
----
