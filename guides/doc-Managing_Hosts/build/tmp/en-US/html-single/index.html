<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="chrometwo"><head><title>Managing Hosts</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css"/><meta name="generator" content="publican v4.3.2"/><meta name="description" content="This guide describes how to configure and work with hosts in a Red Hat Satellite environment. Before continuing with this workflow you must have successfully installed a Red Hat Satellite 6 Server and any required Capsule Servers."/><link rel="next" href="#overview-of-hosts-in-satellite" title="Chapter 1. Overview of Hosts in Red Hat Satellite 6"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><script type="text/javascript" src="Common_Content/scripts/jquery-1.7.1.min.js"> </script><script type="text/javascript" src="Common_Content/scripts/utils.js"> </script><script type="text/javascript" src="Common_Content/scripts/highlight.js/highlight.pack.js"> </script></head><body><div id="chrometwo"><div id="main"><div xml:lang="en-US" class="book" id="idm45628302630208"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Satellite</span> <span class="productnumber">6.7</span></div><div><h1 class="title">Managing Hosts</h1></div><div><h2 class="subtitle">A guide to managing hosts in a Red Hat Satellite 6 environment.</h2></div><div><div xml:lang="en-US" class="authorgroup"><div class="author"><h3 class="author"><span class="firstname">Red Hat Satellite</span> <span class="surname">Documentation Team</span></h3><code class="email"><a class="email" href="mailto:satellite-doc-list@redhat.com">satellite-doc-list@redhat.com</a></code></div></div></div><div><a href="#idm45628280709504">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				This guide describes how to configure and work with hosts in a Red Hat Satellite environment. Before continuing with this workflow you must have successfully installed a Red Hat Satellite 6 Server and any required Capsule Servers.
			</div></div></div></div><hr/></div><div class="toc"><ul class="toc"><li><span class="chapter"><a href="#overview-of-hosts-in-satellite">1. Overview of Hosts in Red Hat Satellite 6</a></span></li><li><span class="chapter"><a href="#Administering_Hosts">2. Administering Hosts</a></span><ul><li><span class="section"><a href="#creating-a-host-in-satellite">2.1. Creating a Host in Red Hat Satellite</a></span></li><li><span class="section"><a href="#editing-the-system-purpose-of-a-host">2.2. Editing the System Purpose of a Host</a></span></li><li><span class="section"><a href="#changing-a-module-stream-for-a-host">2.3. Changing a Module Stream for a Host</a></span></li><li><span class="section"><a href="#creating-a-host-group">2.4. Creating a Host Group</a></span></li><li><span class="section"><a href="#creating-a-host-group-for-each-lifecycle-environment">2.5. Creating a Host Group for Each LifeCycle Environment</a></span></li><li><span class="section"><a href="#changing-the-group-of-a-host">2.6. Changing the Group of a Host</a></span></li><li><span class="section"><a href="#changing-the-environment-of-a-host">2.7. Changing the Environment of a Host</a></span></li><li><span class="section"><a href="#changing-the-managed-status-of-a-host">2.8. Changing the Managed Status of a Host</a></span></li><li><span class="section"><a href="#assinging-a-host-to-a-specific-organization">2.9. Assigning a Host to a Specific Organization</a></span></li><li><span class="section"><a href="#assigning-a-host-to-a-specific-location">2.10. Assigning a Host to a Specific Location</a></span></li><li><span class="section"><a href="#removing-a-host-from-satellite">2.11. Removing a Host from Red Hat Satellite</a></span></li></ul></li><li><span class="chapter"><a href="#Registering_Hosts">3. Registering Hosts</a></span><ul><li><span class="section"><a href="#registering-a-host-to-satellite">3.1. Registering a Host to Red Hat Satellite</a></span></li><li><span class="section"><a href="#registering-an-atomic-host-to-satellite">3.2. Registering an Atomic Host to Red Hat Satellite</a></span></li><li><span class="section"><a href="#registering-a-host-to-satellite-using-the-bootstrap-script">3.3. Registering a Host to Red Hat Satellite Using The Bootstrap Script</a></span><ul><li><span class="section"><a href="#setting-permissions-for-the-bootstrap-script">3.3.1. Setting Permissions for the Bootstrap Script</a></span></li><li><span class="section"><a href="#advanced-bootstrap-script-configuration">3.3.2. Advanced Bootstrap Script Configuration</a></span></li></ul></li><li><span class="section"><a href="#installing-the-katello-agent_managing-hosts">3.4. Installing the Katello Agent</a></span></li><li><span class="section"><a href="#installing-tracer">3.5. Installing Tracer</a></span></li><li><span class="section"><a href="#installing-and-configuring-the-puppet-agent">3.6. Installing and Configuring the Puppet Agent</a></span></li></ul></li><li><span class="chapter"><a href="#Adding_Network_Interfaces">4. Adding Network Interfaces</a></span><ul><li><span class="section"><a href="#adding-a-physical-interface">4.1. Adding a Physical Interface</a></span></li><li><span class="section"><a href="#adding-a-virtual-interface">4.2. Adding a Virtual Interface</a></span></li><li><span class="section"><a href="#adding-a-bonded-interface">4.3. Adding a Bonded Interface</a></span></li><li><span class="section"><a href="#adding-a-bmc-interface">4.4. Adding a Baseboard Management Controller (BMC) Interface</a></span></li></ul></li><li><span class="chapter"><a href="#host_management_and_monitoring_using_red_hat_web_console">5. Host Management and Monitoring Using Red Hat Web Console</a></span><ul><li><span class="section"><a href="#integrating_satellite_with_red_hat_web_console">5.1. Integrating Satellite with Red Hat Web Console</a></span></li><li><span class="section"><a href="#managing_and_monitoring_hosts_using_red_hat_web_console">5.2. Managing and Monitoring Hosts Using Red Hat Web Console</a></span></li></ul></li><li><span class="chapter"><a href="#Monitoring_Hosts">6. Monitoring Hosts Using Red Hat Insights</a></span><ul><li><span class="section"><a href="#using-insights-with-satellite-hosts">6.1. Using Red Hat Insights with Hosts in Satellite</a></span></li><li><span class="section"><a href="#creating-an-insights-plan">6.2. Creating an Insights Plan for Hosts</a></span></li></ul></li><li><span class="chapter"><a href="#using_report_templates">7. Using Report Templates to Monitor Hosts</a></span><ul><li><span class="section"><a href="#chap-Managing_Hosts-Generating_Host_Monitoring_Reports">7.1. Generating Host Monitoring Reports</a></span></li><li><span class="section"><a href="#proc_creating_a_report_template">7.2. Creating a Report Template</a></span></li><li><span class="section"><a href="#exporting_report_templates">7.3. Exporting Report Templates</a></span></li><li><span class="section"><a href="#proc_exporting_report_templates_api">7.4. Exporting Report Templates Using the Satellite API</a></span></li><li><span class="section"><a href="#importing_report_templates">7.5. Importing Report Templates</a></span></li><li><span class="section"><a href="#proc_importing_report_templates_api">7.6. Importing Report Templates Using the Satellite API</a></span></li><li><span class="section"><a href="#proc_creating_a_report_table_to_monitor_entitlements">7.7. Creating a Report Template to Monitor Entitlements</a></span></li><li><span class="section"><a href="#con_report_templates_safe_mode">7.8. Report Template Safe Mode</a></span></li></ul></li><li><span class="chapter"><a href="#chap-Red_Hat_Satellite-Managing_Hosts-Configuring_Host_Collections">8. Configuring Host Collections</a></span><ul><li><span class="section"><a href="#sect-Red_Hat_Satellite-Managing_Hosts-Creating_a_Host_Collection">8.1. Creating a Host Collection</a></span></li><li><span class="section"><a href="#sect-Red_Hat_Satellite-Managing_Hosts-Cloning_a_Host_Collection">8.2. Cloning a Host Collection</a></span></li><li><span class="section"><a href="#sect-Red_Hat_Satellite-Managing_Hosts-Removing_a_Host_Collection">8.3. Removing a Host Collection</a></span></li><li><span class="section"><a href="#sect-Red_Hat_Satellite-Managing_Hosts-Adding_a_Host_to_a_Host_Collection">8.4. Adding a Host to a Host Collection</a></span></li><li><span class="section"><a href="#sect-Red_Hat_Satellite-Managing_Hosts-Removing_a_Host_from_a_Host_Collection">8.5. Removing a Host from a Host Collection</a></span></li><li><span class="section"><a href="#sect-Red_Hat_Satellite-Managing_Hosts-Configuring_Host_Collections-Adding_Content_to_a_Host_Collection">8.6. Adding Content to a Host Collection</a></span><ul><li><span class="section"><a href="#sect-Red_Hat_Satellite-Managing_Hosts-Adding_Packages_to_a_Host_Collection">8.6.1. Adding Packages to a Host Collection</a></span></li><li><span class="section"><a href="#sect-Red_Hat_Satellite-Managing_Hosts-Adding_Errata_to_a_Host_Collection">8.6.2. Adding Errata to a Host Collection</a></span></li></ul></li><li><span class="section"><a href="#sect-Red_Hat_Satellite-Managing_Hosts-Removing_Content_from_a_Host_Collection">8.7. Removing Content from a Host Collection</a></span></li><li><span class="section"><a href="#sect-Red_Hat_Satellite-Managing_Hosts-Changing_the_Life_Cycle_Environment_or_Content_View_of_a_Host_Collection">8.8. Changing the Life Cycle Environment or Content View of a Host Collection</a></span></li></ul></li><li><span class="chapter"><a href="#Using_Ansible_Roles">9. Using Ansible Roles</a></span><ul><li><span class="section"><a href="#assigning-ansible-roles-to-an-existing-host">9.1. Assigning Ansible Roles to an Existing Host</a></span></li><li><span class="section"><a href="#running-ansible-roles-on-a-host">9.2. Running Ansible Roles on a Host</a></span></li><li><span class="section"><a href="#assigning-an-ansible-role-to-a-host-group">9.3. Assigning an Ansible Role to a Host Group</a></span></li><li><span class="section"><a href="#running-ansible-roles-on-a-host-group">9.4. Running Ansible Roles on a Host Group</a></span></li></ul></li><li><span class="chapter"><a href="#Running_Jobs_on_Hosts">10. Running Jobs on Hosts</a></span><ul><li><span class="section"><a href="#sect-Managing_Hosts-Choosing_a_Satellite_Capsule_for_Remote_Execution">10.1. How Satellite Selects Capsule for Remote Execution</a></span><ul><li><span class="section"><a href="#configuring_the_fallback_to_any_capsule_remote_execution_setting_in_satellite">10.1.1. Configuring the Fallback to Any Capsule Remote Execution Setting in Satellite</a></span></li><li><span class="section"><a href="#configuring_the_global_capsule_remote_execution_setting_in_satellite">10.1.2. Configuring the Global Capsule Remote Execution Setting in Satellite</a></span></li></ul></li><li><span class="section"><a href="#configuring_satellite_to_use_an_alternative_directory_to_execute_remote_jobs_on_clients">10.2. Configuring Satellite to Use an Alternative Directory to Execute Remote Jobs on Clients</a></span></li><li><span class="section"><a href="#sect-Managing_Hosts-Establishing_a_Secure_Connection_for_Remote_Commands">10.3. Distributing SSH Keys for Remote Execution</a></span><ul><li><span class="section"><a href="#sect-Managing_Hosts-Distributing_SSH_Keys_for_Remote_Execution_Manually">10.3.1. Distributing SSH Keys for Remote Execution Manually</a></span></li><li><span class="section"><a href="#sect-Managing_Hosts-Using_API_to_Obtain_SSH_Keys_for_Remote_Execution">10.3.2. Using the Satellite API to Obtain SSH Keys for Remote Execution</a></span></li><li><span class="section"><a href="#sect-Managing_Hosts-Configuring_a_Kickstart_Template_to_Distribute_SSH_Keys_during_Provisioning">10.3.3. Configuring a Kickstart Template to Distribute SSH Keys during Provisioning</a></span></li></ul></li><li><span class="section"><a href="#configuring_a_keytab_for_kerberos_ticket_granting_tickets">10.4. Configuring a keytab for Kerberos Ticket Granting Tickets</a></span></li><li><span class="section"><a href="#configuring_kerberos_authentication_for_remote_execution">10.5. Configuring Kerberos Authentication for Remote Execution</a></span></li><li><span class="section"><a href="#sect-Managing_Hosts-Configuring_and_Running_Remote_Commands">10.6. Configuring and Running Remote Jobs</a></span><ul><li><span class="section"><a href="#sect-Managing_Hosts-Setting_up_Job_Templates">10.6.1. Setting up Job Templates</a></span></li><li><span class="section"><a href="#sect-Managing_Hosts-Executing_Remote_Jobs">10.6.2. Executing Jobs</a></span></li><li><span class="section"><a href="#sect-Managing_Hosts-Monitoring_Remote_Jobs">10.6.3. Monitoring Jobs</a></span></li><li><span class="section"><a href="#sect-Managing_Hosts-Creating_Advanced_Templates">10.6.4. Creating Advanced Templates</a></span></li></ul></li><li><span class="section"><a href="#sect-Managing_Hosts-Delegating_Permissions">10.7. Delegating Permissions for Remote Execution</a></span></li></ul></li><li><span class="chapter"><a href="#chap-Red_Hat_Satellite-Managing_Hosts-Integrating_Satellite_and_Ansible_Tower">11. Integrating Red Hat Satellite and Ansible Tower</a></span><ul><li><span class="section"><a href="#sect-Red_Hat_Satellite-Managing_Hosts-Integrating_Satellite_and_Ansible_Tower-Adding_Satellite_Server_to_Ansible_Tower_as_a_Dynamic_Inventory_Item">11.1. Adding Satellite Server to Ansible Tower as a Dynamic Inventory Item</a></span></li><li><span class="section"><a href="#sect-Red_Hat_Satellite-Managing_Hosts-Integrating_Satellite_and_Ansible_Tower-Configuring_Provisioning_Callback_for_a_Host">11.2. Configuring Provisioning Callback for a Host</a></span></li></ul></li><li><span class="chapter"><a href="#Synchronizing_Templates_Repositories">12. Synchronizing Template Repositories</a></span><ul><li><span class="section"><a href="#enabling_the_templatesync_plug_in">12.1. Enabling the TemplateSync plug-in</a></span></li><li><span class="section"><a href="#configuring-the-templatesync-plug-in">12.2. Configuring the TemplateSync plug-in</a></span></li><li><span class="section"><a href="#importing_and_exporting_templates">12.3. Importing and Exporting Templates</a></span><ul><li><span class="section"><a href="#importing_templates">12.3.1. Importing Templates</a></span></li><li><span class="section"><a href="#exporting_templates">12.3.2. Exporting Templates</a></span></li><li><span class="section"><a href="#synchronizing_templates_using_the_satellite_api">12.3.3. Synchronizing Templates Using the Satellite API</a></span></li><li><span class="section"><a href="#synchronizing_templates_with_a_local_directory_using_the_satellite_api">12.3.4. Synchronizing Templates with a Local Directory Using the Satellite API</a></span></li></ul></li><li><span class="section"><a href="#advanced_git_configuration">12.4. Advanced Git Configuration</a></span></li><li><span class="section"><a href="#uninstalling_the_plug_in">12.5. Uninstalling the plug-in</a></span></li></ul></li><li><span class="appendix"><a href="#appe-Red_Hat_Satellite-Managing_Hosts-Template_Writing_Reference">A. Template Writing Reference</a></span><ul><li><span class="section"><a href="#sect-Managing_Hosts-Writing_ERB_Templates">A.1. Writing ERB Templates</a></span></li><li><span class="section"><a href="#sect-Managing_Hosts-Troubleshooting_ERB_Templates">A.2. Troubleshooting ERB Templates</a></span></li><li><span class="section"><a href="#sect-Managing_Hosts-Satellite_Specific_macros_and_Variables">A.3. Generic Satellite-Specific Macros</a></span></li><li><span class="section"><a href="#ref_template_macros">A.4. Templates Macros</a></span></li><li><span class="section"><a href="#ref_host_specific_variables_for_templates">A.5. Host-Specific Variables</a></span></li><li><span class="section"><a href="#ref_kickstart_specific_variables">A.6. Kickstart-Specific Variables</a></span></li><li><span class="section"><a href="#ref_writing_conditional_statements">A.7. Conditional Statements</a></span></li><li><span class="section"><a href="#ref_working_with_arrays">A.8. Parsing Arrays</a></span></li><li><span class="section"><a href="#ref_example_template_snippets">A.9. Example Template Snippets</a></span></li></ul></li><li><span class="appendix"><a href="#appe-Red_Hat_Satellite-Managing_Hosts-Host_Management_without_Goferd">B. Host Management Without Goferd</a></span><ul><li><span class="section"><a href="#sect-Red_Hat_Satellite-Managing_Hosts-Host_Management_without_Goferd-Prerequisites">B.1. Prerequisites</a></span></li><li><span class="section"><a href="#sect-Red_Hat_Satellite-Managing_Hosts-Host_Management_without_Goferd-Making_Host_Management_without_Goferd_the_System_Default">B.2. Configuring Host Management Without Goferd as the System Default</a></span></li><li><span class="section"><a href="#sect-Red_Hat_Satellite-Managing_Hosts-Host_Management_without_Goferd-Limitations_with_Hammer">B.3. Limitations with Hammer</a></span></li></ul></li></ul></div><section class="chapter" id="overview-of-hosts-in-satellite"><div class="titlepage"><div><div><h1 class="title">Chapter 1. Overview of Hosts in Red Hat Satellite 6</h1></div></div></div><p>
			A host is any Red Hat Enterprise Linux client that Red Hat Satellite manages. Hosts can be physical or virtual. Virtual hosts can be deployed on any platform supported by Red Hat Satellite, such as KVM, VMware vSphere, OpenStack, Amazon EC2, Rackspace Cloud Services or Google Compute Engine.
		</p><p>
			Red Hat Satellite enables host management at scale, including monitoring, provisioning, remote execution, configuration management, software management, and subscription management. You can manage your hosts from the Satellite web UI or from the command line.
		</p><p>
			In the Satellite web UI, you can browse all hosts recognized by Satellite Server, grouped by type:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<span class="strong strong"><strong>All Hosts</strong></span> - a list of all hosts recognized by Satellite Server.
				</li><li class="listitem">
					<span class="strong strong"><strong>Discovered Hosts</strong></span> - a list of bare-metal hosts detected on the provisioning network by the Discovery plug-in.
				</li><li class="listitem">
					<span class="strong strong"><strong>Content Hosts</strong></span> - a list of hosts that manage tasks related to content and subscriptions.
				</li><li class="listitem">
					<span class="strong strong"><strong>Host Collections</strong></span> - a list of user-defined collections of hosts used for bulk actions such as errata installation.
				</li></ul></div><p>
			To search for a host, type in the <span class="strong strong"><strong>Search</strong></span> field, and use an asterisk (*) to perform a partial string search. For example, if searching for a content host named <code class="literal">dev-node.example.com</code>, click the <span class="strong strong"><strong>Content Hosts</strong></span> page and type <code class="literal">dev-node*</code> in the <span class="strong strong"><strong>Search</strong></span> field. Alternatively, <code class="literal">*node*</code> will also find the content host <code class="literal">dev-node.example.com.</code>
		</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
				Satellite Server is listed as a host itself even if it is not self-registered. Do not delete Satellite Server from the list of hosts.
			</p></div></div></section><section class="chapter" id="Administering_Hosts"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Administering Hosts</h1></div></div></div><p>
			This chapter describes creating, registering, administering, and removing hosts.
		</p><section class="section" id="creating-a-host-in-satellite"><div class="titlepage"><div><div><h2 class="title">2.1. Creating a Host in Red Hat Satellite</h2></div></div></div><p>
				Use this procedure to create a host in Red Hat Satellite.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, click <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Create Host</strong></span>.
					</li><li class="listitem">
						On the <span class="strong strong"><strong>Host</strong></span> tab, enter the required details.
					</li><li class="listitem">
						Click the <span class="strong strong"><strong>Ansible Roles</strong></span> tab, and from the <span class="strong strong"><strong>Ansible Roles</strong></span> list, select one or more roles that you want to add to the host. Use the <span class="strong strong"><strong>arrow</strong></span> icon to manage the roles that you add or remove.
					</li><li class="listitem">
						On the <span class="strong strong"><strong>Puppet Classes</strong></span> tab, select the Puppet classes you want to include.
					</li><li class="listitem"><p class="simpara">
						On the <span class="strong strong"><strong>Interfaces</strong></span> tab:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								For each interface, click <span class="strong strong"><strong>Edit</strong></span> in the <span class="strong strong"><strong>Actions</strong></span> column and configure the following settings as required:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="strong strong"><strong>Type</strong></span> — For a Bond or BMC interface, use the <span class="strong strong"><strong>Type</strong></span> list and select the interface type.
									</li><li class="listitem">
										<span class="strong strong"><strong>MAC address</strong></span> — Enter the MAC address.
									</li><li class="listitem">
										<span class="strong strong"><strong>DNS name</strong></span> — Enter the DNS name that is known to the DNS server. This is used for the host part of the FQDN.
									</li><li class="listitem">
										<span class="strong strong"><strong>Domain</strong></span> — Select the domain name of the provisioning network. This automatically updates the <span class="strong strong"><strong>Subnet</strong></span> list with a selection of suitable subnets.
									</li><li class="listitem">
										<span class="strong strong"><strong>IPv4 Subnet</strong></span> — Select an IPv4 subnet for the host from the list.
									</li><li class="listitem">
										<span class="strong strong"><strong>IPv6 Subnet</strong></span> — Select an IPv6 subnet for the host from the list.
									</li><li class="listitem">
										<span class="strong strong"><strong>IPv4 address</strong></span> — If IP address management (IPAM) is enabled for the subnet, the IP address is automatically suggested. Alternatively, you can enter an address. The address can be omitted if provisioning tokens are enabled, if the domain does not mange DNS, if the subnet does not manage reverse DNS, or if the subnet does not manage DHCP reservations.
									</li><li class="listitem">
										<span class="strong strong"><strong>IPv6 address</strong></span> — If IP address management (IPAM) is enabled for the subnet, the IP address is automatically suggested. Alternatively, you can enter an address.
									</li><li class="listitem">
										<span class="strong strong"><strong>Managed</strong></span> — Select this check box to configure the interface during provisioning to use the Capsule provided DHCP and DNS services.
									</li><li class="listitem">
										<span class="strong strong"><strong>Primary</strong></span> — Select this check box to use the DNS name from this interface as the host portion of the FQDN.
									</li><li class="listitem">
										<span class="strong strong"><strong>Provision</strong></span> — Select this check box to use this interface for provisioning. This means TFTP boot will take place using this interface, or in case of image based provisioning, the script to complete the provisioning will be executed through this interface. Note that many provisioning tasks, such as downloading RPMs by <span class="strong strong"><strong>anaconda</strong></span>, Puppet setup in a <code class="literal">%post</code> script, will use the primary interface.
									</li><li class="listitem"><p class="simpara">
										<span class="strong strong"><strong>Virtual NIC</strong></span> — Select this check box if this interface is not a physical device. This setting has two options:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												<span class="strong strong"><strong>Tag</strong></span> — Optionally set a VLAN tag. If unset, the tag will be the VLAN ID of the subnet.
											</li><li class="listitem">
												<span class="strong strong"><strong>Attached to</strong></span> — Enter the device name of the interface this virtual interface is attached to.
											</li></ul></div></li></ul></div></li><li class="listitem">
								Click <span class="strong strong"><strong>OK</strong></span> to save the interface configuration.
							</li><li class="listitem">
								Optionally, click <span class="strong strong"><strong>Add Interface</strong></span> to include an additional network interface. See <a class="xref" href="#Adding_Network_Interfaces" title="Chapter 4. Adding Network Interfaces">Chapter 4, <em>Adding Network Interfaces</em></a> for details.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Submit</strong></span> to apply the changes and exit.
							</li></ol></div></li><li class="listitem">
						On the <span class="strong strong"><strong>Operating System</strong></span> tab, enter the required details. For Red Hat operating systems, select <span class="strong strong"><strong>Synced Content</strong></span> for <span class="strong strong"><strong>Media Selection</strong></span>. If you want to use non Red Hat operating systems, select <span class="strong strong"><strong>All Media</strong></span>, then select the installation media from the <span class="strong strong"><strong>Media Selection</strong></span> list. You can select a partition table from the list or enter a custom partition table in the <span class="strong strong"><strong>Custom partition table</strong></span> field. You cannot specify both.
					</li><li class="listitem"><p class="simpara">
						On the <span class="strong strong"><strong>Parameters</strong></span> tab, click <span class="strong strong"><strong>Add Parameter</strong></span> to add any parameter variables that you want to pass to job templates at run time. This includes all Puppet Class, Ansible playbook parameters and host parameters that you want to associate with the host. To use a parameter variable with an Ansible job template, you must add a <span class="strong strong"><strong>Host Parameter</strong></span>.
					</p><p class="simpara">
						When you create a Red Hat Enterprise Linux 8 host, you can set system purpose attributes. System purpose attributes define what subscriptions to attach automatically on host creation. In the <span class="strong strong"><strong>Host Parameters</strong></span> area, enter the following parameter names with the corresponding values. For the list of values, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_a_standard_rhel_installation/graphical-installation_graphical-installation#configuring-system-purpose-standard_configuring-system-settings">Configuring system purpose</a> in the <span class="emphasis"><em>Performing a standard RHEL installation</em></span> guide.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">syspurpose_role</code>
							</li><li class="listitem">
								<code class="literal">syspurpose_sla</code>
							</li><li class="listitem">
								<code class="literal">syspurpose_usage</code>
							</li><li class="listitem">
								<code class="literal">syspurpose_addons</code>
							</li></ul></div></li><li class="listitem">
						On the <span class="strong strong"><strong>Additional Information</strong></span> tab, enter additional information about the host.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span> to complete your provisioning request.
					</li></ol></div><div class="formalpara"><p class="title"><strong>For CLI Users</strong></p><p>
					To create a host associated to a host group, enter the following command:
				</p></div><pre class="screen"># hammer host create \
--name "<span class="emphasis"><em>host_name</em></span>" \
--hostgroup "<span class="emphasis"><em>hostgroup_name</em></span>" \
--interface="primary=true, \
            provision=true, \
            mac=<span class="emphasis"><em>mac_address</em></span>, \
            ip=<span class="emphasis"><em>ip_address</em></span>" \
--organization "<span class="emphasis"><em>Your_Organization</em></span>" \
--location "<span class="emphasis"><em>Your_Location</em></span>" \
--ask-root-password yes</pre><p>
				This command prompts you to specify the root password. It is required to specify the host’s IP and MAC address. Other properties of the primary network interface can be inherited from the host group or set using the <code class="literal">--subnet</code>, and <code class="literal">--domain</code> parameters. You can set additional interfaces using the <code class="literal">--interface</code> option, which accepts a list of key-value pairs. For the list of available interface settings, enter the <code class="literal">hammer host create --help</code> command.
			</p></section><section class="section" id="editing-the-system-purpose-of-a-host"><div class="titlepage"><div><div><h2 class="title">2.2. Editing the System Purpose of a Host</h2></div></div></div><p>
				You can edit the system purpose attributes for a Red Hat Enterprise Linux 8 host. System purpose attributes define which subscriptions to attach automatically to this host. For more information about system purpose, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_a_standard_rhel_installation/graphical-installation_graphical-installation#configuring-system-purpose-standard_configuring-system-settings">Configuring system purpose</a> in the <span class="emphasis"><em>Performing a standard RHEL installation</em></span> guide.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Content Hosts</strong></span> and click the name of the Red Hat Enterprise Linux 8 host that you want to edit.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>System Purpose</strong></span> area, click the <span class="strong strong"><strong>Edit</strong></span> or <span class="strong strong"><strong>Remove</strong></span> icon for the system purpose attributes that you want to edit, add, or remove.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Save</strong></span>.
					</li><li class="listitem">
						Click the <span class="strong strong"><strong>Subscriptions</strong></span> tab and select <span class="strong strong"><strong>Subscriptions</strong></span>.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Run Auto-Attach</strong></span> to attach subscriptions to your host automatically.
					</li><li class="listitem">
						Refresh the page to verify that the subscriptions list contains the correct subscriptions.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>For CLI Users</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the host and edit the required system purpose attributes. For example, set the usage type to <code class="literal">Production</code>, the role to <code class="literal">Red Hat Enterprise Linux Server</code>, and add the <code class="literal">addon</code> add on. For the list of values, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_a_standard_rhel_installation/graphical-installation_graphical-installation#configuring-system-purpose-standard_configuring-system-settings">Configuring system purpose</a> in the <span class="emphasis"><em>Performing a standard RHEL installation</em></span> guide.
					</p><pre class="screen"># syspurpose set-usage <code class="literal"><span class="emphasis"><em>Production</em></span></code>
# syspurpose set-role <code class="literal"><span class="emphasis"><em>Red Hat Enterprise Linux Server</em></span></code>
# syspurpose add-addons '<span class="emphasis"><em>your_addon</em></span>'</pre></li><li class="listitem"><p class="simpara">
						Verify the system purpose attributes for this host:
					</p><pre class="screen"># syspurpose show</pre></li><li class="listitem"><p class="simpara">
						Automatically attach subscriptions to this host:
					</p><pre class="screen"># subscription-manager attach --auto</pre></li><li class="listitem"><p class="simpara">
						Verify the system purpose status for this host:
					</p><pre class="screen"># subscription-manager status</pre></li></ol></div></section><section class="section" id="changing-a-module-stream-for-a-host"><div class="titlepage"><div><div><h2 class="title">2.3. Changing a Module Stream for a Host</h2></div></div></div><p>
				If you have a Red Hat Enterprise Linux 8 host, you can modify the module stream for the repositories you install. After you create the host, you can enable, disable, install, update, and remove module streams from your host in the Satellite web UI.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Content Hosts</strong></span> and click the name of the host that contains the modules you want to change.
					</li><li class="listitem">
						Click the <span class="strong strong"><strong>Module Streams</strong></span> tab.
					</li><li class="listitem">
						From the <span class="strong strong"><strong>Available Module Streams</strong></span> list, locate the module that you want to change. You can use the <span class="strong strong"><strong>Filter</strong></span> field to refine the list entries. You can also use the <span class="strong strong"><strong>Filter Status</strong></span> list to search for modules with a specific status.
					</li><li class="listitem">
						From the <span class="strong strong"><strong>Actions</strong></span> list, select the change that you want to make to the module.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Job Invocation</strong></span> window, ensure that the job information is accurate. Change any details that you require, and then click <span class="strong strong"><strong>Submit</strong></span>.
					</li></ol></div></section><section class="section" id="creating-a-host-group"><div class="titlepage"><div><div><h2 class="title">2.4. Creating a Host Group</h2></div></div></div><p>
				If you create a high volume of hosts, many of the hosts can have common settings and attributes. Adding these settings and attributes for every new host is time consuming. If you use host groups, you can apply common attributes to hosts that you create.
			</p><p>
				A host group functions as a template for common host settings, containing many of the same details that you provide to hosts. When you create a host with a host group, the host inherits the defined settings from the host group. You can then provide additional details to individualize the host.
			</p><div class="formalpara"><p class="title"><strong>Host Group Hierarchy</strong></p><p>
					You can create a hierarchy of host groups. Aim to have one base level host group that represents all hosts in your organization and provide general settings, and then nested groups to provide specific settings. For example, you can have a base level host group that defines the operating system, and two nested host groups that inherit the base level host group:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						<span class="strong strong"><strong>Hostgroup:</strong></span> <code class="literal">Base</code> (Red Hat Enterprise Linux 7.6)
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Hostgroup:</strong></span> <code class="literal">Webserver</code> (applies the <code class="literal">httpd</code> Puppet class)
							</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
										<span class="strong strong"><strong>Host:</strong></span> <code class="literal">webserver1.example.com</code> (web server)
									</li><li class="listitem">
										<span class="strong strong"><strong>Host:</strong></span> <code class="literal">webserver2.example.com</code> (web server)
									</li></ul></div></li><li class="listitem"><p class="simpara">
								<span class="strong strong"><strong>Hostgroup:</strong></span> <code class="literal">Storage</code> (applies the <code class="literal">nfs</code> Puppet class)
							</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
										<span class="strong strong"><strong>Host:</strong></span> <code class="literal">storage1.example.com</code> (storage server)
									</li><li class="listitem">
										<span class="strong strong"><strong>Host:</strong></span> <code class="literal">storage2.example.com</code> (storage server)
									</li></ul></div></li><li class="listitem">
								<span class="strong strong"><strong>Host:</strong></span> <code class="literal">custom.example.com</code> (custom host)
							</li></ul></div></li></ul></div><p>
				In this example, all hosts use Red Hat Enterprise Linux 7.6 as their operating system because of their inheritance of the <code class="literal">Base</code> host group. The two web server hosts inherit the settings from the <code class="literal">Webserver</code> host group, which includes the <code class="literal">httpd</code> Puppet class and the settings from the <code class="literal">Base</code> host group. The two storage servers inherit the settings from the <code class="literal">Storage</code> host group, which includes the <code class="literal">nfs</code> Puppet class and the settings from the <code class="literal">Base</code> host group. The custom host only inherits the settings from the <code class="literal">Base</code> host group.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Configure</strong></span> &gt; <span class="strong strong"><strong>Host Groups</strong></span> and click <span class="strong strong"><strong>Create Host Group</strong></span>.
					</li><li class="listitem">
						If you have an existing host group that you want to inherit attributes from, you can select a host group from the <span class="strong strong"><strong>Parent</strong></span> list. If you do not, leave this field blank.
					</li><li class="listitem">
						Enter a <span class="strong strong"><strong>Name</strong></span> for the new host group.
					</li><li class="listitem">
						Enter any further information that you want future hosts to inherit.
					</li><li class="listitem">
						Click the <span class="strong strong"><strong>Ansible Roles</strong></span> tab, and from the <span class="strong strong"><strong>Ansible Roles</strong></span> list, select one or more roles that you want to add to the host. Use the <span class="strong strong"><strong>arrow</strong></span> icon to manage the roles that you add or remove.
					</li><li class="listitem"><p class="simpara">
						Click the additional tabs and add any details that you want to attribute to the host group.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Puppet fails to retrieve the Puppet CA certificate while registering a host with a host group associated with a Puppet environment created inside a <code class="literal">Production</code> environment.
						</p><p>
							To create a suitable Puppet environment to be associated with a host group, manually create a directory and change the owner:
						</p><pre class="screen"># mkdir /etc/puppetlabs/code/environments/<span class="emphasis"><em>example_environment</em></span>
# chown apache /etc/puppetlabs/code/environments/<span class="emphasis"><em>example_environment</em></span></pre></div></div></li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span> to save the host group.
					</li></ol></div><div class="formalpara"><p class="title"><strong>For CLI Users</strong></p><p>
					Create the host group with the <code class="literal">hammer hostgroup create</code> command. For example:
				</p></div><pre class="screen"># hammer hostgroup create --name "Base" \
--lifecycle-environment "Production" --content-view "Base" \
--puppet-environment "production" --content-source-id 1 \
--puppet-ca-proxy-id 1 --puppet-proxy-id 1 --domain "example.com" \
--subnet `ACME's Internal Network` --architecture "x86_64" \
--operatingsystem "RedHat 7.2" --medium-id 9 \
--partition-table "Kickstart default" --root-pass "p@55w0rd!" \
--locations "New York" --organizations "ACME"</pre></section><section class="section" id="creating-a-host-group-for-each-lifecycle-environment"><div class="titlepage"><div><div><h2 class="title">2.5. Creating a Host Group for Each LifeCycle Environment</h2></div></div></div><p>
				Use this procedure to create a host group for the Library lifecycle environment and add nested host groups for other lifecycle environments.
			</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					To create a host group for each life cycle environment, run the following Bash script:
				</p></div><pre class="programlisting language-bash">MAJOR="<span class="emphasis"><em>7</em></span>"
ARCH="<span class="emphasis"><em>x86_64</em></span>"
ORG="<span class="emphasis"><em>Your Organization</em></span>"
LOCATIONS="<span class="emphasis"><em>Your Location</em></span>"
PTABLE_NAME="<span class="emphasis"><em>Kickstart default</em></span>"
DOMAIN="<span class="emphasis"><em>example.com</em></span>"

hammer --output csv --no-headers lifecycle-environment list --organization "${ORG}" | cut -d ',' -f 2 | while read LC_ENV; do
  [[ ${LC_ENV} == "Library" ]] &amp;&amp; continue

  hammer hostgroup create --name "rhel-${MAJOR}server-${ARCH}-${LC_ENV}" \
    --architecture "${ARCH}" \
    --partition-table "${PTABLE_NAME}" \
    --domain "${DOMAIN}" \
    --organizations "${ORG}" \
    --query-organization "${ORG}" \
    --locations "${LOCATIONS}" \
    --lifecycle-environment "${LC_ENV}"
done</pre></section><section class="section" id="changing-the-group-of-a-host"><div class="titlepage"><div><div><h2 class="title">2.6. Changing the Group of a Host</h2></div></div></div><p>
				Use this procedure to change the group of a host.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All hosts</strong></span>.
					</li><li class="listitem">
						Select the check box of the host you want to change.
					</li><li class="listitem">
						From the <span class="strong strong"><strong>Select Action</strong></span> list, select <span class="strong strong"><strong>Change Group</strong></span>. A new option window opens.
					</li><li class="listitem">
						From the <span class="strong strong"><strong>Host Group</strong></span> list, select the group that you want for your host.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span>.
					</li></ol></div></section><section class="section" id="changing-the-environment-of-a-host"><div class="titlepage"><div><div><h2 class="title">2.7. Changing the Environment of a Host</h2></div></div></div><p>
				Use this procedure to change the environment of a host.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All hosts</strong></span>.
					</li><li class="listitem">
						Select the check box of the host you want to change.
					</li><li class="listitem">
						From the <span class="strong strong"><strong>Select Action</strong></span> list, select <span class="strong strong"><strong>Change Environment</strong></span>. A new option window opens.
					</li><li class="listitem">
						From the <span class="strong strong"><strong>Environment</strong></span> list, select the new environment for your host.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span>.
					</li></ol></div></section><section class="section" id="changing-the-managed-status-of-a-host"><div class="titlepage"><div><div><h2 class="title">2.8. Changing the Managed Status of a Host</h2></div></div></div><p>
				Hosts provisioned by Satellite are Managed by default. When a host is set to Managed, you can configure additional host parameters from Satellite Server. These additional parameters are listed on the <span class="strong strong"><strong>Operating System</strong></span> tab. If you change any settings on the <span class="strong strong"><strong>Operating System</strong></span> tab, they will not take effect until you set the host to build and reboot it.
			</p><p>
				If you need to obtain reports about configuration management on systems using an operating system not supported by Satellite, set the host to Unmanaged.
			</p><p>
				Use this procedure to switch a host between Managed and Unmanaged status.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All hosts</strong></span>.
					</li><li class="listitem">
						Select the host.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Edit</strong></span>.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Manage host</strong></span> or <span class="strong strong"><strong>Unmanage host</strong></span> to change the host’s status.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span>.
					</li></ol></div></section><section class="section" id="assinging-a-host-to-a-specific-organization"><div class="titlepage"><div><div><h2 class="title">2.9. Assigning a Host to a Specific Organization</h2></div></div></div><p>
				Use this procedure to assign a host to a specific organization. For general information about organizations and how to configure them, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/content_management_guide/managing_organizations">Managing Organizations</a> in the <span class="emphasis"><em>Content Management Guide</em></span>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All hosts</strong></span>.
					</li><li class="listitem">
						Select the check box of the host you want to change.
					</li><li class="listitem">
						From the <span class="strong strong"><strong>Select Action</strong></span> list, select <span class="strong strong"><strong>Assign Organization</strong></span>. A new option window opens.
					</li><li class="listitem"><p class="simpara">
						From the <span class="strong strong"><strong>Select Organization</strong></span> list, select the organization that you want to assign your host to. Select the check box <span class="strong strong"><strong>Fix Organization on Mismatch</strong></span>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							A mismatch happens if there is a resource associated with a host, such as a domain or subnet, and at the same time not associated with the organization you want to assign the host to. The option <span class="strong strong"><strong>Fix Organization on Mismatch</strong></span> will add such a resource to the organization, and is therefore the recommended choice. The option <span class="strong strong"><strong>Fail on Mismatch</strong></span> will always result in an error message. For example, reassigning a host from one organization to another will fail, even if there is no actual mismatch in settings.
						</p></div></div></li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span>.
					</li></ol></div></section><section class="section" id="assigning-a-host-to-a-specific-location"><div class="titlepage"><div><div><h2 class="title">2.10. Assigning a Host to a Specific Location</h2></div></div></div><p>
				Use this procedure to assign a host to a specific location. For general information about locations and how to configure them, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/provisioning_guide/configuring_provisioning_contexts#Configuring_Provisioning_Contexts-Creating_a_Location">Creating a Location</a> in the <span class="emphasis"><em>Provisioning Guide</em></span>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All hosts</strong></span>.
					</li><li class="listitem">
						Select the check box of the host you want to change.
					</li><li class="listitem">
						From the <span class="strong strong"><strong>Select Action</strong></span> list, select <span class="strong strong"><strong>Assign Location</strong></span>. A new option window opens.
					</li><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>Select Location</strong></span> list and choose the location that you want for your host. Select the check box <span class="strong strong"><strong>Fix Location on Mismatch</strong></span>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							A mismatch happens if there is a resource associated with a host, such as a domain or subnet, and at the same time not associated with the location you want to assign the host to. The option <span class="strong strong"><strong>Fix Location on Mismatch</strong></span> will add such a resource to the location, and is therefore the recommended choice. The option <span class="strong strong"><strong>Fail on Mismatch</strong></span> will always result in an error message. For example, reassigning a host from one location to another will fail, even if there is no actual mismatch in settings.
						</p></div></div></li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span>.
					</li></ol></div></section><section class="section" id="removing-a-host-from-satellite"><div class="titlepage"><div><div><h2 class="title">2.11. Removing a Host from Red Hat Satellite</h2></div></div></div><p>
				Use this procedure to remove a host from Red Hat Satellite.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All hosts</strong></span> or <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Content Hosts</strong></span>.
					</li><li class="listitem">
						Select the hosts that you want to remove.
					</li><li class="listitem">
						From the <span class="strong strong"><strong>Select Action</strong></span> list, select <span class="strong strong"><strong>Delete Hosts</strong></span>.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span> to remove the host from Red Hat Satellite permanently.
					</li></ol></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					If a host record that is associated with a virtual machine is deleted, the virtual machine will be deleted as well. To avoid deleting the virtual machine in this situation, disassociate the virtual machine from Satellite without removing it from the hypervisor.
				</p></div></div><div class="orderedlist" id="disassociating-a-virtual-machine"><p class="title"><strong>Disassociating A Virtual Machine from Satellite without Removing it from a Hypervisor</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All Hosts</strong></span> and select the check box to the left of the hosts to be disassociated.
					</li><li class="listitem">
						From the <span class="strong strong"><strong>Select Action</strong></span> list, select the <span class="strong strong"><strong>Disassociate Hosts</strong></span> button.
					</li><li class="listitem">
						Optionally, select the check box to keep the hosts for future action.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span>.
					</li></ol></div></section></section><section class="chapter" id="Registering_Hosts"><div class="titlepage"><div><div><h1 class="title">Chapter 3. Registering Hosts</h1></div></div></div><p>
			There are two main methods for registering a host to Satellite Server or Capsule Server:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Download and install the consumer RPM (<span class="emphasis"><em>server.example.com</em></span>/pub/katello-ca-consumer-latest.noarch.rpm) and then run Subscription Manager. This method is suited for freshly installed hosts.
				</li><li class="listitem">
					Download and run the bootstrap script (<span class="emphasis"><em>server.example.com</em></span>/pub/bootstrap.py). This method is suited for both freshly installed hosts and hosts that have been previously registered, for example, to Satellite 5 or another Satellite 6.
				</li></ul></div><p>
			You can also register Atomic Hosts to Satellite Server or Capsule Server.
		</p><p>
			Use one of the following procedures to register a host:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="xref" href="#registering-a-host-to-satellite" title="3.1. Registering a Host to Red Hat Satellite">Section 3.1, “Registering a Host to Red Hat Satellite”</a>
				</li><li class="listitem">
					<a class="xref" href="#registering-an-atomic-host-to-satellite" title="3.2. Registering an Atomic Host to Red Hat Satellite">Section 3.2, “Registering an Atomic Host to Red Hat Satellite”</a>
				</li><li class="listitem">
					<a class="xref" href="#registering-a-host-to-satellite-using-the-bootstrap-script" title="3.3. Registering a Host to Red Hat Satellite Using The Bootstrap Script">Section 3.3, “Registering a Host to Red Hat Satellite Using The Bootstrap Script”</a>
				</li></ul></div><p>
			Use the following procedures to install and configure host tools:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="xref" href="#installing-the-katello-agent_managing-hosts" title="3.4. Installing the Katello Agent">Section 3.4, “Installing the Katello Agent”</a>
				</li><li class="listitem">
					<a class="xref" href="#installing-tracer" title="3.5. Installing Tracer">Section 3.5, “Installing Tracer”</a>
				</li><li class="listitem">
					<a class="xref" href="#installing-and-configuring-the-puppet-agent" title="3.6. Installing and Configuring the Puppet Agent">Section 3.6, “Installing and Configuring the Puppet Agent”</a>
				</li></ul></div><div class="formalpara"><p class="title"><strong>Supported Host Operating Systems</strong></p><p>
				Hosts must use one of the following Red Hat Enterprise Linux versions:
			</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					5.7 or later
				</li><li class="listitem">
					6.1 or later*
				</li><li class="listitem">
					7.0 or later
				</li><li class="listitem">
					8.0 or later
				</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				Red Hat Enterprise Linux versions 6.1, 6.2, and 6.3 require <code class="literal">subscription-manager</code> and related packages to be updated manually. For more information, see <a class="link" href="https://access.redhat.com/solutions/1256763">https://access.redhat.com/solutions/1256763</a>.
			</p></div></div><div class="formalpara"><p class="title"><strong>Supported Architectures</strong></p><p>
				All architectures of Red Hat Enterprise Linux are supported:
			</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					i386
				</li><li class="listitem">
					x86_64
				</li><li class="listitem">
					s390x
				</li><li class="listitem">
					ppc_64
				</li></ul></div><section class="section" id="registering-a-host-to-satellite"><div class="titlepage"><div><div><h2 class="title">3.1. Registering a Host to Red Hat Satellite</h2></div></div></div><p>
				Use the following procedure to register a host to Red Hat Satellite 6.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Satellite Server, any Capsule Servers, and all hosts must be synchronized with the same NTP server, and have a time synchronization tool enabled and running.
					</li><li class="listitem">
						The daemon <span class="strong strong"><strong>rhsmcertd</strong></span> must be running on the hosts.
					</li><li class="listitem">
						An activation key must be available for the host. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/content_management_guide/managing_activation_keys">Managing Activation Keys</a> in the <span class="emphasis"><em>Content Management Guide</em></span>.
					</li><li class="listitem">
						Subscription Manager must be version 1.10 or later. The package is available in the standard Red Hat Enterprise Linux repository.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					Red Hat Enterprise Linux hosts register to the Red Hat Content Delivery Network by default.
				</p></div><p>
				Update each host configuration so that they receive updates from the correct Satellite Server or Capsule Server:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Note the fully qualified domain name (FQDN) of the Satellite Server or Capsule Server, for example <span class="emphasis"><em>server.example.com</em></span>.
					</li><li class="listitem"><p class="simpara">
						Log in to the host as the <code class="literal">root</code> user and download the <code class="literal">katello-ca-consumer-latest.noarch.rpm</code> package from Satellite Server or Capsule Server to which the host is to be registered. The consumer RPM configures the host to download content from the content source that is specified in Red Hat Satellite.
					</p><pre class="screen"># curl --insecure --output katello-ca-consumer-latest.noarch.rpm https://<span class="emphasis"><em>satellite.example.com</em></span>/pub/katello-ca-consumer-latest.noarch.rpm</pre></li><li class="listitem"><p class="simpara">
						Install the <code class="literal">katello-ca-consumer-latest.noarch.rpm</code> package:
					</p><pre class="screen"># yum localinstall katello-ca-consumer-latest.noarch.rpm</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The RPM package is not signed. If required, you can add the <code class="literal">--nosignature</code> option to install the package. The <code class="literal">katello-ca-consumer-<span class="emphasis"><em>hostname</em></span>-1.0-1.noarch.rpm</code> package is an additional <code class="literal">katello-ca-consumer</code> RPM that contains the server’s host name. The <code class="literal">katello-ca-consumer-latest.noarch.rpm</code> package always reflects the most recent version. Both serve the same purpose.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Clear any old host data related to Red Hat Subscription Manager (RHSM):
					</p><pre class="screen"># subscription-manager clean</pre></li><li class="listitem"><p class="simpara">
						Register the host using RHSM:
					</p><pre class="screen"># subscription-manager register --org=<span class="emphasis"><em>your_org_name</em></span> \
--activationkey=<span class="emphasis"><em>your_activation_key</em></span></pre><div class="example" id="idm45628288193984"><p class="title"><strong>Example 3.1. Command Output after Registration:</strong></p><div class="example-contents"><pre class="screen"># subscription-manager register --org=MyOrg --activationkey=TestKey-1
The system has been registered with id: 62edc0f8-855b-4184-b1b8-72a9dc793b96</pre></div></div></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You can use the <code class="literal">--environment</code> option to override the Content View and life cycle environment defined by the activation key. For example, to register a host to the Content View "MyView" in a "Development" life cycle environment:
				</p><pre class="screen"> # subscription-manager register --org=<span class="emphasis"><em>your_org_name</em></span> \
 --environment=Development/MyView \
 --activationkey=<span class="emphasis"><em>your_activation_key</em></span></pre></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					For Red Hat Enterprise Linux 6.3 hosts, the release version defaults to Red Hat Enterprise Linux 6 Server and needs to be pointed to the 6.3 repository:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Content Hosts</strong></span>.
						</li><li class="listitem">
							Select the check box next to the host that needs to be changed.
						</li><li class="listitem">
							From the <span class="strong strong"><strong>Select Action</strong></span> list, select <span class="strong strong"><strong>Set Release Version</strong></span>
						</li><li class="listitem">
							From the <span class="strong strong"><strong>Release Version</strong></span> list, select <span class="strong strong"><strong>6.3</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Done</strong></span>.
						</li></ol></div></div></div></section><section class="section" id="registering-an-atomic-host-to-satellite"><div class="titlepage"><div><div><h2 class="title">3.2. Registering an Atomic Host to Red Hat Satellite</h2></div></div></div><p>
				Use the following procedure to register an Atomic Host to Red Hat Satellite 6.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log in to the Atomic Host as the <code class="literal">root</code> user.
					</li><li class="listitem"><p class="simpara">
						Retrieve <code class="literal">katello-rhsm-consumer</code> from Satellite Server:
					</p><pre class="screen"># wget http://<span class="emphasis"><em>satellite.example.com</em></span>/pub/katello-rhsm-consumer</pre></li><li class="listitem"><p class="simpara">
						Change the mode of <code class="literal">katello-rhsm-consumer</code> to make it executable:
					</p><pre class="screen"># chmod +x katello-rhsm-consumer</pre></li><li class="listitem"><p class="simpara">
						Run <code class="literal">katello-rhsm-consumer</code>:
					</p><pre class="screen"># ./katello-rhsm-consumer</pre><p class="simpara">
						Register with Red Hat Subscription Manager:
					</p><pre class="screen"># subscription-manager register</pre></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The Katello agent is not supported on Atomic Hosts.
				</p></div></div></section><section class="section" id="registering-a-host-to-satellite-using-the-bootstrap-script"><div class="titlepage"><div><div><h2 class="title">3.3. Registering a Host to Red Hat Satellite Using The Bootstrap Script</h2></div></div></div><p>
				Use the bootstrap script to automate content registration and Puppet configuration. You can use the bootstrap script to register new hosts, or to migrate existing hosts to Red Hat Satellite 6 from Satellite 5, RHN, SAM, or RHSM.
			</p><p>
				The <code class="literal">katello-client-bootstrap</code> package is installed by default on Satellite Server’s base operating system. The <code class="literal">bootstrap.py</code> script is installed in the <code class="literal">/var/www/html/pub/</code> directory to make it available to hosts at <code class="literal"><span class="emphasis"><em>satellite6.example.com</em></span>/pub/bootstrap.py</code>. The script includes documentation in the <code class="literal">/usr/share/doc/katello-client-bootstrap-<span class="emphasis"><em>version</em></span>/README.md</code> file.
			</p><p>
				To use the bootstrap script, you must install it on the host. As the script is only required once, and only for the <code class="literal">root</code> user, you can place it in <code class="literal">/root</code> or <code class="literal">/usr/local/sbin</code> and remove it after use. This procedure uses <code class="literal">/root</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have a Satellite user with the permissions required to run the bootstrap script. The examples in this procedure specify the <code class="literal">admin</code> user. If this is not acceptable to your security policy, create a new role with the minimum permissions required and add it to the user that will run the script. For more information, see <a class="xref" href="#setting-permissions-for-the-bootstrap-script" title="3.3.1. Setting Permissions for the Bootstrap Script">Section 3.3.1, “Setting Permissions for the Bootstrap Script”</a>.
					</li><li class="listitem">
						You have an activation key for your hosts with the Satellite Tools repository enabled. For information on configuring activation keys, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/content_management_guide/managing_activation_keys">Managing Activation Keys</a> in the <span class="emphasis"><em>Content Management Guide</em></span>.
					</li><li class="listitem">
						You have created a host group. For more information about creating host groups, see <a class="xref" href="#creating-a-host-group" title="2.4. Creating a Host Group">Section 2.4, “Creating a Host Group”</a>.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Puppet Considerations</strong></p><p>
					If a host group is associated with a Puppet environment created inside a <code class="literal">Production</code> environment, Puppet fails to retrieve the Puppet CA certificate while registering a host from that host group.
				</p></div><p>
				To create a suitable Puppet environment to be associated with a host group, follow these steps:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Manually create a directory and change the owner:
					</p><pre class="screen"># mkdir /etc/puppetlabs/code/environments/<span class="emphasis"><em>example_environment</em></span>
# chown apache /etc/puppetlabs/code/environments/<span class="emphasis"><em>example_environment</em></span></pre></li><li class="listitem">
						Navigate to <span class="strong strong"><strong>Configure</strong></span> &gt; <span class="strong strong"><strong>Environments</strong></span> and click <span class="strong strong"><strong>Import environment from</strong></span>. The button name includes the FQDN of the internal or external Capsule.
					</li><li class="listitem">
						Choose the created directory and click <span class="strong strong"><strong>Update</strong></span>.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log in to the host as the <code class="literal">root</code> user.
					</li><li class="listitem"><p class="simpara">
						Download the script:
					</p><pre class="screen"># curl -O http://<span class="emphasis"><em>satellite6.example.com</em></span>/pub/bootstrap.py</pre></li><li class="listitem"><p class="simpara">
						Make the script executable:
					</p><pre class="screen"># chmod +x bootstrap.py</pre></li><li class="listitem"><p class="simpara">
						Confirm that the script is executable by viewing the help text:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								On Red Hat Enterprise Linux 8:
							</p><pre class="screen"># /usr/libexec/platform-python bootstrap.py -h</pre></li><li class="listitem"><p class="simpara">
								On other Red Hat Enterprise Linux versions:
							</p><pre class="screen"># ./bootstrap.py -h</pre></li></ul></div></li><li class="listitem"><p class="simpara">
						Enter the bootstrap command with values suitable for your environment.
					</p><p class="simpara">
						For the <code class="literal">--server</code> option, specify the FQDN of Satellite Server or a Capsule Server. For the <code class="literal">--location</code>, <code class="literal">--organization</code>, and <code class="literal">--hostgroup</code> options, use quoted names, not labels, as arguments to the options. See <a class="xref" href="#advanced-bootstrap-script-configuration" title="3.3.2. Advanced Bootstrap Script Configuration">Section 3.3.2, “Advanced Bootstrap Script Configuration”</a> for advanced use cases.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								On Red Hat Enterprise Linux 8, enter the following command:
							</p><pre class="screen"># /usr/libexec/platform-python bootstrap.py \
--login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span></pre></li><li class="listitem"><p class="simpara">
								On Red Hat Enterprise Linux 5, 6, or 7, enter the following command:
							</p><pre class="screen"># ./bootstrap.py --login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span></pre></li></ul></div></li><li class="listitem"><p class="simpara">
						Enter the password of the Satellite user you specified with the <code class="literal">--login</code> option.
					</p><p class="simpara">
						The script sends notices of progress to <span class="strong strong"><strong>stdout</strong></span>.
					</p></li><li class="listitem">
						When prompted by the script, approve the host’s Puppet certificate. In the Satellite web UI, navigate to <span class="strong strong"><strong>Infrastructure</strong></span> &gt; <span class="strong strong"><strong>Capsules</strong></span> and find the Satellite or Capsule Server you specified with the <code class="literal">--server</code> option.
					</li><li class="listitem">
						From the list in the <span class="strong strong"><strong>Actions</strong></span> column, select <span class="strong strong"><strong>Certificates</strong></span>.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Actions</strong></span> column, click <span class="strong strong"><strong>Sign</strong></span> to approve the host’s Puppet certificate.
					</li><li class="listitem">
						Return to the host to see the remainder of the bootstrap process completing.
					</li><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All hosts</strong></span> and ensure that the host is connected to the correct host group.
					</li><li class="listitem"><p class="simpara">
						Optional: After the host registration is complete, remove the script:
					</p><pre class="screen"># rm bootstrap.py</pre></li></ol></div><section class="section" id="setting-permissions-for-the-bootstrap-script"><div class="titlepage"><div><div><h3 class="title">3.3.1. Setting Permissions for the Bootstrap Script</h3></div></div></div><p>
					Use this procedure to configure a Satellite user with the permissions required to run the bootstrap script.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the Satellite web UI, navigate to <span class="strong strong"><strong>Administer</strong></span> &gt; <span class="strong strong"><strong>Users</strong></span>.
						</li><li class="listitem">
							Select an existing user by clicking the required <span class="strong strong"><strong>Username</strong></span>. A new pane opens with tabs to modify information about the selected user. Alternatively, create a new user specifically for the purpose of running this script.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Roles</strong></span> tab.
						</li><li class="listitem"><p class="simpara">
							Select <span class="strong strong"><strong>Edit hosts</strong></span> and <span class="strong strong"><strong>Viewer</strong></span> from the <span class="strong strong"><strong>Roles</strong></span> list.
						</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
								The <span class="strong strong"><strong>Edit hosts</strong></span> role allows the user to edit and delete hosts as well as being able to add hosts. If this is not acceptable to your security policy, create a new role with the following permissions and assign it to the user:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">view_organizations</code>
									</li><li class="listitem">
										<code class="literal">view_locations</code>
									</li><li class="listitem">
										<code class="literal">view_domains</code>
									</li><li class="listitem">
										<code class="literal">view_hostgroups</code>
									</li><li class="listitem">
										<code class="literal">view_hosts</code>
									</li><li class="listitem">
										<code class="literal">view_architectures</code>
									</li><li class="listitem">
										<code class="literal">view_ptables</code>
									</li><li class="listitem">
										<code class="literal">view_operatingsystems</code>
									</li><li class="listitem">
										<code class="literal">create_hosts</code>
									</li></ul></div></div></div></li><li class="listitem">
							Click <span class="strong strong"><strong>Submit</strong></span>.
						</li></ol></div><div class="orderedlist"><p class="title"><strong>For CLI Users</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a role with the minimum permissions required by the bootstrap script. This example creates a role with the name <span class="emphasis"><em>Bootstrap</em></span>:
						</p><pre class="screen"># ROLE='Bootstrap'
hammer role create --name "$ROLE"
hammer filter create --role "$ROLE" --permissions view_organizations
hammer filter create --role "$ROLE" --permissions view_locations
hammer filter create --role "$ROLE" --permissions view_domains
hammer filter create --role "$ROLE" --permissions view_hostgroups
hammer filter create --role "$ROLE" --permissions view_hosts
hammer filter create --role "$ROLE" --permissions view_architectures
hammer filter create --role "$ROLE" --permissions view_ptables
hammer filter create --role "$ROLE" --permissions view_operatingsystems
hammer filter create --role "$ROLE" --permissions create_hosts</pre></li><li class="listitem"><p class="simpara">
							Assign the new role to an existing user:
						</p><pre class="screen"># hammer user add-role --id <span class="emphasis"><em>user_id</em></span> --role <span class="emphasis"><em>Bootstrap</em></span></pre><p class="simpara">
							Alternatively, you can create a new user and assign this new role to them. For more information on creating users with Hammer, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/hammer_cli_guide/chap-cli_guide-managing_users_and_permissions#sect-CLI_Guide-Creating_Users">Creating Users</a> in the <span class="emphasis"><em>Hammer CLI Guide</em></span>.
						</p></li></ol></div></section><section class="section" id="advanced-bootstrap-script-configuration"><div class="titlepage"><div><div><h3 class="title">3.3.2. Advanced Bootstrap Script Configuration</h3></div></div></div><p>
					This section has more examples for using the bootstrap script to register or migrate a host.
				</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
						These examples specify the <code class="literal">admin</code> Satellite user. If this is not acceptable to your security policy, create a new role with the minimum permissions required by the bootstrap script. For more information, see <a class="xref" href="#setting-permissions-for-the-bootstrap-script" title="3.3.1. Setting Permissions for the Bootstrap Script">Section 3.3.1, “Setting Permissions for the Bootstrap Script”</a>.
					</p></div></div><div class="formalpara"><p class="title"><strong>Migrating a host from one Satellite 6 to another Satellite 6</strong></p><p>
						Use the script with <code class="literal">--force</code> to remove the <code class="literal">katello-ca-consumer-*</code> packages from the old Satellite and install the <code class="literal">katello-ca-consumer-*</code> packages on the new Satellite.
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 8, enter the following command:
						</p><pre class="screen"># /usr/libexec/platform-python bootstrap.py \
--login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--force</pre></li><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 5, 6, or 7, enter the following command:
						</p><pre class="screen"># bootstrap.py --login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--force</pre></li></ul></div><div class="formalpara"><p class="title"><strong>Migrating a host from Red Hat Network (RHN) or Satellite 5 to Satellite 6</strong></p><p>
						The bootstrap script detects the presence of <code class="literal">/etc/syconfig/rhn/systemid</code> and a valid connection to RHN as an indicator that the system is registered to a legacy platform. The script then calls <code class="literal">rhn-classic-migrate-to-rhsm</code> to migrate the system from RHN. By default, the script does not delete the system’s legacy profile due to auditing reasons. To remove the legacy profile, use <code class="literal">--legacy-purge</code>, and use <code class="literal">--legacy-login</code> to supply a user account that has appropriate permissions to remove a profile. Enter the user account password when prompted.
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 8, enter the following command:
						</p><pre class="screen"># /usr/libexec/platform-python bootstrap.py \
--login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--legacy-purge \
--legacy-login <span class="emphasis"><em>rhn-user</em></span></pre></li><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 5, 6, or 7, enter the following command:
						</p><pre class="screen"># bootstrap.py --login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--legacy-purge \
--legacy-login <span class="emphasis"><em>rhn-user</em></span></pre></li></ul></div><div class="formalpara"><p class="title"><strong>Registering a host to Satellite 6, omitting Puppet setup</strong></p><p>
						By default, the bootstrap script configures the host for content management and configuration management. If you have an existing configuration management system and do not want to install Puppet on the host, use <code class="literal">--skip-puppet</code>.
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 8, enter the following command:
						</p><pre class="screen"># /usr/libexec/platform-python bootstrap.py \
--login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--skip-puppet</pre></li><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 5, 6, or 7, enter the following command:
						</p><pre class="screen"># bootstrap.py --login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--skip-puppet</pre></li></ul></div><div class="formalpara"><p class="title"><strong>Registering a host to Satellite 6 for content management only</strong></p><p>
						To register a system as a content host, and omit the provisioning and configuration management functions, use <code class="literal">--skip-foreman</code>.
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 8, enter the following command:
						</p><pre class="screen"># /usr/libexec/platform-python bootstrap.py \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--skip-foreman</pre></li><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 5, 6, or 7, enter the following command:
						</p><pre class="screen"># bootstrap.py --server <span class="emphasis"><em>satellite6.example.com</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--skip-foreman</pre></li></ul></div><div class="formalpara"><p class="title"><strong>Changing the method the bootstrap script uses to download the consumer RPM</strong></p><p>
						By default, the bootstrap script uses HTTP to download the consumer RPM (<span class="emphasis"><em>server.example.com</em></span>/pub/katello-ca-consumer-latest.noarch.rpm). In some environments, you might want to allow HTTPS only between the host and Satellite. Use <code class="literal">--download-method</code> to change the download method from HTTP to HTTPS.
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 8, enter the following command:
						</p><pre class="screen"># /usr/libexec/platform-python bootstrap.py \
--login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--download-method https</pre></li><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 5, 6, or 7, enter the following command:
						</p><pre class="screen"># bootstrap.py --login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--download-method https</pre></li></ul></div><div class="formalpara"><p class="title"><strong>Providing the host’s IP address to Satellite</strong></p><p>
						On hosts with multiple interfaces or multiple IP addresses on one interface, you might need to override the auto-detection of the IP address and provide a specific IP address to Satellite. Use <code class="literal">--ip</code>.
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 8, enter the following command:
						</p><pre class="screen"># /usr/libexec/platform-python bootstrap.py \
--login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--ip <span class="emphasis"><em>192.x.x.x</em></span></pre></li><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 5, 6, or 7, enter the following command:
						</p><pre class="screen"># bootstrap.py --login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--ip <span class="emphasis"><em>192.x.x.x</em></span></pre></li></ul></div><div class="formalpara"><p class="title"><strong>Enabling remote execution on the host</strong></p><p>
						Use <code class="literal">--rex</code> and <code class="literal">--rex-user</code> to enable remote execution and add the required SSH keys for the specified user.
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 8, enter the following command:
						</p><pre class="screen"># /usr/libexec/platform-python bootstrap.py \
--login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--rex \
--rex-user <span class="emphasis"><em>root</em></span></pre></li><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 5, 6, or 7, enter the following command:
						</p><pre class="screen"># bootstrap.py --login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--rex \
--rex-user <span class="emphasis"><em>root</em></span></pre></li></ul></div><div class="formalpara"><p class="title"><strong>Creating a domain for a host during registration</strong></p><p>
						To create a host record, the DNS domain of a host needs to exist in Satellite prior to running the script. If the domain does not exist, add it using <code class="literal">--add-domain</code>.
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 8, enter the following command:
						</p><pre class="screen"># /usr/libexec/platform-python bootstrap.py \
--login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--add-domain</pre></li><li class="listitem"><p class="simpara">
							On Red Hat Enterprise Linux 5, 6, or 7, enter the following command:
						</p><pre class="screen"># bootstrap.py --login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--add-domain</pre></li></ul></div><div class="formalpara"><p class="title"><strong>Providing an alternative FQDN for the host</strong></p><p>
						If the host’s host name is not an FQDN, or is not RFC-compliant (containing a character such as an underscore), the script will fail at the host name validation stage. If you cannot update the host to use an FQDN that is accepted by Satellite, you can use the bootstrap script to specify an alternative FQDN.
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Set <code class="literal">create_new_host_when_facts_are_uploaded</code> and <code class="literal">create_new_host_when_report_is_uploaded</code> to false using Hammer:
						</p><pre class="screen"># hammer settings set \
--name  create_new_host_when_facts_are_uploaded \
--value false
# hammer settings set \
--name  create_new_host_when_report_is_uploaded \
--value false</pre></li><li class="listitem"><p class="simpara">
							Use <code class="literal">--fqdn</code> to specify the FQDN that will be reported to Satellite:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									On Red Hat Enterprise Linux 8, enter the following command:
								</p><pre class="screen"># /usr/libexec/platform-python bootstrap.py --login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--fqdn <span class="emphasis"><em>node100.example.com</em></span></pre></li><li class="listitem"><p class="simpara">
									On Red Hat Enterprise Linux 5, 6, or 7, enter the following command:
								</p><pre class="screen"># bootstrap.py --login=<span class="emphasis"><em>admin</em></span> \
--server <span class="emphasis"><em>satellite6.example.com</em></span> \
--location=<span class="emphasis"><em>"Example Location"</em></span> \
--organization=<span class="emphasis"><em>"Example Organization"</em></span> \
--hostgroup=<span class="emphasis"><em>"Example Host Group"</em></span> \
--activationkey=<span class="emphasis"><em>activation_key</em></span> \
--fqdn <span class="emphasis"><em>node100.example.com</em></span></pre></li></ul></div></li></ol></div></section></section><section class="section" id="installing-the-katello-agent_managing-hosts"><div class="titlepage"><div><div><h2 class="title">3.4. Installing the Katello Agent</h2></div></div></div><p>
				To remotely update Satellite clients, you must install the Katello agent.
			</p><p>
				The <code class="literal">katello-agent</code> package depends on the <code class="literal">gofer</code> package that provides the <code class="literal">goferd</code> service. This service must be enabled so that Satellite Server or Capsule Server can provide information about errata that are applicable for content hosts.
			</p><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
					Before installing the Katello agent, ensure the following conditions are met:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						You have enabled the Satellite Tools repository on Satellite Server. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/installing_satellite_server_from_a_connected_network/performing_additional_configuration_on_satellite_server#enabling_satellite_tools_repository">Enabling the Satellite Tools Repository</a> in <span class="emphasis"><em>Installing Satellite Server from a Connected Network</em></span>.
					</li><li class="listitem">
						You have synchronized the Satellite Tools repository on Satellite Server. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/installing_satellite_server_from_a_connected_network/performing_additional_configuration_on_satellite_server#synchronizing_satellite_tools_repository">Synchronizing the Satellite Tools Repository</a> in <span class="emphasis"><em>Installing Satellite Server from a Connected Network</em></span>.
					</li><li class="listitem">
						You have enabled the rhel-7-server-satellite-tools-6.7-rpms repository on the client.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					To install the Katello agent, complete the following steps:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal">katello-agent</code> package:
					</p><pre class="screen"># yum install katello-agent</pre></li><li class="listitem"><p class="simpara">
						Start the <code class="literal">goferd</code> service :
					</p><pre class="screen"># systemctl start goferd</pre></li></ol></div></section><section class="section" id="installing-tracer"><div class="titlepage"><div><div><h2 class="title">3.5. Installing Tracer</h2></div></div></div><p>
				Use this procedure to install Tracer on Red Hat Satellite 6.7, and access Traces. Tracer displays a list of services and applications that are outdated and need to be restarted. Traces is the output generated by Tracer in the Satellite web UI.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The integration of Tracer with Satellite Server is a Technology Preview feature. Technology Preview features are not fully supported under Red Hat Subscription Service Level Agreements (SLAs), may not be functionally complete, and are not intended for production use. These features provide early access to upcoming product innovations, enabling customers to test functionality and provide feedback during the development process. For more information see <a class="link" href="https://access.redhat.com/support/offerings/techpreview/">Red Hat Technology Preview Features Support Scope</a>.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The host must be registered to Red Hat Satellite.
					</li><li class="listitem">
						The Red Hat Satellite Tools 6.7 repository must be enabled and synchronized on Satellite Server, and enabled on the host.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the content host, install the <code class="literal">katello-host-tools-tracer</code> RPM package:
					</p><pre class="screen"># yum install katello-host-tools-tracer</pre></li><li class="listitem"><p class="simpara">
						Enter the following command:
					</p><pre class="screen"># katello-tracer-upload</pre></li><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All hosts</strong></span>, then click the required host name.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Properties</strong></span> tab, examine the <span class="strong strong"><strong>Properties</strong></span> table and find the Traces item. If you cannot find a Traces item in the <span class="strong strong"><strong>Properties</strong></span> table, then Tracer is not installed.
					</li><li class="listitem">
						Navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Content Hosts</strong></span>, then click the required host name.
					</li><li class="listitem">
						Click the <span class="strong strong"><strong>Traces</strong></span> tab to view Traces.
					</li></ol></div></section><section class="section" id="installing-and-configuring-the-puppet-agent"><div class="titlepage"><div><div><h2 class="title">3.6. Installing and Configuring the Puppet Agent</h2></div></div></div><p>
				Use this procedure to install and configure the Puppet agent on a host. For more information about Puppet, see the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/puppet_guide/"><span class="emphasis"><em>Puppet Guide</em></span></a>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The host must be registered to Red Hat Satellite.
					</li><li class="listitem">
						The host must have a Puppet environment assigned to it.
					</li><li class="listitem">
						The Red Hat Satellite Tools 6.7 repository must be enabled and synchronized on Satellite Server, and enabled on the host.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log in to the host as the <code class="literal">root</code> user.
					</li><li class="listitem"><p class="simpara">
						Install the Puppet agent package:
					</p><pre class="screen"># yum install puppet-agent</pre></li><li class="listitem"><p class="simpara">
						Configure the Puppet agent to start on boot:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								On Red Hat Enterprise Linux 6:
							</p><pre class="screen"># chkconfig puppet on</pre></li><li class="listitem"><p class="simpara">
								On Red Hat Enterprise Linux 7:
							</p><pre class="screen"># systemctl enable puppet</pre></li></ul></div></li><li class="listitem"><p class="simpara">
						Append the following server and environment settings to the <code class="literal">/etc/puppetlabs/puppet/puppet.conf</code> file. Set the <code class="literal">environment</code> parameter to the name of the Puppet environment to which the host belongs:
					</p><pre class="screen">environment = <span class="emphasis"><em>My_Example_Org_Library</em></span>
server = <span class="emphasis"><em>satellite.example.com</em></span>
ca_server = <span class="emphasis"><em>satellite.example.com</em></span></pre></li><li class="listitem"><p class="simpara">
						Run the Puppet agent on the host:
					</p><pre class="screen"># puppet agent -t</pre></li><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Infrastructure</strong></span> &gt; <span class="strong strong"><strong>Capsules</strong></span>.
					</li><li class="listitem">
						From the list in the <span class="strong strong"><strong>Actions</strong></span> column for the required Capsule Server, select <span class="strong strong"><strong>Certificates</strong></span>.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Sign</strong></span> to the right of the required host to sign the SSL certificate for the Puppet client.
					</li><li class="listitem"><p class="simpara">
						Enter the <code class="literal">puppet agent</code> command again:
					</p><pre class="screen"># puppet agent -t</pre></li></ol></div></section></section><section class="chapter" id="Adding_Network_Interfaces"><div class="titlepage"><div><div><h1 class="title">Chapter 4. Adding Network Interfaces</h1></div></div></div><p>
			Red Hat Satellite supports specifying multiple network interfaces for a single host. You can configure these interfaces when creating a new host as described in <a class="xref" href="#creating-a-host-in-satellite" title="2.1. Creating a Host in Red Hat Satellite">Section 2.1, “Creating a Host in Red Hat Satellite”</a> or when editing an existing host.
		</p><p>
			There are several types of network interfaces that you can attach to a host. When adding a new interface, select one of:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					<span class="strong strong"><strong>Interface</strong></span>: Allows you to specify an additional physical or virtual interface. There are two types of virtual interfaces you can create. Use <span class="strong strong"><strong>VLAN</strong></span> when the host needs to communicate with several (virtual) networks using a single interface, while these networks are not accessible to each other. Use <span class="strong strong"><strong>alias</strong></span> to add an additional IP address to an existing interface.
				</p><p class="simpara">
					For more information about adding a physical interface, see <a class="xref" href="#adding-a-physical-interface" title="4.1. Adding a Physical Interface">Section 4.1, “Adding a Physical Interface”</a>.
				</p><p class="simpara">
					For more information about adding a virtual interface, see <a class="xref" href="#adding-a-virtual-interface" title="4.2. Adding a Virtual Interface">Section 4.2, “Adding a Virtual Interface”</a>.
				</p></li><li class="listitem">
					<span class="strong strong"><strong>Bond</strong></span>: Creates a bonded interface. NIC bonding is a way to bind multiple network interfaces together into a single interface that appears as a single device and has a single MAC address. This enables two or more network interfaces to act as one, increasing the bandwidth and providing redundancy. See <a class="xref" href="#adding-a-bonded-interface" title="4.3. Adding a Bonded Interface">Section 4.3, “Adding a Bonded Interface”</a> for details.
				</li><li class="listitem">
					<span class="strong strong"><strong>BMC</strong></span>: Baseboard Management Controller (BMC) allows you to remotely monitor and manage the physical state of machines. For more information about BMC, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/installing_satellite_server_from_a_connected_network/performing_additional_configuration_on_satellite_server#enabling-power-management-on-managed-hosts_satellite">Enabling Power Management on Managed Hosts</a> in <span class="emphasis"><em>Installing Satellite Server from a Connected Network</em></span>. For more information about configuring BMC interfaces, see <a class="xref" href="#adding-a-bmc-interface" title="4.4. Adding a Baseboard Management Controller (BMC) Interface">Section 4.4, “Adding a Baseboard Management Controller (BMC) Interface”</a>.
				</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				Additional interfaces have the <span class="strong strong"><strong>Managed</strong></span> flag enabled by default, which means the new interface is configured automatically during provisioning by the DNS and DHCP Capsule Servers associated with the selected subnet. This requires a subnet with correctly configured DNS and DHCP Capsule Servers. If you use a Kickstart method for host provisioning, configuration files are automatically created for managed interfaces in the post-installation phase at <code class="literal">/etc/sysconfig/network-scripts/ifcfg-<span class="emphasis"><em>interface_id</em></span></code>.
			</p></div></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				Virtual and bonded interfaces currently require a MAC address of a physical device. Therefore, the configuration of these interfaces works only on bare-metal hosts.
			</p></div></div><section class="section" id="adding-a-physical-interface"><div class="titlepage"><div><div><h2 class="title">4.1. Adding a Physical Interface</h2></div></div></div><p>
				Use this procedure to add an additional physical interface to a host.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All hosts</strong></span>.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Edit</strong></span> next to the host you want to edit.
					</li><li class="listitem">
						On the <span class="strong strong"><strong>Interfaces</strong></span> tab, click <span class="strong strong"><strong>Add Interface</strong></span>.
					</li><li class="listitem">
						Keep the <span class="strong strong"><strong>Interface</strong></span> option selected in the <span class="strong strong"><strong>Type</strong></span> list.
					</li><li class="listitem">
						Specify a <span class="strong strong"><strong>MAC address</strong></span>. This setting is required.
					</li><li class="listitem">
						Specify the <span class="strong strong"><strong>Device Identifier</strong></span>, for example <span class="strong strong"><strong>eth0</strong></span>. The identifier is used to specify this physical interface when creating bonded interfaces, VLANs, and aliases.
					</li><li class="listitem">
						Specify the <span class="strong strong"><strong>DNS name</strong></span> associated with the host’s IP address. Satellite saves this name in the Capsule Server associated with the selected domain (the "DNS A" field) and the Capsule Server associated with the selected subnet (the "DNS PTR" field). A single host can therefore have several DNS entries.
					</li><li class="listitem">
						Select a domain from the <span class="strong strong"><strong>Domain</strong></span> list. To create and manage domains, navigate to <span class="strong strong"><strong>Infrastructure</strong></span> &gt; <span class="strong strong"><strong>Domains</strong></span>.
					</li><li class="listitem">
						Select a subnet from the <span class="strong strong"><strong>Subnet</strong></span> list. To create and manage subnets, navigate to <span class="strong strong"><strong>Infrastructure</strong></span> &gt; <span class="strong strong"><strong>Subnets</strong></span>.
					</li><li class="listitem">
						Specify the <span class="strong strong"><strong>IP address</strong></span>. Managed interfaces with an assigned DHCP Capsule Server require this setting for creating a DHCP lease. DHCP-enabled managed interfaces are automatically provided with a suggested IP address.
					</li><li class="listitem">
						Select whether the interface is <span class="strong strong"><strong>Managed</strong></span>. If the interface is managed, configuration is pulled from the associated Capsule Server during provisioning, and DNS and DHCP entries are created. If using kickstart provisioning, a configuration file is automatically created for the interface.
					</li><li class="listitem">
						Select whether this is the <span class="strong strong"><strong>Primary</strong></span> interface for the host. The DNS name from the primary interface is used as the host portion of the FQDN.
					</li><li class="listitem">
						Select whether this is the <span class="strong strong"><strong>Provision</strong></span> interface for the host. TFTP boot takes place using the provisioning interface. For image-based provisioning, the script to complete the provisioning is executed through the provisioning interface.
					</li><li class="listitem">
						Select whether to use the interface for <span class="strong strong"><strong>Remote execution</strong></span>.
					</li><li class="listitem">
						Leave the <span class="strong strong"><strong>Virtual NIC</strong></span> check box clear.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>OK</strong></span> to save the interface configuration.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span> to apply the changes to the host.
					</li></ol></div></section><section class="section" id="adding-a-virtual-interface"><div class="titlepage"><div><div><h2 class="title">4.2. Adding a Virtual Interface</h2></div></div></div><p>
				Use this procedure to configure a virtual interface for a host. This can be either a VLAN or an alias interface.
			</p><p>
				An alias interface is an additional IP address attached to an existing interface. An alias interface automatically inherits a MAC address from the interface it is attached to; therefore, you can create an alias without specifying a MAC address. The interface must be specified in a subnet with boot mode set to <code class="literal">static</code>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All hosts</strong></span>.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Edit</strong></span> next to the host you want to edit.
					</li><li class="listitem">
						On the <span class="strong strong"><strong>Interfaces</strong></span> tab, click <span class="strong strong"><strong>Add Interface</strong></span>.
					</li><li class="listitem">
						Keep the <span class="strong strong"><strong>Interface</strong></span> option selected in the <span class="strong strong"><strong>Type</strong></span> list.
					</li><li class="listitem"><p class="simpara">
						Specify the general interface settings. The applicable configuration options are the same as for the physical interfaces described in <a class="xref" href="#adding-a-physical-interface" title="4.1. Adding a Physical Interface">Section 4.1, “Adding a Physical Interface”</a>.
					</p><p class="simpara">
						Specify a <span class="strong strong"><strong>MAC address</strong></span> for managed virtual interfaces so that the configuration files for provisioning are generated correctly. However, a <span class="strong strong"><strong>MAC address</strong></span> is not required for virtual interfaces that are not managed.
					</p><p class="simpara">
						If creating a VLAN, specify ID in the form of <span class="strong strong"><strong>eth1.10</strong></span> in the <span class="strong strong"><strong>Device Identifier</strong></span> field. If creating an alias, use ID in the form of <span class="strong strong"><strong>eth1:10</strong></span>.
					</p></li><li class="listitem"><p class="simpara">
						Select the <span class="strong strong"><strong>Virtual NIC</strong></span> check box. Additional configuration options specific to virtual interfaces are appended to the form:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Tag</strong></span>: Optionally set a VLAN tag to trunk a network segment from the physical network through to the virtual interface. If you do not specify a tag, managed interfaces inherit the VLAN tag of the associated subnet. User-specified entries from this field are not applied to alias interfaces.
							</li><li class="listitem">
								<span class="strong strong"><strong>Attached to</strong></span>: Specify the identifier of the physical interface to which the virtual interface belongs, for example <span class="strong strong"><strong>eth1</strong></span>. This setting is required.
							</li></ul></div></li><li class="listitem">
						Click <span class="strong strong"><strong>OK</strong></span> to save the interface configuration.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span> to apply the changes to the host.
					</li></ol></div></section><section class="section" id="adding-a-bonded-interface"><div class="titlepage"><div><div><h2 class="title">4.3. Adding a Bonded Interface</h2></div></div></div><p>
				Use this procedure to configure a bonded interface for a host.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All hosts</strong></span>.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Edit</strong></span> next to the host you want to edit.
					</li><li class="listitem">
						On the <span class="strong strong"><strong>Interfaces</strong></span> tab, click <span class="strong strong"><strong>Add Interface</strong></span>.
					</li><li class="listitem">
						Select <span class="strong strong"><strong>Bond</strong></span> from the <span class="strong strong"><strong>Type</strong></span> list. Additional type-specific configuration options are appended to the form.
					</li><li class="listitem"><p class="simpara">
						Specify the general interface settings. The applicable configuration options are the same as for the physical interfaces described in <a class="xref" href="#adding-a-physical-interface" title="4.1. Adding a Physical Interface">Section 4.1, “Adding a Physical Interface”</a>.
					</p><p class="simpara">
						Bonded interfaces use IDs in the form of <span class="strong strong"><strong>bond0</strong></span> in the <span class="strong strong"><strong>Device Identifier</strong></span> field.
					</p><p class="simpara">
						A single <span class="strong strong"><strong>MAC address</strong></span> is sufficient.
					</p></li><li class="listitem"><p class="simpara">
						Specify the configuration options specific to bonded interfaces:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Mode</strong></span>: Select the bonding mode that defines a policy for fault tolerance and load balancing. See <a class="xref" href="#Bonding_Modes_Available_in_Red_Hat_Satellite" title="Table 4.1. Bonding Modes Available in Red Hat Satellite">Table 4.1, “Bonding Modes Available in Red Hat Satellite”</a> for a brief description of each bonding mode.
							</li><li class="listitem">
								<span class="strong strong"><strong>Attached devices</strong></span>: Specify a comma-separated list of identifiers of attached devices. These can be physical interfaces or VLANs.
							</li><li class="listitem">
								<span class="strong strong"><strong>Bond options</strong></span>: Specify a space-separated list of configuration options, for example <span class="strong strong"><strong>miimon=100</strong></span>. See the <a class="link" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Networking_Guide/index.html">Red Hat Enterprise Linux 7 Networking Guide</a> for details of the configuration options you can specify for the bonded interface.
							</li></ul></div></li><li class="listitem">
						Click <span class="strong strong"><strong>OK</strong></span> to save the interface configuration.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span> to apply the changes to the host.
					</li></ol></div><div class="formalpara"><p class="title"><strong>For CLI Users</strong></p><p>
					To create a host with a bonded interface, enter the following command:
				</p></div><pre class="screen"># hammer host create --name bonded_interface \
--hostgroup-id <span class="emphasis"><em>1</em></span> \
--ip=<span class="emphasis"><em>192.168.100.123</em></span> \
--mac=<span class="emphasis"><em>52:54:00:14:92:2a</em></span> \
--subnet-id=<span class="emphasis"><em>1</em></span> \
--managed true \
   --interface="identifier=<span class="emphasis"><em>eth1</em></span>, \
               mac=<span class="emphasis"><em>52:54:00:62:43:06</em></span>, \
               managed=true, \
               type=Nic::Managed, \
               domain_id=<span class="emphasis"><em>1</em></span>, \
               subnet_id=<span class="emphasis"><em>1</em></span>" \
   --interface="identifier=<span class="emphasis"><em>eth2</em></span>, \
               mac=<span class="emphasis"><em>52:54:00:d3:87:8f</em></span>, \
               managed=true, \
               type=Nic::Managed, \
               domain_id=<span class="emphasis"><em>1</em></span>, \
               subnet_id=<span class="emphasis"><em>1</em></span>" \
   --interface="identifier=<span class="emphasis"><em>bond0</em></span>, \
               ip=<span class="emphasis"><em>172.25.18.123</em></span>, \
               type=Nic::Bond, \
               mode=active-backup, \
               attached_devices=[<span class="emphasis"><em>eth1,eth2</em></span>], \
               managed=true, \
               domain_id=<span class="emphasis"><em>1</em></span>, \
               subnet_id=<span class="emphasis"><em>1</em></span>" \
--organization "<span class="emphasis"><em>Your_Organization</em></span>" \
--location "<span class="emphasis"><em>Your_Location</em></span>" \
--ask-root-password yes</pre><div class="table" id="Bonding_Modes_Available_in_Red_Hat_Satellite"><p class="title"><strong>Table 4.1. Bonding Modes Available in Red Hat Satellite</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45628288387840" scope="col">Bonding Mode</th><th align="left" valign="top" id="idm45628288386752" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45628288387840">
							<p>
								balance-rr
							</p>
							</td><td align="left" valign="top" headers="idm45628288386752">
							<p>
								Transmissions are received and sent sequentially on each bonded interface.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628288387840">
							<p>
								active-backup
							</p>
							</td><td align="left" valign="top" headers="idm45628288386752">
							<p>
								Transmissions are received and sent through the first available bonded interface. Another bonded interface is only used if the active bonded interface fails.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628288387840">
							<p>
								balance-xor
							</p>
							</td><td align="left" valign="top" headers="idm45628288386752">
							<p>
								Transmissions are based on the selected hash policy. In this mode, traffic destined for specific peers is always sent over the same interface.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628288387840">
							<p>
								broadcast
							</p>
							</td><td align="left" valign="top" headers="idm45628288386752">
							<p>
								All transmissions are sent on all bonded interfaces.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628288387840">
							<p>
								802.a3
							</p>
							</td><td align="left" valign="top" headers="idm45628288386752">
							<p>
								Creates aggregation groups that share the same settings. Transmits and receives on all interfaces in the active group.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628288387840">
							<p>
								balance-tlb
							</p>
							</td><td align="left" valign="top" headers="idm45628288386752">
							<p>
								The outgoing traffic is distributed according to the current load on each bonded interface.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628288387840">
							<p>
								balance-alb
							</p>
							</td><td align="left" valign="top" headers="idm45628288386752">
							<p>
								Receive load balancing is achieved through Address Resolution Protocol (ARP) negotiation.
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="adding-a-bmc-interface"><div class="titlepage"><div><div><h2 class="title">4.4. Adding a Baseboard Management Controller (BMC) Interface</h2></div></div></div><p>
				Use this procedure to configure a baseboard management controller (BMC) interface for a host that supports this feature.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">ipmitool</code> package is installed.
					</li><li class="listitem"><p class="simpara">
						You know the MAC address, IP address, and other details of the BMC interface on the host, and the appropriate credentials for that interface.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You only need the MAC address for the BMC interface if the BMC interface is managed, so that it can create a DHCP reservation.
						</p></div></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Enable BMC on the Capsule server if it is not already enabled:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Configure BMC power management on the Capsule Server by running the <code class="literal">satellite-installer</code> script with the following options:
							</p><pre class="screen"># satellite-installer --foreman-proxy-bmc=true \
--foreman-proxy-bmc-default-provider=ipmitool</pre></li><li class="listitem">
								In the Satellite web UI, navigate to <span class="strong strong"><strong>Infrastructure</strong></span> &gt; <span class="strong strong"><strong>Capsules</strong></span>.
							</li><li class="listitem">
								From the list in the <span class="strong strong"><strong>Actions</strong></span> column, click <span class="strong strong"><strong>Refresh</strong></span>. The list in the <span class="strong strong"><strong>Features</strong></span> column should now include BMC.
							</li></ol></div></li><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All hosts</strong></span>.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Edit</strong></span> next to the host you want to edit.
					</li><li class="listitem">
						On the <span class="strong strong"><strong>Interfaces</strong></span> tab, click <span class="strong strong"><strong>Add Interface</strong></span>.
					</li><li class="listitem">
						Select <span class="strong strong"><strong>BMC</strong></span> from the <span class="strong strong"><strong>Type</strong></span> list. Type-specific configuration options are appended to the form.
					</li><li class="listitem">
						Specify the general interface settings. The applicable configuration options are the same as for the physical interfaces described in <a class="xref" href="#adding-a-physical-interface" title="4.1. Adding a Physical Interface">Section 4.1, “Adding a Physical Interface”</a>.
					</li><li class="listitem"><p class="simpara">
						Specify the configuration options specific to BMC interfaces:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>Username</strong></span> and <span class="strong strong"><strong>Password</strong></span>: Specify any authentication credentials required by BMC.
							</li><li class="listitem">
								<span class="strong strong"><strong>Provider</strong></span>: Specify the BMC provider.
							</li></ul></div></li><li class="listitem">
						Click <span class="strong strong"><strong>OK</strong></span> to save the interface configuration.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span> to apply the changes to the host.
					</li></ol></div></section></section><section class="chapter" id="host_management_and_monitoring_using_red_hat_web_console"><div class="titlepage"><div><div><h1 class="title">Chapter 5. Host Management and Monitoring Using Red Hat Web Console</h1></div></div></div><p>
			Red Hat web console is an interactive web interface that you can use to perform actions and monitor Red Hat Enterprise Linux hosts. You can enable a remote-execution feature to integrate Satellite with Red Hat web console. When you install Red Hat web console on a host that you manage with Satellite, you can view the Red Hat web console dashboards of that host from within the Satellite web UI. You can also use the features that are integrated with Red Hat web console, for example, Red Hat Image Builder.
		</p><section class="section" id="integrating_satellite_with_red_hat_web_console"><div class="titlepage"><div><div><h2 class="title">5.1. Integrating Satellite with Red Hat Web Console</h2></div></div></div><p>
				By default, Red Hat web console integration is disabled in Satellite. If you want to access Red Hat web console features for your hosts from within Satellite, you must first enable Red Hat web console integration on Satellite Server.
			</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On Satellite Server, run <code class="literal">satellite-installer</code> with the <code class="literal">--enable-foreman-plugin-remote-execution-cockpit</code> option:
					</p><pre class="screen"># satellite-installer --enable-foreman-plugin-remote-execution-cockpit</pre></li></ul></div></section><section class="section" id="managing_and_monitoring_hosts_using_red_hat_web_console"><div class="titlepage"><div><div><h2 class="title">5.2. Managing and Monitoring Hosts Using Red Hat Web Console</h2></div></div></div><p>
				You can access the Red Hat web console web UI through the Satellite web UI and use the functionality to manage and monitor hosts in Satellite.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Red Hat web console is enabled in Satellite.
					</li><li class="listitem"><p class="simpara">
						Red Hat web console is installed on the host that you want to view:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								For Red Hat Enterprise Linux 8, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/managing_systems_using_the_rhel_8_web_console/getting-started-with-the-rhel-8-web-console_system-management-using-the-rhel-8-web-console#installing-the-web-console_getting-started-with-the-rhel-8-web-console">Installing the web console</a> in the <span class="emphasis"><em>Managing systems using the RHEL 8 web console</em></span> guide.
							</li><li class="listitem">
								For Red Hat Enterprise Linux 7, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/managing_systems_using_the_rhel_7_web_console/getting-started-with-the-rhel-web-console_system-management-using-the-rhel-7-web-console#installing-the-web-console_getting-started-with-the-web-console">Installing the web console</a> in the <span class="emphasis"><em>Managing systems using the RHEL 7 web console</em></span> guide.
							</li></ul></div></li><li class="listitem">
						Satellite or Capsule can authenticate to the host with SSH keys. For more information, <a class="xref" href="#sect-Managing_Hosts-Establishing_a_Secure_Connection_for_Remote_Commands" title="10.3. Distributing SSH Keys for Remote Execution">Section 10.3, “Distributing SSH Keys for Remote Execution”</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All Hosts</strong></span> and select the host that you want to manage and monitor with Red Hat web console.
					</li><li class="listitem">
						In the upper right of the host window, click <span class="strong strong"><strong>Web Console</strong></span>.
					</li></ol></div><p>
				You can now access the full range of features available for host monitoring and management, for example, Red Hat Image Builder, through the Red Hat web console.
			</p><p>
				For more information about getting started with Red Hat web console, see the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/managing_systems_using_the_rhel_8_web_console/index"><span class="emphasis"><em>Managing systems using the RHEL 8 web console</em></span></a> guide or the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/managing_systems_using_the_rhel_7_web_console/getting-started-with-the-rhel-web-console_system-management-using-the-rhel-7-web-console#installing-the-web-console_getting-started-with-the-web-console"><span class="emphasis"><em>Managing systems using the RHEL 7 web console</em></span></a> guide.
			</p><p>
				For more information about using Red Hat Image Builder through the Red Hat web console, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/composing_a_customized_rhel_system_image/creating-system-images-with-composer-web-console-interface_composing-a-customized-rhel-system-image#accessing-composer-gui-in-the-rhel-8-web-console_creating-system-images-with-composer-web-console-interface">Accessing Image Builder GUI in the RHEL 8 web console</a> or <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/image_builder_guide/chap-documentation-image_builder-test_chapter_4#sect-Documentation-Image_Builder-Chapter4">Accessing Image Builder GUI in the RHEL 7 web console</a>.
			</p></section></section><section class="chapter" id="Monitoring_Hosts"><div class="titlepage"><div><div><h1 class="title">Chapter 6. Monitoring Hosts Using Red Hat Insights</h1></div></div></div><p>
			In this chapter, you can find information about creating host monitoring reports and monitoring your hosts using Red Hat Insights and creating an Insights plan.
		</p><section class="section" id="using-insights-with-satellite-hosts"><div class="titlepage"><div><div><h2 class="title">6.1. Using Red Hat Insights with Hosts in Satellite</h2></div></div></div><p>
				You can use Red Hat Insights to diagnose systems and downtime related to security exploits, performance degradation and stability failures. You can use the dashboard to quickly identify key risks to stability, security, and performance. You can sort by category, view details of the impact and resolution, and then determine what systems are affected.
			</p><p>
				To use Red Hat Insights to monitor hosts that you manage with Satellite, you must first install Red Hat Insights on your hosts and register your hosts with Red Hat Insights.
			</p><p>
				To install and register your host using Puppet, or manually, see <a class="link" href="https://access.redhat.com/products/red-hat-insights/#getstarted">Red Hat Insights Getting Started</a>.
			</p><div class="formalpara"><p class="title"><strong>Deploying Red Hat Insights using the Ansible Role</strong></p><p>
					You can automate the installation and registration of hosts with Red Hat Insights using the <span class="strong strong"><strong>RedHatInsights.insights-client</strong></span> Ansible role. For more information about adding this role to your Satellite, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/administering_red_hat_satellite/chap-Red_Hat_Satellite-Administering_Red_Hat_Satellite-Managing_Ansible_Roles">Managing Ansible Roles</a>.
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add the <span class="strong strong"><strong>RedHatInsights.insights-client</strong></span> role to the hosts.
					</p><p class="simpara">
						For new hosts, see <a class="xref" href="#creating-a-host-in-satellite" title="2.1. Creating a Host in Red Hat Satellite">Section 2.1, “Creating a Host in Red Hat Satellite”</a>.
					</p><p class="simpara">
						For existing hosts, see <a class="xref" href="#Using_Ansible_Roles" title="Chapter 9. Using Ansible Roles">Chapter 9, <em>Using Ansible Roles</em></a>.
					</p></li><li class="listitem">
						To run the <span class="strong strong"><strong>RedHatInsights.insights-client</strong></span> role on your host, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All Hosts</strong></span> and click the name of the host that you want to use.
					</li><li class="listitem">
						Click the <span class="strong strong"><strong>Run Ansible roles</strong></span> button.
					</li></ol></div><p>
				When the role completes, you can view and work with the host that you add on the <span class="strong strong"><strong>Insights</strong></span> &gt; <span class="strong strong"><strong>Overview</strong></span> page of the Satellite web UI.
			</p><div class="itemizedlist"><p class="title"><strong>Additional Information</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						To apply any system updates to the Red Hat Insights plug-in, enter <code class="literal">httpd restart</code> after updating.
					</li><li class="listitem">
						To view the logs for Red Hat Insights and all plug-ins, go to <code class="literal">/var/log/foreman/production.log</code>.
					</li><li class="listitem">
						If you have problems connecting to Red Hat Insights, ensure that your certificates are up-to-date. Refresh your subscription manifest to update your certificates.
					</li><li class="listitem">
						You can change the default schedule for running <code class="literal">insights-client</code> by configuring <code class="literal">insights-client.timer</code> on a host. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_insights/1.0/html/client_configuration_guide_for_red_hat_insights/changing-the-client-schedule"> Changing the insights-client schedule</a> in the <span class="emphasis"><em>Client Configuration Guide for Red Hat Insights</em></span>.
					</li></ul></div></section><section class="section" id="creating-an-insights-plan"><div class="titlepage"><div><div><h2 class="title">6.2. Creating an Insights Plan for Hosts</h2></div></div></div><p>
				With Satellite 6, you can create a Red Hat Insights remediation plan and run the plan on Satellite hosts.
			</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					To create the plan, complete the following steps:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Insights</strong></span> &gt; <span class="strong strong"><strong>Inventory</strong></span>, and select the hosts that you want to include in an Insights plan.
					</li><li class="listitem">
						From the <span class="strong strong"><strong>Actions</strong></span> list, select <span class="strong strong"><strong>Create a new Plan/Playbook</strong></span>.
					</li><li class="listitem">
						From the Plan/Playbook Builder window, select <span class="strong strong"><strong>Create new plan</strong></span> and enter a name for the plan.
					</li><li class="listitem">
						Select whether you want the rule to apply to a specific system, group, or all systems.
					</li><li class="listitem">
						Select one or more rules that you want to add to the plan. Use the <span class="strong strong"><strong>Filter</strong></span> field to search for specific keywords.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Save</strong></span>.
					</li><li class="listitem">
						In the Planner window, select <span class="strong strong"><strong>Run Playbook</strong></span>.
					</li></ol></div><p>
				In the Jobs window, you can view the progress of your plan as the playbook runs.
			</p><p>
				You can view the Insights plan by navigating to <span class="strong strong"><strong>Insights</strong></span> &gt; <span class="strong strong"><strong>Planner</strong></span>.
			</p></section></section><section class="chapter" id="using_report_templates"><div class="titlepage"><div><div><h1 class="title">Chapter 7. Using Report Templates to Monitor Hosts</h1></div></div></div><p>
			You can use report templates to query Satellite data to obtain information about, for example, host status, registered hosts, applicable errata, applied errata, subscription details, and user activity. You can use the report templates that ship with Satellite or write your own custom report templates to suit your requirements. The reporting engine uses the embedded Ruby (ERB) syntax. For more information about writing templates and ERB syntax, see <a class="xref" href="#appe-Red_Hat_Satellite-Managing_Hosts-Template_Writing_Reference" title="Appendix A. Template Writing Reference">Appendix A, <em>Template Writing Reference</em></a>.
		</p><p>
			You can create a template, or clone a template and edit the clone. For help with the template syntax, click a template and click the <span class="strong strong"><strong>Help</strong></span> tab.
		</p><section class="section" id="chap-Managing_Hosts-Generating_Host_Monitoring_Reports"><div class="titlepage"><div><div><h2 class="title">7.1. Generating Host Monitoring Reports</h2></div></div></div><p>
				To view the report templates, in the Satellite web UI, navigate to <span class="strong strong"><strong>Monitor</strong></span> &gt; <span class="strong strong"><strong>Report Templates</strong></span>.
			</p><p>
				To schedule reports, you can configure a cron job or use the Satellite web UI.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Monitor</strong></span> &gt; <span class="strong strong"><strong>Report Templates</strong></span>.
					</li><li class="listitem">
						To the right of the report template that you want to use, click <span class="strong strong"><strong>Generate</strong></span>.
					</li><li class="listitem">
						Optional: To schedule a report, to the right of the <span class="strong strong"><strong>Generate at</strong></span> field, click the icon to select the date and time you want to generate the report at.
					</li><li class="listitem">
						Optional: To send a report to an e-mail address, select the <span class="strong strong"><strong>Send report via e-mail</strong></span> check box, and in the <span class="strong strong"><strong>Deliver to e-mail addresses</strong></span> field, enter the required e-mail address.
					</li><li class="listitem">
						Optional: Apply search query filters. To view all available results, do not populate the filter field with any values.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span>. A CSV file that contains the report is downloaded. If you have selected the <span class="strong strong"><strong>Send report via e-mail</strong></span> check box, the host monitoring report is sent to your e-mail address.
					</li></ol></div><div class="formalpara"><p class="title"><strong>For CLI Users</strong></p><p>
					To generate a report, complete the following steps:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						List all available report templates:
					</p><pre class="screen"># hammer report-template list</pre></li><li class="listitem"><p class="simpara">
						Generate a report:
					</p><pre class="screen"># hammer report-template generate --id <span class="emphasis"><em>template ID</em></span></pre><p class="simpara">
						This command waits until the report fully generates before completing. If you want to generate the report as a background task, you can use the <code class="literal">hammer report-template schedule</code> command.
					</p></li></ol></div></section><section class="section" id="proc_creating_a_report_template"><div class="titlepage"><div><div><h2 class="title">7.2. Creating a Report Template</h2></div></div></div><p>
				In Satellite, you can create a report template and customize the template to suit your requirements. You can import existing report templates and further customize them with snippets and template macros.
			</p><p>
				Report templates use Embedded Ruby (ERB) syntax. To view information about working with ERB syntax and macros, in the Satellite web UI, navigate to <span class="strong strong"><strong>Monitor</strong></span> &gt; <span class="strong strong"><strong>Report Templates</strong></span>, and click <span class="strong strong"><strong>Create Template</strong></span>, and then click the <span class="strong strong"><strong>Help</strong></span> tab.
			</p><p>
				When you create a report template in Satellite, safe mode is enabled by default. For more information about safe mode, see <a class="xref" href="#con_report_templates_safe_mode" title="7.8. Report Template Safe Mode">Section 7.8, “Report Template Safe Mode”</a>.
			</p><p>
				For more information about writing templates, see the <a class="xref" href="#appe-Red_Hat_Satellite-Managing_Hosts-Template_Writing_Reference" title="Appendix A. Template Writing Reference">Appendix A, <em>Template Writing Reference</em></a>.
			</p><p>
				To view a step by step example of populating a template, see <a class="xref" href="#proc_creating_a_report_table_to_monitor_entitlements" title="7.7. Creating a Report Template to Monitor Entitlements">Section 7.7, “Creating a Report Template to Monitor Entitlements”</a>.
			</p><p>
				For more information about macros you can use in report templates, see <a class="xref" href="#ref_template_macros" title="A.4. Templates Macros">Section A.4, “Templates Macros”</a>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Monitor</strong></span> &gt; <span class="strong strong"><strong>Report Templates</strong></span>, and click <span class="strong strong"><strong>Create Template</strong></span>.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Name</strong></span> field, enter a unique name for your report template.
					</li><li class="listitem">
						If you want the template to be available to all locations and organizations, select <span class="strong strong"><strong>Default</strong></span>.
					</li><li class="listitem">
						Create the template directly in the template editor or import a template from a text file by clicking <span class="strong strong"><strong>Import</strong></span>. For more information about importing templates, see <a class="xref" href="#importing_report_templates" title="7.5. Importing Report Templates">Section 7.5, “Importing Report Templates”</a>.
					</li><li class="listitem">
						Optional: In the <span class="strong strong"><strong>Audit Comment</strong></span> field, you can add any useful information about this template.
					</li><li class="listitem">
						Click the <span class="strong strong"><strong>Input</strong></span> tab, and in the <span class="strong strong"><strong>Name</strong></span> field, enter a name for the input that you can reference in the template in the following format: <code class="literal">input('name')</code>. Note that you must save the template before you can reference this input value in the template body.
					</li><li class="listitem">
						Select whether the input value is mandatory. If the input value is mandatory, select the <span class="strong strong"><strong>Required</strong></span> check box.
					</li><li class="listitem">
						From the <span class="strong strong"><strong>Value Type</strong></span> list, select the type of input value that the user must input.
					</li><li class="listitem">
						Optional: If you want to use facts for template input, select the <span class="strong strong"><strong>Advanced</strong></span> check box.
					</li><li class="listitem">
						Optional: In the <span class="strong strong"><strong>Options</strong></span> field, define the options that the user can select from. If this field remains undefined, the users receive a free-text field in which they can enter the value they want.
					</li><li class="listitem">
						Optional: In the <span class="strong strong"><strong>Default</strong></span> field, enter a value, for example, a host name, that you want to set as the default template input.
					</li><li class="listitem">
						Optional: In the <span class="strong strong"><strong>Description</strong></span> field, you can enter information that you want to display as inline help about the input when you generate the report.
					</li><li class="listitem">
						Optional: Click the <span class="strong strong"><strong>Type</strong></span> tab, and select whether this template is a snippet to be included in other templates,
					</li><li class="listitem">
						Click the <span class="strong strong"><strong>Location</strong></span> tab and add the locations where you want to use the template.
					</li><li class="listitem">
						Click the <span class="strong strong"><strong>Organizations</strong></span> tab and add the organizations where you want to use the template.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span> to save your changes.
					</li></ol></div></section><section class="section" id="exporting_report_templates"><div class="titlepage"><div><div><h2 class="title">7.3. Exporting Report Templates</h2></div></div></div><p>
				You can export report templates that you create in Satellite.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Monitor</strong></span> &gt; <span class="strong strong"><strong>Report Templates</strong></span>.
					</li><li class="listitem">
						Locate the template that you want to export, and from the list in the <span class="strong strong"><strong>Actions</strong></span> column, select <span class="strong strong"><strong>Export</strong></span>.
					</li><li class="listitem">
						Repeat this action for every report template that you want to download.
					</li></ol></div><p>
				An <code class="literal">.erb</code> file that contains the template downloads.
			</p><div class="orderedlist"><p class="title"><strong>For CLI Users</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To view the report templates available for export, enter the following command:
					</p><pre class="screen"># hammer report-template list</pre><p class="simpara">
						Note the template ID of the template that you want to export in the output of this command.
					</p></li><li class="listitem"><p class="simpara">
						To export a report template, enter the following command:
					</p><pre class="screen"># hammer report-template dump --id <span class="emphasis"><em>template_ID</em></span> &gt; <span class="emphasis"><em>example_export</em></span>.erb</pre></li></ol></div></section><section class="section" id="proc_exporting_report_templates_api"><div class="titlepage"><div><div><h2 class="title">7.4. Exporting Report Templates Using the Satellite API</h2></div></div></div><p>
				You can use the Satellite <code class="literal">report_templates</code> API to export report templates from Satellite. For more information about using the Satellite API, see the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/api_guide/index">API Guide</a>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Use the following request to retrieve a list of available report templates:
					</p><div class="formalpara"><p class="title"><strong>Example request:</strong></p><p>
							
<pre class="screen">$ curl --insecure --user admin:redhat \
--request GET \
--config https://<span class="emphasis"><em>satellite.example.com</em></span>/api/report_templates \
| json_reformat</pre>
						</p></div><p class="simpara">
						In this example, the <code class="literal">json_reformat</code> tool is used to format the JSON output.
					</p><div class="formalpara"><p class="title"><strong>Example response:</strong></p><p>
							
<pre class="screen">{
    "total": 6,
    "subtotal": 6,
    "page": 1,
    "per_page": 20,
    "search": null,
    "sort": {
        "by": null,
        "order": null
    },
    "results": [
        {
            "created_at": "2019-11-20 17:49:52 UTC",
            "updated_at": "2019-11-20 17:49:52 UTC",
            "name": "Applicable errata",
            "id": 112
        },
        {
            "created_at": "2019-11-20 17:49:52 UTC",
            "updated_at": "2019-11-20 17:49:52 UTC",
            "name": "Applied Errata",
            "id": 113
        },
        {
            "created_at": "2019-11-30 16:15:24 UTC",
            "updated_at": "2019-11-30 16:15:24 UTC",
            "name": "Hosts - complete list",
            "id": 158
        },
        {
            "created_at": "2019-11-20 17:49:52 UTC",
            "updated_at": "2019-11-20 17:49:52 UTC",
            "name": "Host statuses",
            "id": 114
        },
        {
            "created_at": "2019-11-20 17:49:52 UTC",
            "updated_at": "2019-11-20 17:49:52 UTC",
            "name": "Registered hosts",
            "id": 115
        },
        {
            "created_at": "2019-11-20 17:49:52 UTC",
            "updated_at": "2019-11-20 17:49:52 UTC",
            "name": "Subscriptions",
            "id": 116
        }
    ]
}</pre>
						</p></div></li><li class="listitem"><p class="simpara">
						Note the <code class="literal">id</code> of the template that you want to export, and use the following request to export the template:
					</p><div class="formalpara"><p class="title"><strong>Example request:</strong></p><p>
							
<pre class="screen">$ curl --insecure --output <span class="emphasis"><em>/tmp/_Example_Export_Template</em></span>.erb_ \
--user <span class="emphasis"><em>admin:password</em></span> --request GET --config \
https://<span class="emphasis"><em>satellite.example.com</em></span>/api/report_templates/<span class="emphasis"><em>158</em></span>/export</pre>
						</p></div><p class="simpara">
						Note that <code class="literal">158</code> is an example ID of the template to export.
					</p><p class="simpara">
						In this example, the exported template is redirected to <code class="literal">host_complete_list.erb</code>.
					</p></li></ol></div></section><section class="section" id="importing_report_templates"><div class="titlepage"><div><div><h2 class="title">7.5. Importing Report Templates</h2></div></div></div><p>
				You can import a report template into the body of a new template that you want to create. Note that using the web UI, you can only import templates individually. For bulk actions, use the Satellite API. For more information, see <a class="xref" href="#proc_importing_report_templates_api" title="7.6. Importing Report Templates Using the Satellite API">Section 7.6, “Importing Report Templates Using the Satellite API”</a>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisite</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You must have exported templates from Satellite to import them to use in new templates. For more information see <a class="xref" href="#exporting_report_templates" title="7.3. Exporting Report Templates">Section 7.3, “Exporting Report Templates”</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Monitor</strong></span> &gt; <span class="strong strong"><strong>Report Templates</strong></span>, and in the upper right of the Report Templates window, click <span class="strong strong"><strong>Create Template</strong></span>.
					</li><li class="listitem">
						On the upper right of the <span class="strong strong"><strong>Editor</strong></span> tab, click the folder icon, and select the <code class="literal">.erb</code> file that you want to import.
					</li><li class="listitem">
						Edit the template to suit your requirements, and click <span class="strong strong"><strong>Submit</strong></span>.
					</li></ol></div><p>
				For more information about customizing your new template, see <a class="xref" href="#appe-Red_Hat_Satellite-Managing_Hosts-Template_Writing_Reference" title="Appendix A. Template Writing Reference">Appendix A, <em>Template Writing Reference</em></a>.
			</p></section><section class="section" id="proc_importing_report_templates_api"><div class="titlepage"><div><div><h2 class="title">7.6. Importing Report Templates Using the Satellite API</h2></div></div></div><p>
				You can use the Satellite API to import report templates into Satellite. Importing report templates using the Satellite API automatically parses the report template metadata and assigns organizations and locations. For more information about using the Satellite API, see the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/api_guide/index">API Guide</a>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisite</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Create a template using <code class="literal">.erb</code> syntax or export a template from another Satellite.
					</p><p class="simpara">
						For more information about writing templates, see <a class="xref" href="#appe-Red_Hat_Satellite-Managing_Hosts-Template_Writing_Reference" title="Appendix A. Template Writing Reference">Appendix A, <em>Template Writing Reference</em></a>.
					</p><p class="simpara">
						For more information about exporting templates from Satellite, see <a class="xref" href="#proc_exporting_report_templates_api" title="7.4. Exporting Report Templates Using the Satellite API">Section 7.4, “Exporting Report Templates Using the Satellite API”</a>.
					</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Use the following example to format the template that you want to import to a <code class="literal">.json</code> file:
					</p><pre class="screen"># cat <span class="emphasis"><em>Example_Template</em></span>.json
{
    "name": "<span class="emphasis"><em>Example Template Name</em></span>",
    "template": "
    <span class="emphasis"><em>Enter ERB Code Here</em></span>
"
}</pre><div class="formalpara"><p class="title"><strong>Example JSON File with ERB Template:</strong></p><p>
							
<pre class="screen">{
    "name": "Hosts - complete list",
    "template": "
&lt;%#
name: Hosts - complete list
snippet: false
template_inputs:
- name: host
  required: false
  input_type: user
  advanced: false
  value_type: plain
  resource_type: Katello::ActivationKey
model: ReportTemplate
-%&gt;
&lt;% load_hosts(search: input('host')).each_record do |host| -%&gt;
&lt;%
      report_row(
          'Server FQND': host.name
      )
-%&gt;
&lt;%  end -%&gt;
&lt;%= report_render %&gt;
"
}</pre>
						</p></div></li><li class="listitem"><p class="simpara">
						Use the following request to import the template:
					</p><pre class="screen">$ curl --insecure --user admin:redhat \
--data @<span class="emphasis"><em>Example_Template</em></span>.json --header "Content-Type:application/json" \
--request POST --config https://<span class="emphasis"><em>satellite.example.com</em></span>/api/report_templates/import</pre></li><li class="listitem"><p class="simpara">
						Use the following request to retrieve a list of report templates and validate that you can view the template in Satellite:
					</p><pre class="screen">$ curl --insecure --user admin:redhat \
 --request GET --config https://<span class="emphasis"><em>satellite.example.com</em></span>/api/report_templates | json_reformat</pre></li></ol></div></section><section class="section" id="proc_creating_a_report_table_to_monitor_entitlements"><div class="titlepage"><div><div><h2 class="title">7.7. Creating a Report Template to Monitor Entitlements</h2></div></div></div><p>
				You can use a report template to return a list of hosts with a certain subscription and to display the number of cores for those hosts.
			</p><p>
				For more information about writing templates, see <a class="xref" href="#appe-Red_Hat_Satellite-Managing_Hosts-Template_Writing_Reference" title="Appendix A. Template Writing Reference">Appendix A, <em>Template Writing Reference</em></a>.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Monitor</strong></span> &gt; <span class="strong strong"><strong>Report Templates</strong></span>, and click <span class="strong strong"><strong>Create Template</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Optional: In the <span class="strong strong"><strong>Editor</strong></span> field, use the <code class="literal">&lt;%# &gt;</code> tags to add a comment with information that might be useful for later reference. For example:
					</p><pre class="screen">&lt;%#
name: Entitlements
snippet: false
model: ReportTemplate
require:
- plugin: katello
  version: 3.14.0
-%&gt;</pre></li><li class="listitem"><p class="simpara">
						Add a line with the <code class="literal">load_hosts()</code> macro and populate the macro with the following method and variables:
					</p><pre class="screen">&lt;%- load_hosts(includes: [:lifecycle_environment, :operatingsystem, :architecture, :content_view, :organization, :reported_data, :subscription_facet, :pools =&gt; [:subscription]]).each_record do |host| -%&gt;</pre><p class="simpara">
						To view a list of variables you can use, click the <span class="strong strong"><strong>Help</strong></span> tab and in the <span class="strong strong"><strong>Safe mode methods and variables</strong></span> table, find the <span class="strong strong"><strong>Host::Managed</strong></span> row.
					</p></li><li class="listitem"><p class="simpara">
						Add a line with the <code class="literal">host.pools</code> variable with the <code class="literal">each</code> method, for example:
					</p><pre class="screen">&lt;%- host.pools.each do |pool| -%&gt;</pre></li><li class="listitem"><p class="simpara">
						Add a line with the <code class="literal">report_row()</code> method to create a report and add the variables that you want to target as part of the report:
					</p><pre class="screen">&lt;%-     report_row(
          'Name': host.name,
          'Organization': host.organization,
          'Lifecycle Environment': host.lifecycle_environment,
          'Content View': host.content_view,
          'Host Collections': host.host_collections,
          'Virtual': host.virtual,
          'Guest of Host': host.hypervisor_host,
          'OS': host.operatingsystem,
          'Arch': host.architecture,
          'Sockets': host.sockets,
          'RAM': host.ram,
          'Cores': host.cores,
          'SLA': host_sla(host),
          'Products': host_products(host),
          'Subscription Name': sub_name(pool),
          'Subscription Type': pool.type,
          'Subscription Quantity': pool.quantity,
          'Subscription SKU': sub_sku(pool),
          'Subscription Contract': pool.contract_number,
          'Subscription Account': pool.account_number,
          'Subscription Start': pool.start_date,
          'Subscription End': pool.end_date,
          'Subscription Guest': registered_through(host)
          ) -%&gt;</pre></li><li class="listitem"><p class="simpara">
						Add end statements to the template:
					</p><pre class="screen">&lt;%-   end -%&gt;
&lt;%- end -%&gt;</pre></li><li class="listitem"><p class="simpara">
						To generate a report, you must add the &lt;%= report_render -%&gt; macro:
					</p><pre class="screen">&lt;%= report_render -%&gt;</pre></li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span> to save the template.
					</li></ol></div></section><section class="section" id="con_report_templates_safe_mode"><div class="titlepage"><div><div><h2 class="title">7.8. Report Template Safe Mode</h2></div></div></div><p>
				When you create report templates in Satellite, safe mode is enabled by default. Safe mode limits the macros and variables that you can use in the report template. Safe mode prevents rendering problems and enforces best practices in report templates. The list of supported macros and variables is available in the Satellite web UI.
			</p><p>
				To view the macros and variables that are available, in the Satellite web UI, navigate to <span class="strong strong"><strong>Monitor</strong></span> &gt; <span class="strong strong"><strong>Report Templates</strong></span> and click <span class="strong strong"><strong>Create Template</strong></span>. In the Create Template window, click the <span class="strong strong"><strong>Help</strong></span> tab and expand <span class="strong strong"><strong>Safe mode methods</strong></span>.
			</p><p>
				While safe mode is enabled, if you try to use a macro or variable that is not listed in <span class="strong strong"><strong>Safe mode methods</strong></span>, the template editor displays an error message.
			</p><p>
				To view the status of safe mode in Satellite, in the Satellite web UI, navigate to <span class="strong strong"><strong>Administer</strong></span> &gt; <span class="strong strong"><strong>Settings</strong></span> and click the <span class="strong strong"><strong>Provisioning</strong></span> tab. Locate the <span class="strong strong"><strong>Safemode rendering</strong></span> row to check the value.
			</p></section></section><section class="chapter" id="chap-Red_Hat_Satellite-Managing_Hosts-Configuring_Host_Collections"><div class="titlepage"><div><div><h1 class="title">Chapter 8. Configuring Host Collections</h1></div></div></div><p>
			A host collection is a group of multiple content hosts. This feature enables you to perform the same action on multiple hosts at once. These actions can include the installation, removal, and update of packages and errata, change of assigned life cycle environment, and change of Content View. You can create host collections to suit your requirements, and those of your company. For example, group hosts in host collections by function, department, or business unit.
		</p><section class="section" id="sect-Red_Hat_Satellite-Managing_Hosts-Creating_a_Host_Collection"><div class="titlepage"><div><div><h2 class="title">8.1. Creating a Host Collection</h2></div></div></div><p>
				The following procedure shows how to create host collections.
			</p><div class="orderedlist" id="proc-Red_Hat_Satellite-Managing_Hosts-Creating_a_Host_Collection-To_Create_a_Host_Collection"><p class="title"><strong>To Create a Host Collection:</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Click <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Host Collections</strong></span>.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>New Host Collection</strong></span>.
					</li><li class="listitem">
						Add the Name of the host collection.
					</li><li class="listitem">
						Clear <span class="strong strong"><strong>Unlimited Content Hosts</strong></span>, and enter the desired maximum number of hosts in the <span class="strong strong"><strong>Limit</strong></span> field.
					</li><li class="listitem">
						Add the Description of the host collection.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Save</strong></span>.
					</li></ol></div><div class="formalpara"><p class="title"><strong>For CLI Users</strong></p><p>
					To create a host collection, enter the following command:
				</p></div><pre class="screen"># hammer host-collection create \
--organization "<span class="emphasis"><em>Your_Organization</em></span>" \
--name <span class="emphasis"><em>hc_name</em></span></pre></section><section class="section" id="sect-Red_Hat_Satellite-Managing_Hosts-Cloning_a_Host_Collection"><div class="titlepage"><div><div><h2 class="title">8.2. Cloning a Host Collection</h2></div></div></div><p>
				The following procedure shows how to clone a host collection.
			</p><div class="orderedlist" id="proc-Red_Hat_Satellite-Managing_Hosts-Cloning_a_Host_Collection-To_Clone_a_Host_Collection"><p class="title"><strong>To Clone a Host Collection:</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Click <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Host Collections</strong></span>.
					</li><li class="listitem">
						On the left hand panel, click the host collection you want to clone.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Copy Collection</strong></span>.
					</li><li class="listitem">
						Specify a name for the cloned collection.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Create</strong></span>.
					</li></ol></div></section><section class="section" id="sect-Red_Hat_Satellite-Managing_Hosts-Removing_a_Host_Collection"><div class="titlepage"><div><div><h2 class="title">8.3. Removing a Host Collection</h2></div></div></div><p>
				The following procedure shows how to remove a host collection.
			</p><div class="orderedlist" id="proc-Red_Hat_Satellite-Managing_Hosts-Removing_a_Host_Collection-To_Remove_a_Host_Collection"><p class="title"><strong>To Remove a Host Collection:</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Click <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Host Collections</strong></span>.
					</li><li class="listitem">
						Choose the host collection to be removed.
					</li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Remove</strong></span>. An alert box appears:
					</p><pre class="screen">Are you sure you want to remove host collection <span class="emphasis"><em>Host Collection Name</em></span>?</pre></li><li class="listitem">
						Click <span class="strong strong"><strong>Remove</strong></span>.
					</li></ol></div></section><section class="section" id="sect-Red_Hat_Satellite-Managing_Hosts-Adding_a_Host_to_a_Host_Collection"><div class="titlepage"><div><div><h2 class="title">8.4. Adding a Host to a Host Collection</h2></div></div></div><p>
				The following procedure shows how to add hosts to host collections.
			</p><p id="form-Red_Hat_Satellite-Managing_Hosts-Adding_Hosts_to_a_Host_Collection-Task_Prerequisites">
				<span class="strong strong"><strong>Prerequisites</strong></span>
			</p><p>
				A host must be registered to Red Hat Satellite in order to add it to a Host Collection. For more information about registering hosts, <a class="xref" href="#Registering_Hosts" title="Chapter 3. Registering Hosts">Chapter 3, <em>Registering Hosts</em></a>.
			</p><div class="orderedlist" id="proc-Red_Hat_Satellite-Managing_Hosts-Adding_Hosts_to_a_Host_Collection-To_Add_Hosts_to_a_Host_Collection"><p class="title"><strong>To Add Hosts to a Host Collection:</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Click <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Host Collections</strong></span>.
					</li><li class="listitem">
						Click the host collection where the host should be added.
					</li><li class="listitem">
						On the <span class="strong strong"><strong>Hosts</strong></span> tab, select the <span class="strong strong"><strong>Add</strong></span> subtab.
					</li><li class="listitem">
						Select the hosts to be added from the table and click <span class="strong strong"><strong>Add Selected</strong></span>.
					</li></ol></div><div class="formalpara"><p class="title"><strong>For CLI Users</strong></p><p>
					To add hosts to a host collection, enter the following command:
				</p></div><pre class="screen"># hammer host-collection add-host \
--id <span class="emphasis"><em>hc_ID</em></span> \
--host-ids <span class="emphasis"><em>host_ID1</em></span>,<span class="emphasis"><em>host_ID2</em></span>...</pre></section><section class="section" id="sect-Red_Hat_Satellite-Managing_Hosts-Removing_a_Host_from_a_Host_Collection"><div class="titlepage"><div><div><h2 class="title">8.5. Removing a Host from a Host Collection</h2></div></div></div><p>
				The following procedure shows how to remove hosts from host collections.
			</p><div class="orderedlist" id="proc-Red_Hat_Satellite-Managing_Hosts-Removing_a_Host_from_a_Host_Collection-To_Remove_Hosts_from_a_Host_Collection"><p class="title"><strong>To Remove Hosts from a Host Collection:</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Click <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Host Collections</strong></span>.
					</li><li class="listitem">
						Choose the desired host collection.
					</li><li class="listitem">
						On the <span class="strong strong"><strong>Hosts</strong></span> tab, select the <span class="strong strong"><strong>List/Remove</strong></span> subtab.
					</li><li class="listitem">
						Select the hosts you want to remove from the host collection and click <span class="strong strong"><strong>Remove Selected</strong></span>.
					</li></ol></div></section><section class="section" id="sect-Red_Hat_Satellite-Managing_Hosts-Configuring_Host_Collections-Adding_Content_to_a_Host_Collection"><div class="titlepage"><div><div><h2 class="title">8.6. Adding Content to a Host Collection</h2></div></div></div><p>
				These steps show how to add content to host collections in Red Hat Satellite.
			</p><section class="section" id="sect-Red_Hat_Satellite-Managing_Hosts-Adding_Packages_to_a_Host_Collection"><div class="titlepage"><div><div><h3 class="title">8.6.1. Adding Packages to a Host Collection</h3></div></div></div><p>
					The following procedure shows how to add packages to host collections.
				</p><p id="form-Red_Hat_Satellite-Managing_Hosts-Adding_Packages_to_a_Host_Collection-Task_Prerequisites">
					<span class="strong strong"><strong>Prerequisites</strong></span>
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The content to be added should be available in one of the existing repositories or added prior to this procedure.
						</li><li class="listitem">
							Content should be promoted to the environment where the hosts are assigned.
						</li></ul></div><div class="orderedlist" id="proc-Red_Hat_Satellite-Managing_Hosts-Adding_Packages_to_a_Host_Collection-To_Add_Packages_to_Host_Collections"><p class="title"><strong>To Add Packages to Host Collections:</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Click <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Host Collections</strong></span>.
						</li><li class="listitem">
							Click the host collection where the package should be added.
						</li><li class="listitem">
							On the <span class="strong strong"><strong>Collection Actions</strong></span> tab, click <span class="strong strong"><strong>Package Installation, Removal, and Update</strong></span>.
						</li><li class="listitem">
							To update all packages, click the <span class="strong strong"><strong>Update All Packages</strong></span> button to use the default method. Alternatively, select the drop-down icon to the right of the button to select a method to use. Selecting the <span class="strong strong"><strong>via remote execution - customize first</strong></span> menu entry will take you to the <span class="strong strong"><strong>Job invocation</strong></span> page where you can customize the action.
						</li><li class="listitem">
							Select the <span class="strong strong"><strong>Package</strong></span> or <span class="strong strong"><strong>Package Group</strong></span> radio button as required.
						</li><li class="listitem"><p class="simpara">
							In the field provided, specify the package or package group name. Then click:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Install</strong></span> — to install a new package using the default method. Alternatively, select the drop-down icon to the right of the button and select a method to use. Selecting the <span class="strong strong"><strong>via remote execution - customize first</strong></span> menu entry will take you to the <span class="strong strong"><strong>Job invocation</strong></span> page where you can customize the action.
								</li><li class="listitem">
									<span class="strong strong"><strong>Update</strong></span> — to update an existing package in the host collection using the default method. Alternatively, select the drop-down icon to the right of the button and select a method to use. Selecting the <span class="strong strong"><strong>via remote execution - customize first</strong></span> menu entry will take you to the <span class="strong strong"><strong>Job invocation</strong></span> page where you can customize the action.
								</li></ul></div></li></ol></div></section><section class="section" id="sect-Red_Hat_Satellite-Managing_Hosts-Adding_Errata_to_a_Host_Collection"><div class="titlepage"><div><div><h3 class="title">8.6.2. Adding Errata to a Host Collection</h3></div></div></div><p>
					The following procedure shows how to add errata to host collections.
				</p><p id="form-Red_Hat_Satellite-Managing_Hosts-Adding_Errata_to_a_Host_Collection-Prerequisites">
					<span class="strong strong"><strong>Prerequisites</strong></span>
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The errata to be added should be available in one of the existing repositories or added prior to this procedure.
						</li><li class="listitem">
							Errata should be promoted to the environment where the hosts are assigned.
						</li></ul></div><div class="orderedlist" id="proc-Red_Hat_Satellite-Managing_Hosts-Adding_Errata_to_a_Host_Collection-To_Add_Errata_to_a_Host_Collection"><p class="title"><strong>To Add Errata to a Host Collection:</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Click <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Host Collections</strong></span>.
						</li><li class="listitem">
							Select the host collection where the errata should be added.
						</li><li class="listitem">
							On the <span class="strong strong"><strong>Collection Actions</strong></span> tab, click <span class="strong strong"><strong>Errata Installation</strong></span>.
						</li><li class="listitem">
							Select the errata you want to add to the host collection and click the <span class="strong strong"><strong>Install Selected</strong></span> button to use the default method. Alternatively, select the drop-down icon to the right of the button to select a method to use. Selecting the <span class="strong strong"><strong>via remote execution - customize first</strong></span> menu entry will take you to the <span class="strong strong"><strong>Job invocation</strong></span> page where you can customize the action.
						</li></ol></div></section></section><section class="section" id="sect-Red_Hat_Satellite-Managing_Hosts-Removing_Content_from_a_Host_Collection"><div class="titlepage"><div><div><h2 class="title">8.7. Removing Content from a Host Collection</h2></div></div></div><p>
				The following procedure shows how to remove packages from host collections.
			</p><div class="orderedlist" id="proc-Red_Hat_Satellite-Managing_Hosts-Removing_Content_from_a_Host_Collection-To_Remove_Content_from_a_Host_Collection"><p class="title"><strong>To Remove Content from a Host Collection:</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Click <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Host Collections</strong></span>.
					</li><li class="listitem">
						Click the host collection where the package should be removed.
					</li><li class="listitem">
						On the <span class="strong strong"><strong>Collection Actions</strong></span> tab, click <span class="strong strong"><strong>Package Installation, Removal, and Update</strong></span>.
					</li><li class="listitem">
						Select the <span class="strong strong"><strong>Package</strong></span> or <span class="strong strong"><strong>Package Group</strong></span> radio button as required.
					</li><li class="listitem">
						In the field provided, specify the package or package group name.
					</li><li class="listitem">
						Click the <span class="strong strong"><strong>Remove</strong></span> button to remove the package or package group using the default method. Alternatively, select the drop-down icon to the right of the button and select a method to use. Selecting the <span class="strong strong"><strong>via remote execution - customize first</strong></span> menu entry will take you to the <span class="strong strong"><strong>Job invocation</strong></span> page where you can customize the action.
					</li></ol></div></section><section class="section" id="sect-Red_Hat_Satellite-Managing_Hosts-Changing_the_Life_Cycle_Environment_or_Content_View_of_a_Host_Collection"><div class="titlepage"><div><div><h2 class="title">8.8. Changing the Life Cycle Environment or Content View of a Host Collection</h2></div></div></div><p>
				The following procedure shows how to change the assigned life cycle environment or Content View of host collections.
			</p><div class="orderedlist" id="proc-Red_Hat_Satellite-Managing_Hosts-Changing_the_Life_Cycle_Environment_or_Content_View_of_a_Host_Collection-To_Change_the_Life_Cycle_Environment_or_Content_View_of_a_Host_Collection"><p class="title"><strong>To Change the Life Cycle Environment or Content View of a Host Collection:</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Click <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Host Collection</strong></span>.
					</li><li class="listitem">
						Selection the host collection where the life cycle environment or Content View should be changed.
					</li><li class="listitem">
						On the <span class="strong strong"><strong>Collection Actions</strong></span> tab, click <span class="strong strong"><strong>Change assigned Life Cycle Environment or Content View</strong></span>.
					</li><li class="listitem">
						Select the life cycle environment to be assigned to the host collection.
					</li><li class="listitem">
						Select the required Content View from the list.
					</li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Assign</strong></span>.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The changes take effect in approximately 4 hours. To make the changes take effect immediately, on the host, enter the following command:
						</p><pre class="screen"># subscription-manager refresh</pre><p>
							You can use remote execution to run this command on multiple hosts at the same time.
						</p></div></div></li></ol></div></section></section><section class="chapter" id="Using_Ansible_Roles"><div class="titlepage"><div><div><h1 class="title">Chapter 9. Using Ansible Roles</h1></div></div></div><section class="section" id="assigning-ansible-roles-to-an-existing-host"><div class="titlepage"><div><div><h2 class="title">9.1. Assigning Ansible Roles to an Existing Host</h2></div></div></div><p>
				You can use Ansible roles for remote management of Red Hat Enterprise Linux versions 8, 7, and 6.9 or later.
			</p><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
					You must import the roles to Satellite before you can assign them to a host. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/administering_red_hat_satellite/chap-red_hat_satellite-administering_red_hat_satellite-managing_ansible_roles#sect-Red_Hat_Satellite-Administering_Red_Hat_Satellite-Adding_RHEL_System_Roles">Adding Red Hat Enterprise Linux System Roles</a> in <span class="emphasis"><em>Administering Red Hat Satellite</em></span>.
				</p></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All Hosts</strong></span>.
					</li><li class="listitem">
						On the host you want to assign an Ansible role to, click <span class="strong strong"><strong>Edit</strong></span>.
					</li><li class="listitem">
						Select the <span class="strong strong"><strong>Ansible Roles</strong></span> tab, and in the <span class="strong strong"><strong>All items</strong></span> list, search for the roles that you want to add.
					</li><li class="listitem">
						Select the roles that you want to add, and click the arrow icon to move the roles to the <span class="strong strong"><strong>Selected items</strong></span> list.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span>.
					</li></ol></div><p>
				After you assign Ansible roles to hosts, you can use Ansible for remote execution. For more information, see <a class="xref" href="#sect-Managing_Hosts-Establishing_a_Secure_Connection_for_Remote_Commands" title="10.3. Distributing SSH Keys for Remote Execution">Section 10.3, “Distributing SSH Keys for Remote Execution”</a>.
			</p><div class="formalpara"><p class="title"><strong>Overiding Parameter Variables</strong></p><p>
					On the <span class="strong strong"><strong>Parameters</strong></span> tab, click <span class="strong strong"><strong>Add Parameter</strong></span> to add any parameter variables that you want to pass to job templates at run time. This includes all Ansible playbook parameters and host parameters that you want to associate with the host. To use a parameter variable with an Ansible job template, you must add a <span class="strong strong"><strong>Host Parameter</strong></span>.
				</p></div></section><section class="section" id="running-ansible-roles-on-a-host"><div class="titlepage"><div><div><h2 class="title">9.2. Running Ansible Roles on a Host</h2></div></div></div><p>
				You can run Ansible roles on a host through the Satellite web UI.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You must have imported the Ansible roles to Satellite.
					</li><li class="listitem">
						You must have assigned the Ansible roles to the host.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All Hosts</strong></span>.
					</li><li class="listitem">
						Select the check box of the host that contains the Ansible role you want to run.
					</li><li class="listitem">
						From the <span class="strong strong"><strong>Select Action</strong></span> list, select <span class="strong strong"><strong>Play Ansible roles</strong></span>.
					</li></ol></div><p>
				You can view the status of your Ansible job on the <span class="strong strong"><strong>Run Ansible roles</strong></span> page. To rerun a job, click the <span class="strong strong"><strong>Rerun</strong></span> button.
			</p></section><section class="section" id="assigning-an-ansible-role-to-a-host-group"><div class="titlepage"><div><div><h2 class="title">9.3. Assigning an Ansible Role to a Host Group</h2></div></div></div><p>
				You can use Ansible roles for remote management of Red Hat Enterprise Linux versions 8, 7, and 6.9 or later.
			</p><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
					You must import the roles to Satellite before you can assign them to a host group. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/administering_red_hat_satellite/chap-red_hat_satellite-administering_red_hat_satellite-managing_ansible_roles#sect-Red_Hat_Satellite-Administering_Red_Hat_Satellite-Adding_RHEL_System_Roles">Adding Red Hat Enterprise Linux System Roles</a> in <span class="emphasis"><em>Administering Red Hat Satellite</em></span>.
				</p></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Configure</strong></span> &gt; <span class="strong strong"><strong>Host Groups</strong></span>.
					</li><li class="listitem">
						From the list of host groups, click the host group name that you want to add an Ansible Role to.
					</li><li class="listitem">
						Select the <span class="strong strong"><strong>Ansible Roles</strong></span> tab, and in the <span class="strong strong"><strong>All items</strong></span> list, search for the roles that you want to add.
					</li><li class="listitem">
						Select the roles that you want to add, and click the arrow icon to move the roles to the <span class="strong strong"><strong>Selected items</strong></span> list.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span>.
					</li></ol></div></section><section class="section" id="running-ansible-roles-on-a-host-group"><div class="titlepage"><div><div><h2 class="title">9.4. Running Ansible Roles on a Host Group</h2></div></div></div><p>
				You can run Ansible roles on a host group through the Satellite web UI.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You must have imported the Ansible roles to Satellite.
					</li><li class="listitem">
						You must have assigned the Ansible roles to the host group.
					</li><li class="listitem">
						You must have at least one host in your host group.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the Satellite web UI, navigate to <span class="strong strong"><strong>Configure</strong></span> &gt; <span class="strong strong"><strong>Host Groups</strong></span>.
					</li><li class="listitem">
						From the list in the <span class="strong strong"><strong>Actions</strong></span> column for the host group, select <span class="strong strong"><strong>Run all Ansible roles</strong></span>.
					</li></ol></div><p>
				You can view the status of your Ansible job on the <span class="strong strong"><strong>Run Ansible roles</strong></span> page. To rerun a job, click the <span class="strong strong"><strong>Rerun</strong></span> button.
			</p></section></section><section class="chapter" id="Running_Jobs_on_Hosts"><div class="titlepage"><div><div><h1 class="title">Chapter 10. Running Jobs on Hosts</h1></div></div></div><p>
			You can run jobs on hosts remotely from Capsules using shell scripts or Ansible tasks and playbooks. This is referred to as remote execution.
		</p><p>
			For custom Ansible roles that you create, or roles that you download, you must install the package containing the roles on the Capsule base operating system. Before you can use Ansible roles, you must import the roles into Satellite from the Capsule where they are installed.
		</p><p>
			Communication occurs through Capsule Server, which means that Satellite Server does not require direct access to the target host, and can scale to manage many hosts. Remote execution uses the SSH service that must be enabled and running on the target host. Ensure that the remote execution Capsule has access to port 22 on the target hosts.
		</p><p>
			Satellite uses ERB syntax job templates. For more information, see <a class="xref" href="#appe-Red_Hat_Satellite-Managing_Hosts-Template_Writing_Reference" title="Appendix A. Template Writing Reference">Appendix A, <em>Template Writing Reference</em></a>.
		</p><p>
			Several job templates for shell scripts and Ansible are included by default. For more information, see <a class="xref" href="#sect-Managing_Hosts-Setting_up_Job_Templates" title="10.6.1. Setting up Job Templates">Section 10.6.1, “Setting up Job Templates”</a>.
		</p><p>
			By default, Satellite Server is configured to use the Katello Agent rather than remote execution. To change this setting, navigate to <span class="strong strong"><strong>Administer</strong></span> &gt; <span class="strong strong"><strong>Settings</strong></span>, click <span class="strong strong"><strong>Content</strong></span>, and change the <span class="strong strong"><strong>Use remote execution by default</strong></span> setting.
		</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				Any Capsule Server base operating system is a client of Satellite Server’s internal Capsule, and therefore this section applies to any type of host connected to Satellite Server, including Capsule Servers.
			</p></div></div><p>
			You can run jobs on multiple hosts at once, and you can use variables in your commands for more granular control over the jobs you run. You can use host facts, smart class parameters, smart variables, and host parameters to populate variable values. For more information about Ansible variables, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.6/html/administering_red_hat_satellite/chap-red_hat_satellite-administering_red_hat_satellite-managing_ansible_roles#sect-Red_Hat_Satellite-Administering_Red_Hat_Satellite-Managing_Ansible_Variables_with_Satellite">Overriding Ansible Variables in Satellite</a>. In addition, you can specify custom values for templates when you run the command. For more information, see <a class="xref" href="#sect-Managing_Hosts-Executing_Remote_Jobs" title="10.6.2. Executing Jobs">Section 10.6.2, “Executing Jobs”</a>.
		</p><section class="section" id="sect-Managing_Hosts-Choosing_a_Satellite_Capsule_for_Remote_Execution"><div class="titlepage"><div><div><h2 class="title">10.1. How Satellite Selects Capsule for Remote Execution</h2></div></div></div><p>
				When you run a remote job on hosts, for every host, Satellite performs the following actions to find a remote execution Capsule to use. Satellite searches only for Capsules that have the remote execution feature enabled.
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Satellite finds the host’s interfaces that have the <span class="strong strong"><strong>Remote execution</strong></span> check box selected.
					</li><li class="listitem">
						Satellite finds the subnets of these interfaces.
					</li><li class="listitem">
						Satellite finds remote execution Capsules assigned to these subnets.
					</li><li class="listitem">
						From this set of Capsules, Satellite selects the Capsule that has the least number of running jobs. By doing this, Satellite ensures that the jobs load is balanced between remote execution Capsules.
					</li><li class="listitem"><p class="simpara">
						If Satellite does not find a remote execution Capsule at this stage, and if the <span class="strong strong"><strong>Fallback to Any Capsule</strong></span> setting is enabled, Satellite adds another set of Capsules to select the remote execution Capsule from. Satellite selects the most lightly loaded Capsule from the following types of Capsules that are assigned to the host:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								DHCP, DNS and TFTP Capsules assigned to the host’s subnets
							</li><li class="listitem">
								DNS Capsule assigned to the host’s domain
							</li><li class="listitem">
								Realm Capsule assigned to the host’s realm
							</li><li class="listitem">
								Puppet Master Capsule
							</li><li class="listitem">
								Puppet CA Capsule
							</li><li class="listitem">
								OpenSCAP Capsule
							</li></ul></div></li><li class="listitem">
						If Satellite does not find a remote execution Capsule at this stage, and if the <span class="strong strong"><strong>Enable Global Capsule</strong></span> setting is enabled, Satellite selects the most lightly loaded remote execution Capsule from the set of all Capsules in the host’s organization and location to execute a remote job.
					</li></ol></div><section class="section" id="configuring_the_fallback_to_any_capsule_remote_execution_setting_in_satellite"><div class="titlepage"><div><div><h3 class="title">10.1.1. Configuring the Fallback to Any Capsule Remote Execution Setting in Satellite</h3></div></div></div><p>
					You can enable the <span class="strong strong"><strong>Fallback to Any Capsule</strong></span> setting to configure Satellite to search for remote execution Capsules from the list of Capsules that are assigned to hosts. This can be useful if you need to run remote jobs on hosts that have no subnets configured or if the hosts' subnets are assigned to Capsules that do not have the remote execution feature enabled.
				</p><p>
					If the <span class="strong strong"><strong>Fallback to Any Capsule</strong></span> setting is enabled, Satellite adds another set of Capsules to select the remote execution Capsule from. Satellite also selects the most lightly loaded Capsule from the set of all Capsules assigned to the host, such as the following:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							DHCP, DNS and TFTP Capsules assigned to the host’s subnets
						</li><li class="listitem">
							DNS Capsule assigned to the host’s domain
						</li><li class="listitem">
							Realm Capsule assigned to the host’s realm
						</li><li class="listitem">
							Puppet Master Capsule
						</li><li class="listitem">
							Puppet CA Capsule
						</li><li class="listitem">
							OpenSCAP Capsule
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the Satellite web UI, navigate to <span class="strong strong"><strong>Administer</strong></span> &gt; <span class="strong strong"><strong>Settings</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>RemoteExecution</strong></span>.
						</li><li class="listitem">
							Configure the <span class="strong strong"><strong>Fallback to Any Capsule</strong></span> setting.
						</li></ol></div><div class="formalpara"><p class="title"><strong>For CLI Users</strong></p><p>
						Enter the <code class="literal">hammer settings set</code> command on Satellite to configure the <span class="strong strong"><strong>Fallback to Any Capsule</strong></span> setting. For example, to set the value to <code class="literal">true</code>, enter the following command:
					</p></div><pre class="screen"># hammer settings set --name=remote_execution_fallback_proxy --value=true</pre></section><section class="section" id="configuring_the_global_capsule_remote_execution_setting_in_satellite"><div class="titlepage"><div><div><h3 class="title">10.1.2. Configuring the Global Capsule Remote Execution Setting in Satellite</h3></div></div></div><p>
					By default, Satellite searches for remote execution Capsules in hosts' organizations and locations regardless of whether Capsules are assigned to hosts' subnets or not. You can disable the <span class="strong strong"><strong>Enable Global Capsule</strong></span> setting if you want to limit the search to the Capsules that are assigned to hosts' subnets.
				</p><p>
					If the <span class="strong strong"><strong>Enable Global Capsule</strong></span> setting is enabled, Satellite adds another set of Capsules to select the remote execution Capsule from. Satellite also selects the most lightly loaded remote execution Capsule from the set of all Capsules in the host’s organization and location to execute a remote job.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the Satellite web UI, navigate to <span class="strong strong"><strong>Administer</strong></span> &gt; <span class="strong strong"><strong>Settings</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>RemoteExection</strong></span>.
						</li><li class="listitem">
							Configure the <span class="strong strong"><strong>Enable Global Capsule</strong></span> setting.
						</li></ol></div><div class="formalpara"><p class="title"><strong>For CLI Users</strong></p><p>
						Enter the <code class="literal">hammer settings set</code> command on Satellite to configure the <code class="literal">Enable Global Capsule</code> setting. For example, to set the value to <code class="literal">true</code>, enter the following command:
					</p></div><pre class="screen"># hammer settings set --name=remote_execution_global_proxy --value=true</pre></section></section><section class="section" id="configuring_satellite_to_use_an_alternative_directory_to_execute_remote_jobs_on_clients"><div class="titlepage"><div><div><h2 class="title">10.2. Configuring Satellite to Use an Alternative Directory to Execute Remote Jobs on Clients</h2></div></div></div><p>
				By default, Satellite uses the <code class="literal">/var/tmp</code> directory on the client system to execute the remote execution jobs. If the client system has <code class="literal">noexec</code> set for the <code class="literal">/var/</code> volume or file system, you must configure Satellite to use an alternative directory because otherwise the remote execution job fails since the script cannot be run.
			</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					Optional: To use an alternative directory, complete this procedure.
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new directory, for example <span class="emphasis"><em>new_place</em></span>:
					</p><pre class="screen"># mkdir /<span class="emphasis"><em>remote_working_dir</em></span></pre></li><li class="listitem"><p class="simpara">
						Copy the SELinux context from the default <code class="literal">var</code> directory:
					</p><pre class="screen"># chcon --reference=/var <span class="emphasis"><em>/remote_working_dir</em></span></pre></li><li class="listitem"><p class="simpara">
						Edit the <code class="literal">remote_working_dir</code> setting in the <code class="literal">/etc/foreman-proxy/settings.d/remote_execution_ssh.yml</code> file to point to the required directory, for example:
					</p><pre class="screen">:remote_working_dir: <span class="emphasis"><em>/remote_working_dir</em></span></pre></li></ol></div></section><section class="section" id="sect-Managing_Hosts-Establishing_a_Secure_Connection_for_Remote_Commands"><div class="titlepage"><div><div><h2 class="title">10.3. Distributing SSH Keys for Remote Execution</h2></div></div></div><p>
				To use SSH keys for authenticating remote execution connections, you must distribute the public SSH key from Capsule to its attached hosts that you want to manage. Ensure that the SSH service is enabled and running on the hosts. Configure any network or host-based firewalls to enable access to port 22.
			</p><p>
				Use one of the following methods to distribute the public SSH key from Capsule to target hosts:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						<a class="xref" href="#sect-Managing_Hosts-Distributing_SSH_Keys_for_Remote_Execution_Manually" title="10.3.1. Distributing SSH Keys for Remote Execution Manually">Section 10.3.1, “Distributing SSH Keys for Remote Execution Manually”</a>.
					</li><li class="listitem">
						<a class="xref" href="#sect-Managing_Hosts-Using_API_to_Obtain_SSH_Keys_for_Remote_Execution" title="10.3.2. Using the Satellite API to Obtain SSH Keys for Remote Execution">Section 10.3.2, “Using the Satellite API to Obtain SSH Keys for Remote Execution”</a>.
					</li><li class="listitem">
						<a class="xref" href="#sect-Managing_Hosts-Configuring_a_Kickstart_Template_to_Distribute_SSH_Keys_during_Provisioning" title="10.3.3. Configuring a Kickstart Template to Distribute SSH Keys during Provisioning">Section 10.3.3, “Configuring a Kickstart Template to Distribute SSH Keys during Provisioning”</a>.
					</li></ol></div><p>
				Satellite distributes SSH keys for the remote execution feature to the hosts provisioned from Satellite by default.
			</p><section class="section" id="sect-Managing_Hosts-Distributing_SSH_Keys_for_Remote_Execution_Manually"><div class="titlepage"><div><div><h3 class="title">10.3.1. Distributing SSH Keys for Remote Execution Manually</h3></div></div></div><p>
					To distribute SSH keys manually, complete the following steps:
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Enter the following command on Capsule. Repeat for each target host you want to manage:
						</p><pre class="screen"># ssh-copy-id -i ~foreman-proxy/.ssh/id_rsa_foreman_proxy.pub <span class="emphasis"><em>root@target.example.com</em></span></pre></li><li class="listitem"><p class="simpara">
							To confirm that the key was successfully copied to the target host, enter the following command on Capsule:
						</p><pre class="screen"># ssh -i ~foreman-proxy/.ssh/id_rsa_foreman_proxy <span class="emphasis"><em>root@target.example.com</em></span></pre></li></ol></div></section><section class="section" id="sect-Managing_Hosts-Using_API_to_Obtain_SSH_Keys_for_Remote_Execution"><div class="titlepage"><div><div><h3 class="title">10.3.2. Using the Satellite API to Obtain SSH Keys for Remote Execution</h3></div></div></div><p>
					To use the Satellite API to download the public key from Capsule, complete this procedure on each target host.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							On the target host, create the <code class="literal"><sub>/.ssh</sub></code> directory to store the SSH key:
						</p><pre class="screen"># mkdir ~/.ssh</pre></li><li class="listitem"><p class="simpara">
							Download the SSH key from Capsule:
						</p><pre class="screen"># curl https://<span class="emphasis"><em>capsule.example.com</em></span>:9090/ssh/pubkey &gt;&gt; ~/.ssh/authorized_keys</pre></li><li class="listitem"><p class="simpara">
							Configure permissions for the <code class="literal">~/.ssh</code> directory:
						</p><pre class="screen"># chmod 700 ~/.ssh</pre></li><li class="listitem"><p class="simpara">
							Configure permissions for the <code class="literal">authorized_keys</code> file:
						</p><pre class="screen"># chmod 600 ~/.ssh/authorized_keys</pre></li></ol></div></section><section class="section" id="sect-Managing_Hosts-Configuring_a_Kickstart_Template_to_Distribute_SSH_Keys_during_Provisioning"><div class="titlepage"><div><div><h3 class="title">10.3.3. Configuring a Kickstart Template to Distribute SSH Keys during Provisioning</h3></div></div></div><p>
					You can add a <code class="literal">remote_execution_ssh_keys</code> snippet to your custom kickstart template to deploy SSH Keys to hosts during provisioning. Kickstart templates that Satellite ships include this snippet by default. Therefore, Satellite copies the SSH key for remote execution to the systems during provisioning.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To include the public key in newly-provisioned hosts, add the following snippet to the Kickstart template that you use:
						</p><pre class="screen">&lt;%= snippet 'remote_execution_ssh_keys' %&gt;</pre></li></ul></div></section></section><section class="section" id="configuring_a_keytab_for_kerberos_ticket_granting_tickets"><div class="titlepage"><div><div><h2 class="title">10.4. Configuring a keytab for Kerberos Ticket Granting Tickets</h2></div></div></div><p>
				Use this procedure to configure Satellite to use a keytab to obtain Kerberos ticket granting tickets. If you do not set up a keytab, you must manually retrieve tickets.
			</p><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					To ensure that the <code class="literal">foreman-proxy</code> user on Satellite can obtain Kerberos ticket granting tickets, complete the following steps:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Find the ID of the <code class="literal">foreman-proxy</code> user:
					</p><pre class="screen"># id -u foreman-proxy</pre></li><li class="listitem"><p class="simpara">
						Modify the <code class="literal">umask</code> value so that new files have the permissions <code class="literal">600</code>:
					</p><pre class="screen"># umask 077</pre></li><li class="listitem"><p class="simpara">
						Create the directory for the keytab:
					</p><pre class="screen"># mkdir -p "/var/kerberos/krb5/user/<span class="emphasis"><em>USER_ID</em></span>"</pre></li><li class="listitem"><p class="simpara">
						Create a keytab or copy an existing keytab to the directory:
					</p><pre class="screen"># cp <span class="emphasis"><em>your_client.keytab</em></span> /var/kerberos/krb5/user/<span class="emphasis"><em>USER_ID</em></span>/client.keytab</pre></li><li class="listitem"><p class="simpara">
						Change the directory owner to the <code class="literal">foreman-proxy</code> user:
					</p><pre class="screen"># chown -R foreman-proxy:foreman-proxy "/var/kerberos/krb5/user/<span class="emphasis"><em>USER_ID</em></span>"</pre></li><li class="listitem"><p class="simpara">
						Ensure that the keytab file is read-only:
					</p><pre class="screen"># chmod -wx "/var/kerberos/krb5/user/<span class="emphasis"><em>USER_ID</em></span>/client.keytab"</pre></li><li class="listitem"><p class="simpara">
						Restore the SELinux context:
					</p><pre class="screen"># restorecon -RvF /var/kerberos/krb5</pre></li></ol></div></section><section class="section" id="configuring_kerberos_authentication_for_remote_execution"><div class="titlepage"><div><div><h2 class="title">10.5. Configuring Kerberos Authentication for Remote Execution</h2></div></div></div><p>
				From Satellite 6.7, you can use Kerberos authentication to establish an SSH connection for remote execution on Satellite hosts.
			</p><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
					Before you can use Kerberos authentication for remote execution on Red Hat Satellite, you must set up a Kerberos server for identity management and ensure that you complete the following prerequisites:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Enroll Satellite Server on the Kerberos server
					</li><li class="listitem">
						Enroll the Satellite target host on the Kerberos server
					</li><li class="listitem">
						Configure and initialize a Kerberos user account for remote execution
					</li><li class="listitem">
						Ensure that the foreman-proxy user on Satellite has a valid Kerberos ticket granting ticket
					</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					To set up Satellite to use Kerberos authentication for remote execution on hosts, complete the following steps:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To install the <code class="literal">tfm-rubygem-net-ssh-krb</code> package, enter the following command:
					</p><pre class="screen"># yum install tfm-rubygem-net-ssh-krb</pre></li><li class="listitem"><p class="simpara">
						To install and enable Kerberos authentication for remote execution, enter the following command:
					</p><pre class="screen"># satellite-installer --scenario satellite \
 --foreman-proxy-plugin-remote-execution-ssh-ssh-kerberos-auth true</pre></li><li class="listitem">
						To edit the default user for remote execution, in the Satellite web UI, navigate to <span class="strong strong"><strong>Administer</strong></span> &gt; <span class="strong strong"><strong>Settings</strong></span> and click the <span class="strong strong"><strong>RemoteExecution</strong></span> tab. In the <span class="strong strong"><strong>remote_execution_ssh_user</strong></span> row, edit the second column and add the user name for the Kerberos account.
					</li><li class="listitem">
						Navigate to <span class="strong strong"><strong>remote_execution_effective_user</strong></span> and edit the second column to add the user name for the Kerberos account.
					</li></ol></div><p>
				To confirm that Kerberos authentication is ready to use, run a remote job on the host.
			</p></section><section class="section" id="sect-Managing_Hosts-Configuring_and_Running_Remote_Commands"><div class="titlepage"><div><div><h2 class="title">10.6. Configuring and Running Remote Jobs</h2></div></div></div><p>
				Any command that you want to apply to a remote host must be defined as a job template. After you have defined a job template you can execute it multiple times.
			</p><section class="section" id="sect-Managing_Hosts-Setting_up_Job_Templates"><div class="titlepage"><div><div><h3 class="title">10.6.1. Setting up Job Templates</h3></div></div></div><p>
					Satellite provides default job templates that you can use for executing jobs. To view the list of job templates, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Job templates</strong></span>. If want to use a template without making changes, proceed to <a class="xref" href="#sect-Managing_Hosts-Executing_Remote_Jobs" title="10.6.2. Executing Jobs">Section 10.6.2, “Executing Jobs”</a>.
				</p><p>
					You can use default templates as a base for developing your own. Default job templates are locked for editing. Clone the template and edit the clone.
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							To clone a template, in the <span class="strong strong"><strong>Actions</strong></span> column, select <span class="strong strong"><strong>Clone</strong></span>.
						</li><li class="listitem">
							Enter a unique name for the clone and click <span class="strong strong"><strong>Submit</strong></span> to save the changes.
						</li></ol></div><p>
					Job templates use the Embedded Ruby (ERB) syntax. For more information about writing templates, see the <a class="xref" href="#appe-Red_Hat_Satellite-Managing_Hosts-Template_Writing_Reference" title="Appendix A. Template Writing Reference">Appendix A, <em>Template Writing Reference</em></a>.
				</p><div class="formalpara"><p class="title"><strong>Ansible Considerations</strong></p><p>
						To create an Ansible job template, use the following procedure and instead of ERB syntax, use YAML syntax. Begin the template with <code class="literal">---</code> and to the first line, you must add <code class="literal">- hosts: all</code>. You can embed an Ansible playbook YAML file into the job template body. You can also add ERB syntax to customize your YAML Ansible template. You can also import Ansible playbooks in Satellite. For more information, see <a class="xref" href="#Synchronizing_Templates_Repositories" title="Chapter 12. Synchronizing Template Repositories">Chapter 12, <em>Synchronizing Template Repositories</em></a>.
					</p></div><div class="formalpara"><p class="title"><strong>Parameter Variables</strong></p><p>
						At run time, job templates can accept parameter variables that you define for a host. Note that only the parameters visible on the <span class="strong strong"><strong>Parameters</strong></span> tab at the host’s edit page can be used as input parameters for job templates. If you do not want your Ansible job template to accept parameter variables at run time, in the Satellite web UI, navigate to <span class="strong strong"><strong>Administer</strong></span> &gt; <span class="strong strong"><strong>Settings</strong></span> and click the <span class="strong strong"><strong>Ansible</strong></span> tab. In the <span class="strong strong"><strong>Top level Ansible variables</strong></span> row, change the <span class="strong strong"><strong>Value</strong></span> parameter to <span class="strong strong"><strong>No</strong></span>.
					</p></div><div class="orderedlist" id="proc-Managing_Hosts-Creating_a_Job_Template"><p class="title"><strong>To Create a Job Template:</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Job templates</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>New Job Template</strong></span>.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Template</strong></span> tab, and in the <span class="strong strong"><strong>Name</strong></span> field, enter a unique name for your job template.
						</li><li class="listitem">
							Select <span class="strong strong"><strong>Default</strong></span> to make the template available for all organizations and locations.
						</li><li class="listitem">
							Create the template directly in the template editor or upload it from a text file by clicking <span class="strong strong"><strong>Import</strong></span>.
						</li><li class="listitem">
							Optional: In the <span class="strong strong"><strong>Audit Comment</strong></span> field, add information about the change.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Job</strong></span> tab, and in the <span class="strong strong"><strong>Job category</strong></span> field, enter your own category or select from the default categories listed in <a class="xref" href="#tabl-Managing_Hosts-Default_Job_Template_Categories" title="Table 10.1. Default Job Template Categories">Table 10.1, “Default Job Template Categories”</a>.
						</li><li class="listitem">
							Optional: In the <span class="strong strong"><strong>Description Format</strong></span> field, enter a description template. For example, <code class="literal">Install package %{package_name}</code>. You can also use <code class="literal">%{template_name}</code> and <code class="literal">%{job_category}</code> in your template.
						</li><li class="listitem">
							From the <span class="strong strong"><strong>Provider Type</strong></span> list, select <span class="strong strong"><strong>SSH</strong></span> for shell scripts and <span class="strong strong"><strong>Ansible</strong></span> for Ansible tasks or playbooks.
						</li><li class="listitem">
							Optional: In the <span class="strong strong"><strong>Timeout to kill</strong></span> field, enter a timeout value to terminate the job if it does not complete.
						</li><li class="listitem">
							Optional: Click <span class="strong strong"><strong>Add Input</strong></span> to define an input parameter. Parameters are requested when executing the job and do not have to be defined in the template. For examples, see the <span class="strong strong"><strong>Help</strong></span> tab.
						</li><li class="listitem">
							Optional: Click <span class="strong strong"><strong>Foreign input set</strong></span> to include other templates in this job.
						</li><li class="listitem">
							Optional: In the <span class="strong strong"><strong>Effective user</strong></span> area, configure a user if the command cannot use the default <code class="literal">remote_execution_effective_user</code> setting.
						</li><li class="listitem">
							Optional: If this template is a snippet to be included in other templates, click the <span class="strong strong"><strong>Type</strong></span> tab and select <span class="strong strong"><strong>Snippet</strong></span>.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Location</strong></span> tab and add the locations where you want to use the template.
						</li><li class="listitem">
							Click the <span class="strong strong"><strong>Organizations</strong></span> tab and add the organizations where you want to use the template.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Submit</strong></span> to save your changes.
						</li></ol></div><p>
					You can create advanced templates by including other templates in the template syntax, see <a class="xref" href="#sect-Managing_Hosts-Creating_Advanced_Templates" title="10.6.4. Creating Advanced Templates">Section 10.6.4, “Creating Advanced Templates”</a> for more information.
				</p><p>
					An advanced template is required, for example, for executing jobs that perform power actions; see <a class="xref" href="#exam-Managing_Hosts-Including_Power_Actions_in_Templates" title="Example 10.4. Including Power Actions in Templates">Example 10.4, “Including Power Actions in Templates”</a> for information on how to include the <span class="strong strong"><strong>Power Action - SSH Default</strong></span> template in a custom template.
				</p><div class="formalpara"><p class="title"><strong>For CLI Users</strong></p><p>
						To create a job template using a template-definition file, enter the following command:
					</p></div><pre class="screen"># hammer job-template create \
--file "<span class="emphasis"><em>path_to_template_file</em></span>" \
--name "<span class="emphasis"><em>template_name</em></span>" \
--provider-type SSH \
--job-category "<span class="emphasis"><em>category_name</em></span>"</pre><div class="table" id="tabl-Managing_Hosts-Default_Job_Template_Categories"><p class="title"><strong>Table 10.1. Default Job Template Categories</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45628281062448" scope="col">Job template category</th><th align="left" valign="top" id="idm45628281061360" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45628281062448">
								<p>
									Packages
								</p>
								</td><td align="left" valign="top" headers="idm45628281061360">
								<p>
									Templates for performing package related actions. Install, update, and remove actions are included by default.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45628281062448">
								<p>
									Puppet
								</p>
								</td><td align="left" valign="top" headers="idm45628281061360">
								<p>
									Templates for executing Puppet runs on target hosts.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45628281062448">
								<p>
									Power
								</p>
								</td><td align="left" valign="top" headers="idm45628281061360">
								<p>
									Templates for performing power related actions. Restart and shutdown actions are included by default.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45628281062448">
								<p>
									Commands
								</p>
								</td><td align="left" valign="top" headers="idm45628281061360">
								<p>
									Templates for executing custom commands on remote hosts.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45628281062448">
								<p>
									Services
								</p>
								</td><td align="left" valign="top" headers="idm45628281061360">
								<p>
									Templates for performing service related actions. Start, stop, restart, and status actions are included by default.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45628281062448">
								<p>
									Katello
								</p>
								</td><td align="left" valign="top" headers="idm45628281061360">
								<p>
									Templates for performing content related actions. These templates are used mainly from different parts of the Satellite web UI (for example bulk actions UI for content hosts), but can be used separately to perform operations such as errata installation.
								</p>
								</td></tr></tbody></table></div></div><div class="example" id="exam-Managing_Hosts-Creating_a_restorecon_Template"><p class="title"><strong>Example 10.1. Creating a restorecon Template</strong></p><div class="example-contents"><p>
						This example shows how to create a template called <span class="strong strong"><strong>Run Command - restorecon</strong></span> that restores the default <span class="strong strong"><strong>SELinux</strong></span> context for all files in the selected directory on target hosts.
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Job templates</strong></span>. Click <span class="strong strong"><strong>New Job Template</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Enter <span class="strong strong"><strong>Run Command - restorecon</strong></span> in the <span class="strong strong"><strong>Name</strong></span> field. Select <span class="strong strong"><strong>Default</strong></span> to make the template available to all organizations. Add the following text to the template editor:
							</p><pre class="programlisting language-ruby">restorecon -RvF &lt;%= input("directory") %&gt;</pre><p class="simpara">
								The <code class="literal">&lt;%= input("directory") %&gt;</code> string is be replaced by a user-defined directory during job invocation.
							</p></li><li class="listitem">
								On the <span class="strong strong"><strong>Job</strong></span> tab, set <span class="strong strong"><strong>Job category</strong></span> to <code class="literal">Commands</code>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Add Input</strong></span> to allow job customization. Enter <code class="literal">directory</code> to the <span class="strong strong"><strong>Name</strong></span> field. The input name must match the value specified in the template editor.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Required</strong></span> so that the command cannot be executed without the user specified parameter.
							</li><li class="listitem">
								Select <span class="strong strong"><strong>User input</strong></span> from the <span class="strong strong"><strong>Input type</strong></span> list. Enter a description to be shown during job invocation, for example <code class="literal">Target directory for restorecon</code>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Submit</strong></span>.
							</li></ol></div><p>
						See <a class="xref" href="#exam-Managing_Hosts-Executing_a_restorecon_Template_on_Multiple_Hosts" title="Example 10.2. Executing a restorecon Template on Multiple Hosts">Example 10.2, “Executing a restorecon Template on Multiple Hosts”</a> for information on how to execute a job based on this template.
					</p></div></div></section><section class="section" id="sect-Managing_Hosts-Executing_Remote_Jobs"><div class="titlepage"><div><div><h3 class="title">10.6.2. Executing Jobs</h3></div></div></div><p>
					You can execute a job that is based on a job template against one or more hosts.
				</p><div class="orderedlist" id="proc-Managing_Hosts-Executing_a_Remote_Job"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All Hosts</strong></span> and select the target hosts on which you want to execute a remote job. You can use the search field to filter the host list.
						</li><li class="listitem">
							From the <span class="strong strong"><strong>Select Action</strong></span> list, select <span class="strong strong"><strong>Schedule Remote Job</strong></span>.
						</li><li class="listitem"><p class="simpara">
							On the <span class="strong strong"><strong>Job invocation</strong></span> page, define the main job settings:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Select the <span class="strong strong"><strong>Job category</strong></span> and the <span class="strong strong"><strong>Job template</strong></span> you want to use.
								</li><li class="listitem">
									Optional: Select a stored search string in the <span class="strong strong"><strong>Bookmark</strong></span> list to specify the target hosts.
								</li><li class="listitem">
									Optional: Further limit the targeted hosts by entering a <span class="strong strong"><strong>Search query</strong></span>. The <span class="strong strong"><strong>Resolves to</strong></span> line displays the number of hosts affected by your query. Use the refresh button to recalculate the number after changing the query. The preview icon lists the targeted hosts.
								</li><li class="listitem">
									The remaining settings depend on the selected job template. See <a class="xref" href="#proc-Managing_Hosts-Creating_a_Job_Template" title="To Create a Job Template:">To Create a Job Template:</a> for information on adding custom parameters to a template.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Optional: To configure advanced settings for the job, click <span class="strong strong"><strong>Display advanced fields</strong></span>. Some of the advanced settings depend on the job template, the following settings are general:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<span class="strong strong"><strong>Effective user</strong></span> defines the user for executing the job, by default it is the SSH user.
								</li><li class="listitem">
									<span class="strong strong"><strong>Concurrency level</strong></span> defines the maximum number of jobs executed at once, which can prevent overload of systems' resources in a case of executing the job on a large number of hosts.
								</li><li class="listitem">
									<span class="strong strong"><strong>Timeout to kill</strong></span> defines time interval in seconds after which the job should be killed, if it is not finished already. A task which could not be started during the defined interval, for example, if the previous task took too long to finish, is canceled.
								</li><li class="listitem">
									<span class="strong strong"><strong>Type of query</strong></span> defines when the search query is evaluated. This helps to keep the query up to date for scheduled tasks.
								</li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>Execution ordering</strong></span> determines the order in which the job is executed on hosts: alphabetical or randomized.
								</p><p class="simpara">
									<span class="strong strong"><strong>Concurrency level</strong></span> and <span class="strong strong"><strong>Timeout to kill</strong></span> settings enable you to tailor job execution to fit your infrastructure hardware and needs.
								</p></li></ul></div></li><li class="listitem">
							To run the job immediately, ensure that <span class="strong strong"><strong>Schedule</strong></span> is set to <span class="strong strong"><strong>Execute now</strong></span>. You can also define a one-time future job, or set up a recurring job. For recurring tasks, you can define start and end dates, number and frequency of runs. You can also use cron syntax to define repetition. For more information about cron, see the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/ch-automating_system_tasks">Automating System Tasks</a> section of the Red Hat Enterprise Linux 7 <span class="emphasis"><em>System Administrator’s Guide</em></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Submit</strong></span>. This displays the <span class="strong strong"><strong>Job Overview</strong></span> page, and when the job completes, also displays the status of the job.
						</li></ol></div><div class="formalpara"><p class="title"><strong>For CLI Users</strong></p><p>
						Enter the following command on Satellite:
					</p></div><p>
					+
				</p><pre class="screen"># hammer settings set --name=remote_execution_global_proxy --value=false</pre><p>
					To execute a remote job with custom parameters, complete the following steps:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Find the ID of the job template you want to use:
						</p><pre class="screen"># hammer job-template list</pre></li><li class="listitem"><p class="simpara">
							Show the template details to see parameters required by your template:
						</p><pre class="screen"># hammer job-template info --id <span class="emphasis"><em>template_ID</em></span></pre></li><li class="listitem"><p class="simpara">
							Execute a remote job with custom parameters:
						</p><pre class="screen"># hammer job-invocation create \
--job-template "<span class="emphasis"><em>template_name</em></span>" \
--inputs <span class="emphasis"><em>key1</em></span>="<span class="emphasis"><em>value</em></span>",<span class="emphasis"><em>key2</em></span>="<span class="emphasis"><em>value</em></span>",... \
--search-query "<span class="emphasis"><em>query</em></span>"</pre><p class="simpara">
							Replace <span class="emphasis"><em>query</em></span> with the filter expression that defines hosts, for example <code class="literal">"name ~ rex01"</code>. For more information about executing remote commands with hammer, enter <code class="literal">hammer job-template --help</code> and <code class="literal">hammer job-invocation --help</code>.
						</p></li></ol></div><div class="example" id="exam-Managing_Hosts-Executing_a_restorecon_Template_on_Multiple_Hosts"><p class="title"><strong>Example 10.2. Executing a restorecon Template on Multiple Hosts</strong></p><div class="example-contents"><p>
						This example shows how to run a job based on the template created in <a class="xref" href="#exam-Managing_Hosts-Creating_a_restorecon_Template" title="Example 10.1. Creating a restorecon Template">Example 10.1, “Creating a restorecon Template”</a> on multiple hosts. The job restores the SELinux context in all files under the <span class="strong strong"><strong>/home/</strong></span> directory.
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
								Navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All hosts</strong></span> and select target hosts. Select <span class="strong strong"><strong>Schedule Remote Job</strong></span> from the <span class="strong strong"><strong>Select Action</strong></span> list.
							</li><li class="listitem">
								In the <span class="strong strong"><strong>Job invocation</strong></span> page, select the <code class="literal">Commands</code> job category and the <code class="literal">Run Command - restorecon</code> job template.
							</li><li class="listitem">
								Type <code class="literal">/home</code> in the <span class="strong strong"><strong>directory</strong></span> field.
							</li><li class="listitem">
								Set <span class="strong strong"><strong>Schedule</strong></span> to <code class="literal">Execute now</code>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Submit</strong></span>. You are taken to the <span class="strong strong"><strong>Job invocation</strong></span> page where you can monitor the status of job execution.
							</li></ol></div></div></div></section><section class="section" id="sect-Managing_Hosts-Monitoring_Remote_Jobs"><div class="titlepage"><div><div><h3 class="title">10.6.3. Monitoring Jobs</h3></div></div></div><p>
					You can monitor the progress of the job while it is running. This can help in any troubleshooting that may be required.
				</p><p>
					Ansible jobs run on batches of 100 hosts, so you cannot cancel a job running on a specific host. A job completes only after the Ansible playbook runs on all hosts in the batch.
				</p><div class="orderedlist" id="proc-Managing_Hosts-Monitoring_a_Remote_Job"><p class="title"><strong>To Monitor a Job:</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Navigate to the Job page. This page is automatically displayed if you triggered the job with the <code class="literal">Execute now</code> setting. To monitor scheduled jobs, navigate to <span class="strong strong"><strong>Monitor</strong></span> &gt; <span class="strong strong"><strong>Jobs</strong></span> and select the job run you wish to inspect.
						</li><li class="listitem">
							On the Job page, click the <span class="strong strong"><strong>Hosts</strong></span> tab. This displays the list of hosts on which the job is running.
						</li><li class="listitem">
							In the <span class="strong strong"><strong>Host</strong></span> column, click the name of the host that you want to inspect. This displays the <span class="strong strong"><strong>Detail of Commands</strong></span> page where you can monitor the job execution in real time.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Back to Job</strong></span> at any time to return to the <span class="strong strong"><strong>Job Details</strong></span> page.
						</li></ol></div><div class="formalpara"><p class="title"><strong>For CLI Users</strong></p><p>
						To monitor the progress of a job while it is running, complete the following steps:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Find the ID of a job:
						</p><pre class="screen"># hammer job-invocation list</pre></li><li class="listitem"><p class="simpara">
							Monitor the job output:
						</p><pre class="screen"># hammer job-invocation output \
--id <span class="emphasis"><em>job_ID</em></span> \
--host <span class="emphasis"><em>host_name</em></span></pre></li><li class="listitem"><p class="simpara">
							Optional: to cancel a job, enter the following command:
						</p><pre class="screen"># hammer job-invocation cancel \
--id <span class="emphasis"><em>job_ID</em></span></pre></li></ol></div></section><section class="section" id="sect-Managing_Hosts-Creating_Advanced_Templates"><div class="titlepage"><div><div><h3 class="title">10.6.4. Creating Advanced Templates</h3></div></div></div><p>
					When creating a job template, you can include an existing template in the template editor field. This way you can combine templates, or create more specific templates from the general ones.
				</p><p>
					The following template combines default templates to install and start the <span class="strong strong"><strong>httpd</strong></span> service on Red Hat Enterprise Linux systems:
				</p><pre class="programlisting language-ruby">&lt;%= render_template 'Package Action - SSH Default', :action =&gt; 'install', :package =&gt; 'httpd' %&gt;
&lt;%= render_template 'Service Action - SSH Default', :action =&gt; 'start', :service_name =&gt; 'httpd' %&gt;</pre><p>
					The above template specifies parameter values for the rendered template directly. It is also possible to use the <span class="strong strong"><strong>input()</strong></span> method to allow users to define input for the rendered template on job execution. For example, you can use the following syntax:
				</p><pre class="programlisting language-ruby">&lt;%= render_template 'Package Action - SSH Default', :action =&gt; 'install', :package =&gt; input("package") %&gt;</pre><p>
					With the above template, you have to import the parameter definition from the rendered template. To do so, navigate to the <span class="strong strong"><strong>Jobs</strong></span> tab, click <span class="strong strong"><strong>Add Foreign Input Set</strong></span>, and select the rendered template from the <span class="strong strong"><strong>Target template</strong></span> list. You can import all parameters or specify a comma separated list.
				</p><div class="example" id="exam-Managing_Hosts-Rendering_a_restorecon_Template"><p class="title"><strong>Example 10.3. Rendering a restorecon Template</strong></p><div class="example-contents"><p>
						This example shows how to create a template derived from the <span class="strong strong"><strong>Run command - restorecon</strong></span> template created in <a class="xref" href="#exam-Managing_Hosts-Creating_a_restorecon_Template" title="Example 10.1. Creating a restorecon Template">Example 10.1, “Creating a restorecon Template”</a>. This template does not require user input on job execution, it will restore the SELinux context in all files under the <span class="strong strong"><strong>/home/</strong></span> directory on target hosts.
					</p><p>
						Create a new template as described in <a class="xref" href="#sect-Managing_Hosts-Setting_up_Job_Templates" title="10.6.1. Setting up Job Templates">Section 10.6.1, “Setting up Job Templates”</a>, and specify the following string in the template editor:
					</p><pre class="programlisting language-ruby">&lt;%= render_template("Run Command - restorecon", :directory =&gt; "/home") %&gt;</pre></div></div><div class="example" id="exam-Managing_Hosts-Including_Power_Actions_in_Templates"><p class="title"><strong>Example 10.4. Including Power Actions in Templates</strong></p><div class="example-contents"><p>
						This example shows how to set up a job template for performing power actions, such as reboot. This procedure prevents Satellite from interpreting the disconnect exception upon reboot as an error, and consequently, remote execution of the job works correctly.
					</p><p>
						Create a new template as described in <a class="xref" href="#sect-Managing_Hosts-Setting_up_Job_Templates" title="10.6.1. Setting up Job Templates">Section 10.6.1, “Setting up Job Templates”</a>, and specify the following string in the template editor:
					</p><pre class="programlisting language-ruby">&lt;%= render_template("Power Action - SSH Default", :action =&gt; "restart") %&gt;</pre></div></div></section></section><section class="section" id="sect-Managing_Hosts-Delegating_Permissions"><div class="titlepage"><div><div><h2 class="title">10.7. Delegating Permissions for Remote Execution</h2></div></div></div><p>
				You can control which users can run which jobs within your infrastructure, including which hosts they can target. The remote execution feature provides two built-in roles:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>Remote Execution Manager</strong></span>: This role allows access to all remote execution features and functionality.
					</li><li class="listitem">
						<span class="strong strong"><strong>Remote Execution User</strong></span>: This role only allows running jobs; it does not provide permission to modify job templates.
					</li></ul></div><p>
				You can clone the Remote Execution User role and customize its filter for increased granularity. If you adjust the filter with the <code class="literal">view_job_templates</code> permission, the user can only see and trigger jobs based on matching job templates. You can use the <code class="literal">view_hosts</code> and <code class="literal">view_smart_proxies</code> permissions to limit which hosts or Capsules are visible to the role.
			</p><p>
				The <code class="literal">execute_template_invocation</code> permission is a special permission that is checked immediately before execution of a job begins. This permission defines which job template you can run on a particular host. This allows for even more granularity when specifying permissions. For more information on working with roles and permissions see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/administering_red_hat_satellite/chap-red_hat_satellite-administering_red_hat_satellite-users_and_roles#sect-Red_Hat_Satellite-Administering_Red_Hat_Satellite-Users_and_Roles-Creating_and_Managing_Roles">Creating and Managing Roles</a> in the <span class="emphasis"><em>Administering Red Hat Satellite</em></span>.
			</p><p>
				The following example shows filters for the <code class="literal">execute_template_invocation</code> permission:
			</p><pre class="screen">name = Reboot and host.name = staging.example.com
name = Reboot and host.name ~ *.staging.example.com
name = "Restart service" and host_group.name = webservers</pre><p>
				The first line in the above example permits the user to apply the <span class="strong strong"><strong>Reboot</strong></span> template to one selected host. The second line defines a pool of hosts with names ending with <span class="strong strong"><strong>.staging.example.com</strong></span>. The third line binds the template with a host group.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Permissions assigned to users can change over time. If a user has already scheduled some jobs to run in the future, and the permissions have changed, this can result in execution failure because the permissions are checked immediately before job execution.
				</p></div></div></section></section><section class="chapter" id="chap-Red_Hat_Satellite-Managing_Hosts-Integrating_Satellite_and_Ansible_Tower"><div class="titlepage"><div><div><h1 class="title">Chapter 11. Integrating Red Hat Satellite and Ansible Tower</h1></div></div></div><p>
			You can integrate Red Hat Satellite 6.7 and Ansible Tower to use Satellite Server as a dynamic inventory source for Ansible Tower.
		</p><p>
			You can also use the provisioning callback function to run playbooks on hosts managed by Satellite, from either the host or Ansible Tower. When provisioning new hosts from Satellite Server, you can use the provisioning callback function to trigger playbook runs from Ansible Tower. The playbook configures the host following Kickstart deployment.
		</p><section class="section" id="sect-Red_Hat_Satellite-Managing_Hosts-Integrating_Satellite_and_Ansible_Tower-Adding_Satellite_Server_to_Ansible_Tower_as_a_Dynamic_Inventory_Item"><div class="titlepage"><div><div><h2 class="title">11.1. Adding Satellite Server to Ansible Tower as a Dynamic Inventory Item</h2></div></div></div><p>
				To add Satellite Server to Ansible Tower as a dynamic inventory item, you must create a credential for a Satellite Server user on Ansible Tower, add an Ansible Tower user to the credential, and then configure an inventory source.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						If your Satellite deployment is large, for example, managing tens of thousands of hosts, using a non-admin user can negatively impact performance because of time penalties that accrue during authorization checks. For large deployments, consider using an admin user.
					</li><li class="listitem">
						For non-admin users, you must assign the <code class="literal">Ansible Tower Inventory Reader</code> role to your Satellite Server user. For more information about managing users, roles, and permission filters, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/administering_red_hat_satellite/chap-Red_Hat_Satellite-Administering_Red_Hat_Satellite-Users_and_Roles#sect-Red_Hat_Satellite-Administering_Red_Hat_Satellite-Users_and_Roles-Creating_and_Managing_Roles">Creating and Managing Roles</a> in <span class="emphasis"><em>Administering Red Hat Satellite</em></span>.
					</li><li class="listitem">
						You must host your Satellite Server and Ansible Tower on the same network or subnet.
					</li></ul></div><div id="proc-Red_Hat_Satellite-Managing_Hosts-Integrating_Satellite_and_Ansible_Tower-To_Add_Satellite_Server_to_Ansible_Tower_as_a_Dynamic_Inventory_Item" class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					To add Satellite Server to Ansible Tower as a Dynamic Inventory Item, complete the following procedure:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						In the Ansible Tower web UI, create a credential for your Satellite. For more information about creating credentials, see <a class="link" href="http://docs.ansible.com/ansible-tower/latest/html/userguide/credentials.html#add-a-new-credential">Add a New Credential</a> and <a class="link" href="http://docs.ansible.com/ansible-tower/latest/html/userguide/credentials.html#red-hat-satellite-6">Red Hat Satellite 6 Credentials</a> in the <span class="emphasis"><em>Ansible Tower User Guide</em></span>.
					</p><div class="table" id="tabl-Red_Hat_Satellite-Managing_Hosts-Integrating_Satellite_and_Ansible_Tower-Satellite_Credentials"><p class="title"><strong>Table 11.1. Satellite Credentials</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"/><col style="width: 67%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45628285000272" scope="col"><span class="strong strong"><strong>Credential Type</strong></span>:</th><th align="left" valign="top" id="idm45628284998560" scope="col"><span class="strong strong"><strong>Red Hat Satellite 6</strong></span></th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45628285000272">
									<p>
										<span class="strong strong"><strong>Satellite 6 URL</strong></span>:
									</p>
									</td><td align="left" valign="top" headers="idm45628284998560">
									<p>
										https://<span class="emphasis"><em>satellite.example.com</em></span>
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45628285000272">
									<p>
										<span class="strong strong"><strong>Username</strong></span>:
									</p>
									</td><td align="left" valign="top" headers="idm45628284998560">
									<p>
										The username of the Satellite user with the integration role.
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45628285000272">
									<p>
										<span class="strong strong"><strong>Password</strong></span>:
									</p>
									</td><td align="left" valign="top" headers="idm45628284998560">
									<p>
										The password of the Satellite user.
									</p>
									</td></tr></tbody></table></div></div></li><li class="listitem">
						Add an Ansible Tower user to the new credential. For more information about adding a user to a credential, see <a class="link" href="http://docs.ansible.com/ansible-tower/latest/html/userguide/credentials.html#getting-started-with-credentials">Getting Started with Credentials</a> in the <span class="emphasis"><em>Ansible Tower User Guide</em></span>.
					</li><li class="listitem">
						Add a new inventory. For more information, see <a class="link" href="http://docs.ansible.com/ansible-tower/latest/html/userguide/inventories.html#add-a-new-inventory">Add a new inventory</a> in the <span class="emphasis"><em>Ansible Tower User Guide</em></span>.
					</li><li class="listitem"><p class="simpara">
						In the new inventory, add Satellite Server as the inventory source, specifying the following inventory source options. For more information, see <a class="link" href="https://docs.ansible.com/ansible-tower/latest/html/userguide/inventories.html#add-source">Add Source</a> in the <span class="emphasis"><em>Ansible Tower User Guide</em></span>.
					</p><div class="table" id="tabl-Red_Hat_Satellite-Managing_Hosts-Integrating_Satellite_and_Ansible_Tower-Inventory_Source_Options"><p class="title"><strong>Table 11.2. Inventory Source Options</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"/><col style="width: 67%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45628283043280" scope="col"><span class="strong strong"><strong>Source</strong></span></th><th align="left" valign="top" id="idm45628283041728" scope="col"><span class="strong strong"><strong>Red Hat Satellite 6</strong></span></th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45628283043280">
									<p>
										<span class="strong strong"><strong>Credential</strong></span>
									</p>
									</td><td align="left" valign="top" headers="idm45628283041728">
									<p>
										The credential you create for Satellite Server.
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45628283043280">
									<p>
										<span class="strong strong"><strong>Overwrite</strong></span>
									</p>
									</td><td align="left" valign="top" headers="idm45628283041728">
									<p>
										Select
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45628283043280">
									<p>
										<span class="strong strong"><strong>Overwrite Variables</strong></span>
									</p>
									</td><td align="left" valign="top" headers="idm45628283041728">
									<p>
										Select
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45628283043280">
									<p>
										<span class="strong strong"><strong>Update on Launch</strong></span>
									</p>
									</td><td align="left" valign="top" headers="idm45628283041728">
									<p>
										Select
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45628283043280">
									<p>
										<span class="strong strong"><strong>Cache Timeout</strong></span>
									</p>
									</td><td align="left" valign="top" headers="idm45628283041728">
									<p>
										<span class="emphasis"><em>90</em></span>
									</p>
									</td></tr></tbody></table></div></div></li><li class="listitem">
						Ensure that you synchronize the source that you add.
					</li></ol></div></section><section class="section" id="sect-Red_Hat_Satellite-Managing_Hosts-Integrating_Satellite_and_Ansible_Tower-Configuring_Provisioning_Callback_for_a_Host"><div class="titlepage"><div><div><h2 class="title">11.2. Configuring Provisioning Callback for a Host</h2></div></div></div><p>
				When you create hosts in Satellite, you can use Ansible Tower to run playbooks to configure your newly created hosts. This is called <span class="emphasis"><em>provisioning callback</em></span> in Ansible Tower.
			</p><p>
				The provisioning callback function triggers a playbook run from Ansible Tower as part of the provisioning process. The playbook configures the host after Kickstart deployment.
			</p><p>
				For more information about provisioning callbacks, see <a class="link" href="http://docs.ansible.com/ansible-tower/latest/html/userguide/job_templates.html#provisioning-callbacks">Provisioning Callbacks</a> in the <span class="emphasis"><em>Ansible Tower User Guide</em></span>.
			</p><p>
				In Satellite Server, the <code class="literal">Kickstart Default</code> and <code class="literal">Kickstart Default Finish</code> templates include three snippets:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						<code class="literal">ansible_provisioning_callback</code>
					</li><li class="listitem">
						<code class="literal">ansible_tower_callback_script</code>
					</li><li class="listitem">
						<code class="literal">ansible_tower_callback_service</code>
					</li></ol></div><p>
				You can add parameters to hosts or host groups to provide the credentials that these snippets can use to run Ansible playbooks on your newly created hosts.
			</p><div class="formalpara"><p class="title"><strong>Prerequisites</strong></p><p>
					Before you can configure provisioning callbacks, you must add Satellite as a dynamic inventory in Ansible Tower. For more information, see <a class="link" href="#chap-Red_Hat_Satellite-Managing_Hosts-Integrating_Satellite_and_Ansible_Tower" title="Chapter 11. Integrating Red Hat Satellite and Ansible Tower">Integrating Satellite and Ansible Tower</a>.
				</p></div><p>
				In the Ansible Tower web UI, you must complete the following tasks:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Create a machine credential for your new host. Ensure that you enter the same password in the credential that you plan to assign to the host that you create in Satellite. For more information, see <a class="link" href="https://docs.ansible.com/ansible-tower/latest/html/userguide/credentials.html#add-a-new-credential">Add a New Credential</a> in the <span class="emphasis"><em>Ansible Tower User Guide</em></span>.
					</li><li class="listitem">
						Create a project. For more information, see <a class="link" href="https://docs.ansible.com/ansible-tower/latest/html/userguide/projects.html">Projects</a> in the <span class="emphasis"><em>Ansible Tower User Guide</em></span>.
					</li><li class="listitem">
						Add a job template to your project. For more information, see <a class="link" href="https://docs.ansible.com/ansible-tower/latest/html/userguide/job_templates.html#create-a-job-template">Job Templates</a> in the <span class="emphasis"><em>Ansible Tower User Guide</em></span>.
					</li><li class="listitem">
						In your job template, you must enable provisioning callbacks, generate the host configuration key, and note the <span class="emphasis"><em>template_ID</em></span> of your job template. For more information about job templates, see <a class="link" href="http://docs.ansible.com/ansible-tower/latest/html/userguide/job_templates.html#">Job Templates</a> in the <span class="emphasis"><em>Ansible Tower User Guide</em></span>.
					</li></ol></div><div id="proc-Red_Hat_Satellite-Managing_Hosts-Integrating_Satellite_and_Ansible_Tower-To_Configure_Provisioning_Callback_for_a_Host" class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					To configure provisioning callback for a new host in Satellite, complete the following steps:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						In the Red Hat Satellite web UI, navigate to <span class="strong strong"><strong>Configure</strong></span> &gt; <span class="strong strong"><strong>Host Group</strong></span>.
					</li><li class="listitem">
						Create a host group or edit an existing host group.
					</li><li class="listitem">
						In the Host Group window, click the <span class="strong strong"><strong>Parameters</strong></span> tab.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Add Parameter</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Enter the following information for each new parameter:
					</p><div class="table" id="tabl-Red_Hat_Satellite-Managing_Hosts-Integrating_Satellite_and_Ansible_Tower-Host_Parameters"><p class="title"><strong>Table 11.3. Host Parameters</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"/><col style="width: 25%; " class="col_2"/><col style="width: 50%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45628280080736" scope="col">Name</th><th align="left" valign="top" id="idm45628280079648" scope="col">Value</th><th align="left" valign="top" id="idm45628280078560" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45628280080736">
									<p>
										<code class="literal">ansible_tower_provisioning</code>
									</p>
									</td><td align="left" valign="top" headers="idm45628280079648">
									<p>
										true
									</p>
									</td><td align="left" valign="top" headers="idm45628280078560">
									<p>
										Enables Provisioning Callback.
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45628280080736">
									<p>
										<code class="literal">ansible_tower_fqdn</code>
									</p>
									</td><td align="left" valign="top" headers="idm45628280079648">
									<p>
										<span class="emphasis"><em>tower.example.com</em></span>
									</p>
									</td><td align="left" valign="top" headers="idm45628280078560">
									<p>
										The fully qualified domain name (FQDN) of your Ansible Tower. Do not add <code class="literal">https</code> because this is appended by Ansible Tower.
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45628280080736">
									<p>
										<code class="literal">ansible_job_template_id</code>
									</p>
									</td><td align="left" valign="top" headers="idm45628280079648">
									<p>
										<span class="emphasis"><em>template_ID</em></span>
									</p>
									</td><td align="left" valign="top" headers="idm45628280078560">
									<p>
										The ID of your provisioning template that you can find in the URL of the template: <code class="literal">/templates/job_template/<span class="emphasis"><em>5</em></span></code>.
									</p>
									</td></tr><tr><td align="left" valign="top" headers="idm45628280080736">
									<p>
										<code class="literal">ansible_host_config_key</code>
									</p>
									</td><td align="left" valign="top" headers="idm45628280079648">
									<p>
										<span class="emphasis"><em>config_KEY</em></span>
									</p>
									</td><td align="left" valign="top" headers="idm45628280078560">
									<p>
										The host configuration key that your job template generates in Ansible Tower.
									</p>
									</td></tr></tbody></table></div></div></li><li class="listitem">
						Click <span class="strong strong"><strong>Submit</strong></span>.
					</li><li class="listitem">
						Create a host using the host group.
					</li><li class="listitem"><p class="simpara">
						On the new host, enter the following command to start the <code class="literal">ansible-callback</code> service:
					</p><pre class="screen"># systemctl start ansible-callback</pre></li><li class="listitem"><p class="simpara">
						On the new host, enter the following command to output the status of the <code class="literal">ansible-callback</code> service:
					</p><pre class="screen"># systemctl status ansible-callback</pre><p class="simpara">
						Provisioning callback is configured correctly if the command returns the following output:
					</p><pre class="screen">SAT_host systemd[1]: Started Provisioning callback to Ansible Tower...</pre></li></ol></div><div class="formalpara"><p class="title"><strong>Manual Provisioning Callback</strong></p><p>
					You can use the provisioning callback URL and the host configuration key from a host to call Ansible Tower. For example:
				</p></div><pre class="screen"># curl -k -s --data curl --insecure --data host_config_key=<span class="emphasis"><em>my_config_key</em></span> \
 https://<span class="emphasis"><em>tower.example.com</em></span>/api/v2/job_templates/<span class="emphasis"><em>8</em></span>/callback/</pre><p>
				Ensure that you use <code class="literal">https</code> when you enter the provisioning callback URL.
			</p><p>
				This triggers the playbook run specified in the template against the host.
			</p></section></section><section class="chapter" id="Synchronizing_Templates_Repositories"><div class="titlepage"><div><div><h1 class="title">Chapter 12. Synchronizing Template Repositories</h1></div></div></div><p>
			In Satellite, you can synchronize repositories of job templates, provisioning templates, report templates, and partition table templates between Satellite Server and a version control system or local directory. In this chapter, a Git repository is used for demonstration purposes.
		</p><p>
			This section details the workflow for:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					installing and configuring the TemplateSync plug-in
				</li><li class="listitem">
					performing exporting and importing tasks
				</li></ul></div><section class="section" id="enabling_the_templatesync_plug_in"><div class="titlepage"><div><div><h2 class="title">12.1. Enabling the TemplateSync plug-in</h2></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To enable the plug-in on your Satellite Server, enter the following command:
					</p><pre class="screen"># satellite-installer --enable-foreman-plugin-templates</pre></li><li class="listitem">
						To verify that the plug-in is installed correctly, ensure <span class="strong strong"><strong>Administer</strong></span> &gt; <span class="strong strong"><strong>Settings</strong></span> includes the <span class="strong strong"><strong>TemplateSync</strong></span> menu.
					</li></ol></div></section><section class="section" id="configuring-the-templatesync-plug-in"><div class="titlepage"><div><div><h2 class="title">12.2. Configuring the TemplateSync plug-in</h2></div></div></div><p>
				In the Satellite web UI, navigate to <span class="strong strong"><strong>Administer</strong></span> &gt; <span class="strong strong"><strong>Settings</strong></span> &gt; <span class="strong strong"><strong>TemplateSync</strong></span> to configure the plug-in. The following table explains the attributes behavior. Note that some attributes are used only for importing or exporting tasks.
			</p><div class="table" id="idm45628280396768"><p class="title"><strong>Table 12.1. Synchronizing Templates Plug-in configuration</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"/><col style="width: 25%; " class="col_2"/><col style="width: 25%; " class="col_3"/><col style="width: 25%; " class="col_4"/></colgroup><thead><tr><th align="left" valign="top" id="idm45628280390048" scope="col">Parameter</th><th align="left" valign="top" id="idm45628280388960" scope="col">API parameter name</th><th align="left" valign="top" id="idm45628280387872" scope="col">Meaning on importing</th><th align="left" valign="top" id="idm45628280386784" scope="col">Meaning on exporting</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45628280390048">
							<p>
								Associate
							</p>
							</td><td align="left" valign="top" headers="idm45628280388960">
							<p>
								<code class="literal">associate</code>
							</p>
							<p>
								Accepted values: <code class="literal">always</code>, <code class="literal">new</code>, <code class="literal">never</code>
							</p>
							</td><td align="left" valign="top" headers="idm45628280387872">
							<p>
								Associates templates with OS, Organization, and Location based on metadata.
							</p>
							</td><td align="left" valign="top" headers="idm45628280386784">
							<p>
								N/A
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628280390048">
							<p>
								Branch
							</p>
							</td><td align="left" valign="top" headers="idm45628280388960">
							<p>
								<code class="literal">branch</code>
							</p>
							</td><td align="left" valign="top" headers="idm45628280387872">
							<p>
								Specifies the default branch in Git repository to read from.
							</p>
							</td><td align="left" valign="top" headers="idm45628280386784">
							<p>
								Specifies the default branch in Git repository to write to.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628280390048">
							<p>
								Dirname
							</p>
							</td><td align="left" valign="top" headers="idm45628280388960">
							<p>
								<code class="literal">dirname</code>
							</p>
							</td><td align="left" valign="top" headers="idm45628280387872">
							<p>
								Specifies the subdirectory under the repository to read from.
							</p>
							</td><td align="left" valign="top" headers="idm45628280386784">
							<p>
								Specifies the subdirectory under the repository to write to.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628280390048">
							<p>
								Filter
							</p>
							</td><td align="left" valign="top" headers="idm45628280388960">
							<p>
								<code class="literal">filter</code>
							</p>
							</td><td align="left" valign="top" headers="idm45628280387872">
							<p>
								Imports only templates with names that match this regular expression.
							</p>
							</td><td align="left" valign="top" headers="idm45628280386784">
							<p>
								Exports only templates with names that match this regular expression.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628280390048">
							<p>
								Force import
							</p>
							</td><td align="left" valign="top" headers="idm45628280388960">
							<p>
								<code class="literal">force</code>
							</p>
							</td><td align="left" valign="top" headers="idm45628280387872">
							<p>
								Imported templates overwrite locked templates with the same name.
							</p>
							</td><td align="left" valign="top" headers="idm45628280386784">
							<p>
								N/A
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628280390048">
							<p>
								Lock templates
							</p>
							</td><td align="left" valign="top" headers="idm45628280388960">
							<p>
								<code class="literal">lock</code>
							</p>
							</td><td align="left" valign="top" headers="idm45628280387872">
							<p>
								Do not overwrite existing templates when you import a new template with the same name, unless <span class="strong strong"><strong>Force import</strong></span> is enabled.
							</p>
							</td><td align="left" valign="top" headers="idm45628280386784">
							<p>
								N/A
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628280390048">
							<p>
								Metadata export mode
							</p>
							</td><td align="left" valign="top" headers="idm45628280388960">
							<p>
								<code class="literal">metadata_export_mode</code>
							</p>
							<p>
								Accepted values: <code class="literal">refresh</code>, <code class="literal">keep</code>, <code class="literal">remove</code>
							</p>
							</td><td align="left" valign="top" headers="idm45628280387872">
							<p>
								N/A
							</p>
							</td><td align="left" valign="top" headers="idm45628280386784">
							<p>
								Defines how metadata is handled when exporting:
							</p>
							<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<span class="strong strong"><strong>Refresh</strong></span> — remove existing metadata from the template content and generate new metadata based on current assignments and attributes.
									</li><li class="listitem">
										<span class="strong strong"><strong>Keep</strong></span> — retain the existing metadata.
									</li><li class="listitem">
										<span class="strong strong"><strong>Remove</strong></span> — export template without metadata. Useful if you want to add metadata manually.
									</li></ul></div>
							</td></tr><tr><td align="left" valign="top" headers="idm45628280390048">
							<p>
								Negate
							</p>
							</td><td align="left" valign="top" headers="idm45628280388960">
							<p>
								<code class="literal">negate</code>
							</p>
							<p>
								Accepted values: <code class="literal">true</code>, <code class="literal">false</code>
							</p>
							</td><td align="left" valign="top" headers="idm45628280387872">
							<p>
								Imports templates ignoring the filter attribute.
							</p>
							</td><td align="left" valign="top" headers="idm45628280386784">
							<p>
								Exports templates ignoring the filter attribute.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628280390048">
							<p>
								Prefix
							</p>
							</td><td align="left" valign="top" headers="idm45628280388960">
							<p>
								<code class="literal">prefix</code>
							</p>
							</td><td align="left" valign="top" headers="idm45628280387872">
							<p>
								Adds specified string to the beginning of the template if the template name does not start with the prefix already.
							</p>
							</td><td align="left" valign="top" headers="idm45628280386784">
							<p>
								N/A
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628280390048">
							<p>
								Repo
							</p>
							</td><td align="left" valign="top" headers="idm45628280388960">
							<p>
								<code class="literal">repo</code>
							</p>
							</td><td align="left" valign="top" headers="idm45628280387872">
							<p>
								Defines the path to the repository to synchronize from.
							</p>
							</td><td align="left" valign="top" headers="idm45628280386784">
							<p>
								Defines the path to a repository to export to.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628280390048">
							<p>
								Verbosity
							</p>
							</td><td align="left" valign="top" headers="idm45628280388960">
							<p>
								<code class="literal">verbose</code>
							</p>
							<p>
								Accepted values: <code class="literal">true</code>, <code class="literal">false</code>
							</p>
							</td><td align="left" valign="top" headers="idm45628280387872">
							<p>
								Enables writing verbose messages to the logs for this action.
							</p>
							</td><td align="left" valign="top" headers="idm45628280386784">
							<p>
								N/A
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="importing_and_exporting_templates"><div class="titlepage"><div><div><h2 class="title">12.3. Importing and Exporting Templates</h2></div></div></div><p>
				You can import and export templates using the Satellite web UI, Hammer CLI, or Satellite API. Satellite API calls use the role-based access control system, which enables the tasks to be executed as any user. You can synchronize templates with a version control system, such as Git, or a local directory.
			</p><section class="section" id="importing_templates"><div class="titlepage"><div><div><h3 class="title">12.3.1. Importing Templates</h3></div></div></div><p>
					You can import templates from a repository of your choice. You can use different protocols to point to your repository, for example <code class="literal">/tmp/dir</code>, <code class="literal">git://example.com</code>, <code class="literal"><a class="link" href="https://example.com">https://example.com</a></code>, and <code class="literal">ssh://example.com</code>.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Each template must contain the location and organization that the template belongs to. This applies to all template types. Before you import a template, ensure that you add the following section to the template:
						</p><pre class="screen">&lt;%#
kind: provision
name: <span class="emphasis"><em>My Kickstart File</em></span>
oses:
- RedHat 7
- RedHat 6
locations:
- <span class="emphasis"><em>First Location</em></span>
- <span class="emphasis"><em>Second Location</em></span>
organizations:
- <span class="emphasis"><em>Default Organization</em></span>
- <span class="emphasis"><em>Extra Organization</em></span>
%&gt;</pre></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Sync Templates</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Import</strong></span>.
						</li><li class="listitem">
							Each field is populated with values configured in <span class="strong strong"><strong>Administer</strong></span> &gt; <span class="strong strong"><strong>Settings</strong></span> &gt; <span class="strong strong"><strong>TemplateSync</strong></span>. Change the values as required for the templates you want to import. For more information about each field, see <a class="xref" href="#configuring-the-templatesync-plug-in" title="12.2. Configuring the TemplateSync plug-in">Section 12.2, “Configuring the TemplateSync plug-in”</a>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Submit</strong></span>.
						</li></ol></div><p>
					The Satellite web UI displays the status of the import. The status is not persistent; if you leave the status page, you cannot return to it.
				</p><div class="itemizedlist"><p class="title"><strong>For CLI Users</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To import a template from a repository, enter the following command:
						</p><pre class="screen">$ hammer import-templates \
    --prefix '[<span class="emphasis"><em>Custom Index</em></span>] ' \
    --filter '.*<span class="emphasis"><em>Template Name$</em></span>' \
    --repo <span class="emphasis"><em>https://github.com/examplerepo/exampledirectory</em></span> \
    --branch <span class="emphasis"><em>my_branch</em></span> \
    --organization 'Default Organization'</pre><p class="simpara">
							For better indexing and management of your templates, use <code class="literal">--prefix</code> to set a category for your templates. To select certain templates from a large repository, use <code class="literal">--filter</code> to define the title of the templates that you want to import. For example <code class="literal">--filter '.*Ansible Default$'</code> imports various Ansible Default templates.
						</p></li></ul></div></section><section class="section" id="exporting_templates"><div class="titlepage"><div><div><h3 class="title">12.3.2. Exporting Templates</h3></div></div></div><p>
					You can export templates to a version control server, such as a Git repository.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							In the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Sync Templates</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Export</strong></span>.
						</li><li class="listitem">
							Each field is populated with values configured in <span class="strong strong"><strong>Administer</strong></span> &gt; <span class="strong strong"><strong>Settings</strong></span> &gt; <span class="strong strong"><strong>TemplateSync</strong></span>. Change the values as required for the templates you want to export. For more information about each field, see <a class="xref" href="#configuring-the-templatesync-plug-in" title="12.2. Configuring the TemplateSync plug-in">Section 12.2, “Configuring the TemplateSync plug-in”</a>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Submit</strong></span>.
						</li></ol></div><p>
					The Satellite web UI displays the status of the export. The status is not persistent; if you leave the status page, you cannot return to it.
				</p><div class="orderedlist"><p class="title"><strong>For CLI Users</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Clone a local copy of your Git repository:
						</p><pre class="screen">$ git clone https://github.com/theforeman/community-templates <span class="emphasis"><em>/custom/templates</em></span></pre></li><li class="listitem"><p class="simpara">
							Change the owner of your local directory to the <code class="literal">foreman</code> user, and change the SELinux context with the following commands:
						</p><pre class="screen"># chown -R foreman:foreman <span class="emphasis"><em>/custom/templates</em></span>
# chcon -R -t httpd_sys_rw_content_t <span class="emphasis"><em>/custom/templates</em></span></pre></li><li class="listitem"><p class="simpara">
							To export the templates to your local repository, enter the following command:
						</p><pre class="screen">hammer export-templates --organization 'Default Organization' --repo <span class="emphasis"><em>/custom/templates</em></span></pre></li></ol></div></section><section class="section" id="synchronizing_templates_using_the_satellite_api"><div class="titlepage"><div><div><h3 class="title">12.3.3. Synchronizing Templates Using the Satellite API</h3></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Each template must contain the location and organization that the template belongs to. This applies to all template types. Before you import a template, ensure that you add the following section to the template:
						</p><pre class="screen">&lt;%#
kind: provision
name: <span class="emphasis"><em>My Kickstart File</em></span>
oses:
- RedHat 7
- RedHat 6
locations:
- <span class="emphasis"><em>First Location</em></span>
- <span class="emphasis"><em>Second Location</em></span>
organizations:
- <span class="emphasis"><em>Default Organization</em></span>
- <span class="emphasis"><em>Extra Organization</em></span>
%&gt;</pre></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Configure a version control system that uses SSH authorization, for example gitosis, gitolite, or git daemon.
						</li><li class="listitem"><p class="simpara">
							Configure the TemplateSync plug-in settings on a <span class="strong strong"><strong>TemplateSync</strong></span> tab.
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Change the <span class="strong strong"><strong>Branch</strong></span> setting to match the target branch on a Git server.
								</li><li class="listitem">
									Change the <span class="strong strong"><strong>Repo</strong></span> setting to match the Git repository. For example, for the repository located in <code class="literal">git@git.example.com/templates.git</code> set the setting into <code class="literal">ssh://git@git.example.com/templates.git</code>.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Accept Git SSH host key as the <code class="literal">foreman</code> user:
						</p><pre class="screen"># sudo -u foreman ssh <span class="emphasis"><em>git.example.com</em></span></pre><p class="simpara">
							You can see the <code class="literal">Permission denied, please try again.</code> message in the output, which is expected, because the SSH connection cannot succeed yet.
						</p></li><li class="listitem"><p class="simpara">
							Create an SSH key pair if you do not already have it. Do not specify a passphrase.
						</p><pre class="screen"># sudo -u foreman ssh-keygen</pre></li><li class="listitem">
							Configure your version control server with the public key from your Satellite, which resides in <code class="literal">/usr/share/foreman/.ssh/id_rsa.pub</code>.
						</li><li class="listitem"><p class="simpara">
							Export templates from your Satellite Server to the version control repository specified in the <span class="strong strong"><strong>TemplateSync</strong></span> menu:
						</p><pre class="screen">$ curl -H "Accept:application/json,version=2" \
-H "Content-Type:application/json" \
-u <span class="emphasis"><em>login</em></span>:<span class="emphasis"><em>password</em></span> \
-k https://<span class="emphasis"><em>satellite.example</em></span>.com/api/v2/templates/export \
-X POST

{"message":"Success"}</pre></li><li class="listitem"><p class="simpara">
							Import templates to Satellite Server after their content was changed:
						</p><pre class="screen">$ curl -H "Accept:application/json,version=2" \
-H "Content-Type:application/json" \
-u <span class="emphasis"><em>login</em></span>:<span class="emphasis"><em>password</em></span> \
-k https://<span class="emphasis"><em>satellite.example</em></span>.com/api/v2/templates/import \
-X POST

{“message”:”Success”}</pre><p class="simpara">
							Note that templates provided by Satellite are locked and you cannot import them by default. To overwrite this behavior, change the <code class="literal">Force import</code> setting in the <span class="strong strong"><strong>TemplateSync</strong></span> menu to <code class="literal">yes</code> or add the <code class="literal">force</code> parameter <code class="literal">-d '{ "force": "true" }’</code> to the import command.
						</p></li></ol></div></section><section class="section" id="synchronizing_templates_with_a_local_directory_using_the_satellite_api"><div class="titlepage"><div><div><h3 class="title">12.3.4. Synchronizing Templates with a Local Directory Using the Satellite API</h3></div></div></div><p>
					Synchronizing templates with a local directory is useful if you have configured a version control repository in the local directory. That way, you can edit templates and track the history of edits in the directory. You can also synchronize changes to Satellite Server after editing the templates.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Each template must contain the location and organization that the template belongs to. This applies to all template types. Before you import a template, ensure that you add the following section to the template:
						</p><pre class="screen">&lt;%#
kind: provision
name: <span class="emphasis"><em>My Kickstart File</em></span>
oses:
- RedHat 7
- RedHat 6
locations:
- <span class="emphasis"><em>First Location</em></span>
- <span class="emphasis"><em>Second Location</em></span>
organizations:
- <span class="emphasis"><em>Default Organization</em></span>
- <span class="emphasis"><em>Extra Organization</em></span>
%&gt;</pre></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create the directory where templates are stored and apply appropriate permissions and SELinux context:
						</p><pre class="screen"># mkdir -p <span class="emphasis"><em>/usr/share/templates_dir/</em></span>
# chown foreman <span class="emphasis"><em>/usr/share/templates_dir/</em></span>
# chcon -t httpd_sys_rw_content_t <span class="emphasis"><em>/usr/share/templates_dir/</em></span> -R</pre></li><li class="listitem">
							Change the <span class="strong strong"><strong>Repo</strong></span> setting on the <span class="strong strong"><strong>TemplateSync</strong></span> tab to match the export directory <code class="literal">/usr/share/templates_dir/</code>.
						</li><li class="listitem"><p class="simpara">
							Export templates from your Satellite Server to a local directory:
						</p><pre class="screen">$ curl -H "Accept:application/json,version=2" \
-H "Content-Type:application/json" \
-u <span class="emphasis"><em>login</em></span>:<span class="emphasis"><em>password</em></span> \
-k https://<span class="emphasis"><em>satellite.example</em></span>.com/api/v2/templates/export \
-X POST \

{"message":"Success"}</pre></li><li class="listitem"><p class="simpara">
							Import templates to Satellite Server after their content was changed:
						</p><pre class="screen">$ curl -H "Accept:application/json,version=2" \
-H "Content-Type:application/json" \
-u <span class="emphasis"><em>login</em></span>:<span class="emphasis"><em>password</em></span> \
-k https://<span class="emphasis"><em>satellite.example</em></span>.com/api/v2/templates/import \
-X POST

{“message”:”Success”}</pre><p class="simpara">
							Note that templates provided by Satellite are locked and you cannot import them by default. To overwrite this behavior, change the <code class="literal">Force import</code> setting in the <span class="strong strong"><strong>TemplateSync</strong></span> menu to <code class="literal">yes</code> or add the <code class="literal">force</code> parameter <code class="literal">-d '{ "force": "true" }’</code> to the import command.
						</p></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						You can override default API settings by specifying them in the request with the <code class="literal">-d</code> parameter. The following example exports templates to the <code class="literal">git.example.com/templates</code> repository:
					</p><pre class="screen">$ curl -H "Accept:application/json,version=2" \
-H "Content-Type:application/json" \
-u login:password \
-k https://satellite.example.com/api/v2/templates/export \
-X POST \
-d "{\"repo\":\"git.example.com/templates\"}"</pre></div></div></section></section><section class="section" id="advanced_git_configuration"><div class="titlepage"><div><div><h2 class="title">12.4. Advanced Git Configuration</h2></div></div></div><p>
				You can perform additional Git configuration for the TemplateSync plug-in using the command line or editing the <code class="literal">.gitconfig</code> file.
			</p><div class="formalpara"><p class="title"><strong>Accepting a self-signed Git certificate</strong></p><p>
					If you are using a self-signed certificate authentification on your Git server, validate the certificate with the <code class="literal">git config http.sslCAPath</code> command.
				</p></div><p>
				For example, the following command verifies a self-signed certificate stored in <code class="literal">/cert/cert.pem</code>:
			</p><pre class="screen"># sudo -u foreman git config --global http.sslCAPath <span class="emphasis"><em>cert/cert.pem</em></span></pre><p>
				For a complete list of advanced options, see the <code class="literal">git-config</code> manual page.
			</p></section><section class="section" id="uninstalling_the_plug_in"><div class="titlepage"><div><div><h2 class="title">12.5. Uninstalling the plug-in</h2></div></div></div><p>
				To avoid errors after removing the foreman_templates plugin:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Disable the plug-in using the Satellite installer:
					</p><pre class="screen"># satellite-installer --no-enable-foreman-plugin-templates</pre></li><li class="listitem"><p class="simpara">
						Clean custom data of the plug-in. The command does not affect any templates that you created.
					</p><pre class="screen"># foreman-rake templates:cleanup</pre></li><li class="listitem"><p class="simpara">
						Uninstall the plug-in:
					</p><pre class="screen"># yum remove tfm-rubygem-foreman_templates</pre></li></ol></div></section></section><section class="appendix" id="appe-Red_Hat_Satellite-Managing_Hosts-Template_Writing_Reference"><div class="titlepage"><div><div><h1 class="title">Appendix A. Template Writing Reference</h1></div></div></div><p>
			Embedded Ruby (ERB) is a tool for generating text files based on templates that combine plain text with Ruby code. Red Hat Satellite uses ERB syntax in the following cases:
		</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Provisioning templates</span></dt><dd>
						For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/provisioning_guide/configuring_provisioning_resources#Configuring_Provisioning_Resources-Creating_Provisioning_Templates">Creating Provisioning Templates</a> in the <span class="emphasis"><em>Provisioning Guide</em></span>.
					</dd><dt><span class="term">Remote execution job templates</span></dt><dd>
						For more information, see <a class="xref" href="#Running_Jobs_on_Hosts" title="Chapter 10. Running Jobs on Hosts">Chapter 10, <em>Running Jobs on Hosts</em></a>.
					</dd><dt><span class="term">Report templates</span></dt><dd>
						For more information, see <a class="xref" href="#using_report_templates" title="Chapter 7. Using Report Templates to Monitor Hosts">Chapter 7, <em>Using Report Templates to Monitor Hosts</em></a>.
					</dd><dt><span class="term">Templates for partition tables</span></dt><dd>
						For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/provisioning_guide/configuring_provisioning_resources#Configuring_Provisioning_Resources-Creating_Partition_Tables">Creating Partition Tables</a> in the <span class="emphasis"><em>Provisioning Guide</em></span>.
					</dd><dt><span class="term">Smart Variables</span></dt><dd>
						For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/puppet_guide/chap-red_hat_satellite-puppet_guide-adding_puppet_modules_to_red_hat_satellite_6#sect-Red_Hat_Satellite-Puppet_Guide-Adding_Puppet_Modules_to_Red_Hat_Satellite_6-Configuring_Smart_Variables">Configuring Smart Variables</a> in the <span class="emphasis"><em>Puppet Guide</em></span>.
					</dd><dt><span class="term">Smart Class Parameters</span></dt><dd>
						For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_satellite/6.7/html/puppet_guide/chap-red_hat_satellite-puppet_guide-adding_puppet_modules_to_red_hat_satellite_6#sect-Red_Hat_Satellite-Puppet_Guide-Adding_Puppet_Modules_to_Red_Hat_Satellite_6-Configuring_Smart_Class_Parameters">Configuring Smart Class Parameters</a> in the <span class="emphasis"><em>Puppet Guide</em></span>.
					</dd></dl></div><p>
			This section provides an overview of Satellite-specific macros and variables that can be used in ERB templates along with some usage examples. Note that the default templates provided by Red Hat Satellite (<span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Provisioning templates</strong></span>, <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Job templates</strong></span>, <span class="strong strong"><strong>Monitor</strong></span> &gt; <span class="strong strong"><strong>Report Templates</strong></span> ) also provide a good source of ERB syntax examples.
		</p><p>
			When provisioning a host or running a remote job, the code in the ERB is executed and the variables are replaced with the host specific values. This process is referred to as <span class="strong strong"><strong>rendering</strong></span>. The Satellite Server has the safemode rendering option enabled by default, which prevents any harmful code being executed from templates.
		</p><section class="section" id="sect-Managing_Hosts-Writing_ERB_Templates"><div class="titlepage"><div><div><h2 class="title">A.1. Writing ERB Templates</h2></div></div></div><p>
				The following tags are the most important and commonly used in ERB templates:
			</p><div class="formalpara"><p class="title"><strong>&lt;% %&gt;</strong></p><p>
					All Ruby code is enclosed within <code class="literal">&lt;% %&gt;</code> in an ERB template. The code is executed when the template is rendered. It can contain Ruby control flow structures as well as Satellite-specific macros and variables. For example:
				</p></div><pre class="screen">&lt;% if @host.operatingsystem.family == "Redhat" &amp;&amp; @host.operatingsystem.major.to_i &gt; 6 -%&gt;
systemctl &lt;%= input("action") %&gt; &lt;%= input("service") %&gt;
&lt;% else -%&gt;
service &lt;%= input("service") %&gt; &lt;%= input("action") %&gt;
&lt;% end -%&gt;</pre><p>
				Note that this template silently performs an action with a service and returns nothing at the output.
			</p><div class="formalpara"><p class="title"><strong>&lt;%= %&gt;</strong></p><p>
					This provides the same functionality as <code class="literal">&lt;% %&gt;</code> but when the template is executed, the code output is inserted into the template. This is useful for variable substitution, for example:
				</p></div><p>
				Example input:
			</p><pre class="screen">echo &lt;%= @host.name %&gt;</pre><p>
				Example rendering:
			</p><pre class="screen"><span class="emphasis"><em>host.example.com</em></span></pre><p>
				Example input:
			</p><pre class="screen">&lt;% server_name = @host.fqdn %&gt;
&lt;%= server_name %&gt;</pre><p>
				Example rendering:
			</p><pre class="screen"><span class="emphasis"><em>host.example.com</em></span></pre><p>
				Note that if you enter an incorrect variable, no output is returned. However, if you try to call a method on an incorrect variable, the following error message returns:
			</p><p>
				Example input:
			</p><pre class="screen">&lt;%= @<span class="emphasis"><em>example_incorrect_variable</em></span>.fqdn -%&gt;</pre><p>
				Example rendering:
			</p><pre class="screen">undefined method `fqdn' for nil:NilClass</pre><div class="formalpara"><p class="title"><strong>&lt;% -%&gt;, &lt;%= -%&gt;</strong></p><p>
					By default, a newline character is inserted after a Ruby block if it is closed at the end of a line:
				</p></div><p>
				Example input:
			</p><pre class="screen">&lt;%= "line1" %&gt;
&lt;%= "line2" %&gt;</pre><p>
				Example rendering:
			</p><pre class="screen">line1
line2</pre><p>
				To change the default behavior, modify the enclosing mark with <code class="literal">-%&gt;</code>:
			</p><p>
				Example input:
			</p><pre class="screen">&lt;%= "line1" -%&gt;
&lt;%= "line2" %&gt;</pre><p>
				Example rendering:
			</p><pre class="screen">line1line2</pre><p>
				This is used to reduce the number of lines, where Ruby syntax permits, in rendered templates. White spaces in ERB tags are ignored.
			</p><p>
				An example of how this would be used in a report template to remove unnecessary newlines between a FQDN and IP address:
			</p><p>
				Example input:
			</p><pre class="screen">&lt;%= @host.fqdn -%&gt;
&lt;%= @host.ip -%&gt;</pre><p>
				Example rendering:
			</p><pre class="screen"><span class="emphasis"><em>host.example.com10.10.181.216</em></span></pre><div class="formalpara"><p class="title"><strong>&lt;%# %&gt;</strong></p><p>
					Encloses a comment that is ignored during template rendering:
				</p></div><p>
				Example input:
			</p><pre class="screen">&lt;%# A comment %&gt;</pre><p>
				This generates no output.
			</p><div class="formalpara"><p class="title"><strong>Indentation in ERB templates</strong></p><p>
					Because of the varying lengths of the ERB tags, indenting the ERB syntax might seem messy. ERB syntax ignore white space. One method of handling the indentation is to declare the ERB tag at the beginning of each new line and then use white space within the ERB tag to outline the relationships within the syntax, for example:
				</p></div><pre class="screen">&lt;%- load_hosts.each do |host| -%&gt;
&lt;%-   if host.build? %&gt;
&lt;%=     host.name %&gt; build is in progress
&lt;%-   end %&gt;
&lt;%- end %&gt;</pre></section><section class="section" id="sect-Managing_Hosts-Troubleshooting_ERB_Templates"><div class="titlepage"><div><div><h2 class="title">A.2. Troubleshooting ERB Templates</h2></div></div></div><p>
				The Satellite web UI provides two ways to verify the template rendering for a specific host:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>Directly in the template editor</strong></span> – when editing a template (under <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Partition tables</strong></span>, <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Provisioning templates</strong></span>, or <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Job templates</strong></span>), on the <span class="strong strong"><strong>Template</strong></span> tab click <span class="strong strong"><strong>Preview</strong></span> and select a host from the list. The template then renders in the text field using the selected host’s parameters. Preview failures can help to identify issues in your template.
					</li><li class="listitem">
						<span class="strong strong"><strong>At the host’s details page</strong></span> – select a host at <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>All hosts</strong></span> and click the <span class="strong strong"><strong>Templates</strong></span> tab to list templates associated with the host. Select <span class="strong strong"><strong>Review</strong></span> from the list next to the selected template to view it’s rendered version.
					</li></ul></div></section><section class="section" id="sect-Managing_Hosts-Satellite_Specific_macros_and_Variables"><div class="titlepage"><div><div><h2 class="title">A.3. Generic Satellite-Specific Macros</h2></div></div></div><p>
				This section lists Satellite-specific macros for ERB templates.
			</p><p>
				You can use the macros listed in the following table across all kinds of templates.
			</p><div class="table" id="tabl-Red_Hat_Satellite-Managing_Hosts-Generic_Macros"><p class="title"><strong>Table A.1. Generic Macros</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45628284534144" scope="col">Name</th><th align="left" valign="top" id="idm45628284533056" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45628284534144">
							<p>
								indent(n)
							</p>
							</td><td align="left" valign="top" headers="idm45628284533056">
							<p>
								Indents the block of code by n spaces, useful when using a snippet template that is not indented.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628284534144">
							<p>
								foreman_url(kind)
							</p>
							</td><td align="left" valign="top" headers="idm45628284533056">
							<p>
								Returns the full URL to host-rendered templates of the given kind. For example, templates of the "provision" type usually reside at <span class="strong strong"><strong><a class="link" href="http://HOST/unattended/provision">http://HOST/unattended/provision</a></strong></span>.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628284534144">
							<p>
								snippet(name)
							</p>
							</td><td align="left" valign="top" headers="idm45628284533056">
							<p>
								Renders the specified snippet template. Useful for nesting provisioning templates.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628284534144">
							<p>
								snippets(file)
							</p>
							</td><td align="left" valign="top" headers="idm45628284533056">
							<p>
								Renders the specified snippet found in the Foreman database, attempts to load it from the <span class="strong strong"><strong>unattended/snippets/</strong></span> directory if it is not found in the database.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628284534144">
							<p>
								snippet_if_exists(name)
							</p>
							</td><td align="left" valign="top" headers="idm45628284533056">
							<p>
								Renders the specified snippet, skips if no snippet with the specified name is found.
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="ref_template_macros"><div class="titlepage"><div><div><h2 class="title">A.4. Templates Macros</h2></div></div></div><p>
				If you want to write custom templates, you can use some of the following macros.
			</p><p>
				Depending on the template type, some of the following macros have different requirements.
			</p><p>
				For more information about the available macros for report templates, in the Satellite web UI, navigate to <span class="strong strong"><strong>Monitor</strong></span> &gt; <span class="strong strong"><strong>Report Templates</strong></span>, and click <span class="strong strong"><strong>Create Template</strong></span>. In the Create Template window, click the <span class="strong strong"><strong>Help</strong></span> tab.
			</p><p>
				For more information about the available macros for job templates, in the Satellite web UI, navigate to <span class="strong strong"><strong>Hosts</strong></span> &gt; <span class="strong strong"><strong>Job Templates</strong></span>, and click the <span class="strong strong"><strong>New Job Template</strong></span>. In the New Job Template window, click the <span class="strong strong"><strong>Help</strong></span> tab.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">input</span></dt><dd><p class="simpara">
							Using the <code class="literal">input</code> macro, you can customize the input data that the template can work with. You can define the input name, type, and the options that are available for users. For report templates, you can only use user inputs. When you define a new input and save the template, you can then reference the input in the ERB syntax of the template body.
						</p><pre class="screen">&lt;%= input('cpus') %&gt;</pre><p class="simpara">
							This loads the value from user input <code class="literal">cpus</code>.
						</p></dd><dt><span class="term">load_hosts</span></dt><dd><p class="simpara">
							Using the <code class="literal">load_hosts</code> macro, you can generate a complete list of hosts.
						</p><pre class="screen">&lt;%- load_hosts().each_record do |host| -%&gt;
&lt;%=     host.name %&gt;</pre><p class="simpara">
							Use the <code class="literal">load_hosts</code> macro with the <code class="literal">each_record</code> macro to load records in batches of 1000 to reduce memory consumption.
						</p><p class="simpara">
							If you want to filter the list of hosts for the report, you can add the option <code class="literal">search: input(‘<span class="emphasis"><em>Example_Host</em></span>’)</code>:
						</p><pre class="screen">&lt;% load_hosts(search: input('<span class="emphasis"><em>Example_Host</em></span>')).each_record do |host| -%&gt;
&lt;%=  host.name %&gt;
&lt;% end -%&gt;</pre><p class="simpara">
							In this example, you first create an input that you then use to refine the search criteria that the <code class="literal">load_hosts</code> macro retrieves.
						</p></dd><dt><span class="term">report_row</span></dt><dd><p class="simpara">
							Using the <code class="literal">report_row</code> macro, you can create a formatted report for ease of analysis. The <code class="literal">report_row</code> macro requires the <code class="literal">report_render</code> macro to generate the output.
						</p><div class="formalpara"><p class="title"><strong>Example input:</strong></p><p>
								
<pre class="screen">&lt;%- load_hosts(search: input('<span class="emphasis"><em>Example_Host</em></span>')).each_record do |host| -%&gt;
&lt;%-   report_row(
        'Server FQDN': host.name
      ) -%&gt;
&lt;%- end -%&gt;
&lt;%= report_render -%&gt;</pre>
							</p></div><div class="formalpara"><p class="title"><strong>Example rendering:</strong></p><p>
								
<pre class="screen">Server FQDN
<span class="emphasis"><em>host1.example.com</em></span>
<span class="emphasis"><em>host2.example.com</em></span>
<span class="emphasis"><em>host3.example.com</em></span>
<span class="emphasis"><em>host4.example.com</em></span>
<span class="emphasis"><em>host5.example.com</em></span>
<span class="emphasis"><em>host6.example.com</em></span></pre>
							</p></div><p class="simpara">
							You can add extra columns to the report by adding another header. The following example adds IP addresses to the report:
						</p><div class="formalpara"><p class="title"><strong>Example input:</strong></p><p>
								
<pre class="screen">&lt;%- load_hosts(search: input('host')).each_record do |host| -%&gt;
&lt;%-   report_row(
      'Server FQDN': host.name,
           'IP': host.ip
      ) -%&gt;
&lt;%- end -%&gt;
&lt;%= report_render -%&gt;</pre>
							</p></div><div class="formalpara"><p class="title"><strong>Example rendering:</strong></p><p>
								
<pre class="screen">Server FQDN,IP
<span class="emphasis"><em>host1.example.com</em></span>,<span class="emphasis"><em>10.8.30.228</em></span>
<span class="emphasis"><em>host2.example.com</em></span>,<span class="emphasis"><em>10.8.30.227</em></span>
<span class="emphasis"><em>host3.example.com</em></span>,<span class="emphasis"><em>10.8.30.226</em></span>
<span class="emphasis"><em>host4.example.com</em></span>,<span class="emphasis"><em>10.8.30.225</em></span>
<span class="emphasis"><em>host5.example.com</em></span>,<span class="emphasis"><em>10.8.30.224</em></span>
<span class="emphasis"><em>host6.example.com</em></span>,<span class="emphasis"><em>10.8.30.223</em></span></pre>
							</p></div></dd><dt><span class="term">report_render</span></dt><dd><p class="simpara">
							This macro is available only for report templates.
						</p><p class="simpara">
							Using the <code class="literal">report_render</code> macro, you create the output for the report. During the template rendering process, you can select the format that you want for the report. YAML, JSON, HTML, and CSV formats are supported.
						</p><pre class="screen">&lt;%= report_render -%&gt;</pre></dd><dt><span class="term">render_template()</span></dt><dd><p class="simpara">
							This macro is available only for job templates.
						</p><p class="simpara">
							Using this macro, you can render a specific template. You can also enable and define arguments that you want to pass to the template.
						</p></dd></dl></div></section><section class="section" id="ref_host_specific_variables_for_templates"><div class="titlepage"><div><div><h2 class="title">A.5. Host-Specific Variables</h2></div></div></div><p>
				The following variables enable using host data within templates. Note that job templates accept only <code class="literal">@host</code> variables.
			</p><div class="table" id="tabl-Red_Hat_Satellite-Managing_Hosts-Variables"><p class="title"><strong>Table A.2. Host Specific Variables and Macros</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45628282012800" scope="col">Name</th><th align="left" valign="top" id="idm45628282011712" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.architecture
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The architecture of the host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.bond_interfaces
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns an array of all bonded interfaces. See <a class="xref" href="#ref_working_with_arrays" title="A.8. Parsing Arrays">Section A.8, “Parsing Arrays”</a>.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.capabilities
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The method of system provisioning, can be either build (for example kickstart) or image.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.certname
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The SSL certificate name of the host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.diskLayout
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The disk layout of the host. Can be inherited from the operating system.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.domain
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The domain of the host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.environment
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The Puppet environment of the host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.facts
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns a Ruby hash of facts from Facter. For example to access the 'ipaddress' fact from the output, specify @host.facts['ipaddress'].
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.grub_pass
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns the host’s GRUB password.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.hostgroup
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The host group of the host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								host_enc['parameters']
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns a Ruby hash containing information on host parameters. For example, use host_enc['parameters']['lifecycle_environment'] to get the life cycle environment of a host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.image_build?
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns <code class="literal">true</code> if the host is provisioned using an image.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.interfaces
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Contains an array of all available host interfaces including the primary interface. See <a class="xref" href="#ref_working_with_arrays" title="A.8. Parsing Arrays">Section A.8, “Parsing Arrays”</a>.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.interfaces_with_identifier('IDs')
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns array of interfaces with given identifier. You can pass an array of multiple identifiers as an input, for example @host.interfaces_with_identifier(['eth0', 'eth1']). See <a class="xref" href="#ref_working_with_arrays" title="A.8. Parsing Arrays">Section A.8, “Parsing Arrays”</a>.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.ip
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The IP address of the host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.location
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The location of the host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.mac
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The MAC address of the host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.managed_interfaces
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns an array of managed interfaces (excluding BMC and bonded interfaces). See <a class="xref" href="#ref_working_with_arrays" title="A.8. Parsing Arrays">Section A.8, “Parsing Arrays”</a>.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.medium
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The assigned operating system installation medium.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.name
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The full name of the host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.operatingsystem.family
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The operating system family.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.operatingsystem.major
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The major version number of the assigned operating system.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.operatingsystem.minor
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The minor version number of the assigned operating system.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.operatingsystem.name
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The assigned operating system name.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.operatingsystem.boot_files_uri(medium_provider)
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Full path to the kernel and initrd, returns an array.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.os.medium_uri(@host)
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The URI used for provisioning (path configured in installation media).
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								host_param('parameter_name')
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns the value of the specified host parameter.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								host_param_false?('parameter_name')
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns <code class="literal">false</code> if the specified host parameter evaluates to false.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								host_param_true?('parameter_name')
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns <code class="literal">true</code> if the specified host parameter evaluates to true.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.primary_interface
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns the primary interface of the host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.provider
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The compute resource provider.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.provision_interface
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns the provisioning interface of the host. Returns an interface object.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.ptable
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The partition table name.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.puppet_ca_server
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The Puppet CA server the host must use.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.puppetmaster
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The Puppet master the host must use.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.pxe_build?
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns <code class="literal">true</code> if the host is provisioned using the network or PXE.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.shortname
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The short name of the host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.sp_ip
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The IP address of the BMC interface.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.sp_mac
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The MAC address of the BMC interface.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.sp_name
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The name of the BMC interface.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.sp_subnet
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The subnet of the BMC network.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.subnet.dhcp
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns <code class="literal">true</code> if a DHCP proxy is configured for this host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.subnet.dns_primary
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The primary DNS server of the host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.subnet.dns_secondary
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The secondary DNS server of the host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.subnet.gateway
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The gateway of the host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.subnet.mask
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								The subnet mask of the host.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.url_for_boot(:initrd)
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Full path to the initrd image associated with this host. Not recommended, as it does not interpolate variables.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@host.url_for_boot(:kernel)
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Full path to the kernel associated with this host. Not recommended, as it does not interpolate variables, prefer boot_files_uri.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@provisioning_type
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Equals to 'host' or 'hostgroup' depending on type of provisioning.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@static
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns <code class="literal">true</code> if the network configuration is static.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								@template_name
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Name of the template being rendered.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								grub_pass
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns the GRUB password wrapped in md5pass argument, that is <span class="strong strong"><strong>--md5pass=#{@host.grub_pass}</strong></span>.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								ks_console
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns a string assembled using the port and the baud rate of the host which can be added to a kernel line. For example <span class="strong strong"><strong>console=ttyS1,9600</strong></span>.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628282012800">
							<p>
								root_pass
							</p>
							</td><td align="left" valign="top" headers="idm45628282011712">
							<p>
								Returns the root password configured for the system.
							</p>
							</td></tr></tbody></table></div></div><p>
				The majority of common Ruby methods can be applied on host-specific variables. For example, to extract the last segment of the host’s IP address, you can use:
			</p><pre class="screen">&lt;% @host.ip.split('.').last %&gt;</pre></section><section class="section" id="ref_kickstart_specific_variables"><div class="titlepage"><div><div><h2 class="title">A.6. Kickstart-Specific Variables</h2></div></div></div><p>
				The following variables are designed to be used within kickstart provisioning templates.
			</p><div class="table" id="tabl-Red_Hat_Satellite-Managing_Hosts-Kickstart_Variables"><p class="title"><strong>Table A.3. Kickstart Specific Variables</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm45628280340240" scope="col">Name</th><th align="left" valign="top" id="idm45628280339152" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45628280340240">
							<p>
								@arch
							</p>
							</td><td align="left" valign="top" headers="idm45628280339152">
							<p>
								The host architecture name, same as @host.architecture.name.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628280340240">
							<p>
								@dynamic
							</p>
							</td><td align="left" valign="top" headers="idm45628280339152">
							<p>
								Returns <code class="literal">true</code> if the partition table being used is a %pre script (has the #Dynamic option as the first line of the table).
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628280340240">
							<p>
								@epel
							</p>
							</td><td align="left" valign="top" headers="idm45628280339152">
							<p>
								A command which will automatically install the correct version of the epel-release rpm. Use in a %post script.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628280340240">
							<p>
								@mediapath
							</p>
							</td><td align="left" valign="top" headers="idm45628280339152">
							<p>
								The full kickstart line to provide the URL command.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45628280340240">
							<p>
								@osver
							</p>
							</td><td align="left" valign="top" headers="idm45628280339152">
							<p>
								The operating system major version number, same as @host.operatingsystem.major.
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="ref_writing_conditional_statements"><div class="titlepage"><div><div><h2 class="title">A.7. Conditional Statements</h2></div></div></div><p>
				In your templates, you might perform different actions depending on which value exists. To achieve this, you can use conditional statements in your ERB syntax.
			</p><p>
				In the following example, the ERB syntax searches for a specific host name and returns an output depending on the value it finds:
			</p><p>
				Example input:
			</p><pre class="screen">&lt;% load_hosts().each_record do |host| -%&gt;
&lt;% if @host.name == "<span class="emphasis"><em>host1.example.com</em></span>" -%&gt;
&lt;%      result="positive" -%&gt;
&lt;%  else -%&gt;
&lt;%      result="negative" -%&gt;
&lt;%  end -%&gt;
&lt;%= result -%&gt;</pre><p>
				Example rendering:
			</p><pre class="screen"><span class="emphasis"><em>host1.example.com</em></span>
positive</pre></section><section class="section" id="ref_working_with_arrays"><div class="titlepage"><div><div><h2 class="title">A.8. Parsing Arrays</h2></div></div></div><p>
				While writing or modifying templates, you might encounter variables that return arrays. For example, host variables related to network interfaces, such as <code class="literal">@host.interfaces</code> or <code class="literal">@host.bond_interfaces</code>, return interface data grouped in an array. To extract a parameter value of a specific interface, use Ruby methods to parse the array.
			</p><div class="formalpara"><p class="title"><strong>Finding the Correct Method to Parse an Array</strong></p><p>
					The following procedure is an example that you can use to find the relevant methods to parse arrays in your template. In this example, a report template is used, but the steps are applicable to other templates.
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To retrieve the NIC of a content host, in this example, using the <code class="literal">@host.interfaces</code> variable returns class values that you can then use to find methods to parse the array.
					</p><div class="formalpara"><p class="title"><strong>Example input:</strong></p><p>
							
<pre class="screen">&lt;%= @host.interfaces -%&gt;</pre>
						</p></div><div class="formalpara"><p class="title"><strong>Example rendering:</strong></p><p>
							
<pre class="screen">&lt;Nic::Base::ActiveRecord_Associations_CollectionProxy:0x00007f734036fbe0&gt;</pre>
						</p></div></li><li class="listitem">
						In the Create Template window, click the <span class="strong strong"><strong>Help</strong></span> tab and search for the <code class="literal">ActiveRecord_Associations_CollectionProxy</code> and <code class="literal">Nic::Base</code> classes.
					</li><li class="listitem"><p class="simpara">
						For <code class="literal">ActiveRecord_Associations_CollectionProxy</code>, in the <span class="strong strong"><strong>Allowed methods or members</strong></span> column, you can view the following methods to parse the array:
					</p><pre class="screen">[] each find_in_batches first map size to_a</pre></li><li class="listitem"><p class="simpara">
						For <code class="literal">Nic::Base</code>, in the <span class="strong strong"><strong>Allowed methods or members</strong></span> column, you can view the following method to parse the array:
					</p><pre class="screen">alias? attached_devices attached_devices_identifiers attached_to bond_options children_mac_addresses domain fqdn identifier inheriting_mac ip ip6 link mac managed? mode mtu nic_delay physical? primary provision shortname subnet subnet6 tag virtual? vlanid</pre></li><li class="listitem"><p class="simpara">
						To iterate through an interface array, add the relevant methods to the ERB syntax:
					</p><div class="formalpara"><p class="title"><strong>Example input:</strong></p><p>
							
<pre class="screen">&lt;% load_hosts().each_record do |host| -%&gt;
&lt;%    host.interfaces.each do |iface| -%&gt;
  iface.alias?: &lt;%= iface.alias? %&gt;
  iface.attached_to: &lt;%= iface.attached_to %&gt;
  iface.bond_options: &lt;%= iface.bond_options %&gt;
  iface.children_mac_addresses: &lt;%= iface.children_mac_addresses %&gt;
  iface.domain: &lt;%= iface.domain %&gt;
  iface.fqdn: &lt;%= iface.fqdn %&gt;
  iface.identifier: &lt;%= iface.identifier %&gt;
  iface.inheriting_mac: &lt;%= iface.inheriting_mac %&gt;
  iface.ip: &lt;%= iface.ip %&gt;
  iface.ip6: &lt;%= iface.ip6 %&gt;
  iface.link: &lt;%= iface.link %&gt;
  iface.mac: &lt;%= iface.mac %&gt;
  iface.managed?: &lt;%= iface.managed? %&gt;
  iface.mode: &lt;%= iface.mode %&gt;
  iface.mtu: &lt;%= iface.mtu %&gt;
  iface.physical?: &lt;%= iface.physical? %&gt;
  iface.primary: &lt;%= iface.primary %&gt;
  iface.provision: &lt;%= iface.provision %&gt;
  iface.shortname: &lt;%= iface.shortname %&gt;
  iface.subnet: &lt;%= iface.subnet %&gt;
  iface.subnet6: &lt;%= iface.subnet6 %&gt;
  iface.tag: &lt;%= iface.tag %&gt;
  iface.virtual?: &lt;%= iface.virtual? %&gt;
  iface.vlanid: &lt;%= iface.vlanid %&gt;
&lt;%- end -%&gt;</pre>
						</p></div><div class="formalpara"><p class="title"><strong>Example rendering:</strong></p><p>
							
<pre class="screen"><span class="emphasis"><em>host1.example.com</em></span>
  iface.alias?: false
  iface.attached_to:
  iface.bond_options:
  iface.children_mac_addresses: []
  iface.domain:
  iface.fqdn: <span class="emphasis"><em>host1.example.com</em></span>
  iface.identifier: ens192
  iface.inheriting_mac: 00:50:56:8d:4c:cf
  iface.ip: 10.10.181.13
  iface.ip6:
  iface.link: true
  iface.mac: 00:50:56:8d:4c:cf
  iface.managed?: true
  iface.mode: balance-rr
  iface.mtu:
  iface.physical?: true
  iface.primary: true
  iface.provision: true
  iface.shortname: <span class="emphasis"><em>host1.example.com</em></span>
  iface.subnet:
  iface.subnet6:
  iface.tag:
  iface.virtual?: false
  iface.vlanid:</pre>
						</p></div></li></ol></div></section><section class="section" id="ref_example_template_snippets"><div class="titlepage"><div><div><h2 class="title">A.9. Example Template Snippets</h2></div></div></div><div class="formalpara"><p class="title"><strong>Checking if a Host Has Puppet and Puppetlabs Enabled</strong></p><p>
					The following example checks if the host has the Puppet and Puppetlabs repositories enabled:
				</p></div><pre class="screen">&lt;%
pm_set = @host.puppetmaster.empty? ? false : true
puppet_enabled = pm_set || host_param_true?('force-puppet')
puppetlabs_enabled = host_param_true?('enable-puppetlabs-repo')
%&gt;</pre><div class="formalpara"><p class="title"><strong>Capturing Major and Minor Versions of a Host’s Operating System</strong></p><p>
					The following example shows how to capture the minor and major version of the host’s operating system, which can be used for package related decisions:
				</p></div><pre class="screen">&lt;%
os_major = @host.operatingsystem.major.to_i
os_minor = @host.operatingsystem.minor.to_i
%&gt;

&lt;% if ((os_minor &lt; 2) &amp;&amp; (os_major &lt; 14)) -%&gt;
...
&lt;% end -%&gt;</pre><div class="formalpara"><p class="title"><strong>Importing Snippets to a Template</strong></p><p>
					The following example imports the <span class="strong strong"><strong>subscription_manager_registration</strong></span> snippet to the template and indents it by four spaces:
				</p></div><pre class="screen">&lt;%= indent 4 do
snippet 'subscription_manager_registration'
end %&gt;</pre><div class="formalpara"><p class="title"><strong>Conditionally Importing a Kickstart Snippet</strong></p><p>
					The following example imports the <code class="literal">kickstart_networking_setup</code> snippet if the host’s subnet has the DHCP boot mode enabled:
				</p></div><pre class="screen">&lt;% subnet = @host.subnet %&gt;
&lt;% if subnet.respond_to?(:dhcp_boot_mode?) -%&gt;
&lt;%= snippet 'kickstart_networking_setup' %&gt;
&lt;% end -%&gt;</pre><div class="formalpara"><p class="title"><strong>Parsing Values from Host Custom Facts</strong></p><p>
					You can use the <code class="literal">host.facts</code> variable to parse values from a host’s facts and custom facts.
				</p></div><p>
				In this example <code class="literal">luks_stat</code> is a custom fact that you can parse in the same manner as <code class="literal">dmi::system::serial_number</code>, which is a host fact:
			</p><pre class="screen">'Serial': host.facts['dmi::system::serial_number'],
'Encrypted': host.facts['luks_stat'],</pre><p>
				In this example, you can customize the Applicable Errata report template to parse for custom information about the kernel version of each host:
			</p><pre class="screen">&lt;%-     report_row(
          'Host': host.name,
          'Operating System': host.operatingsystem,
          'Kernel': host.facts['uname::release'],
          'Environment': host.lifecycle_environment,
          'Erratum': erratum.errata_id,
          'Type': erratum.errata_type,
          'Published': erratum.issued,
          'Applicable since': erratum.created_at,
          'Severity': erratum.severity,
          'Packages': erratum.package_names,
          'CVEs': erratum.cves,
          'Reboot suggested': erratum.reboot_suggested,
        ) -%&gt;</pre></section></section><section class="appendix" id="appe-Red_Hat_Satellite-Managing_Hosts-Host_Management_without_Goferd"><div class="titlepage"><div><div><h1 class="title">Appendix B. Host Management Without Goferd</h1></div></div></div><p>
			If you manage errata and package management through remote execution, you can disable the <span class="strong strong"><strong>goferd</strong></span> service to reduce memory and CPU load on content hosts.
		</p><p>
			The Satellite Tools repository provides <code class="literal">katello-host-tools</code>, which provides communication services for managing Errata.
		</p><section class="section" id="sect-Red_Hat_Satellite-Managing_Hosts-Host_Management_without_Goferd-Prerequisites"><div class="titlepage"><div><div><h2 class="title">B.1. Prerequisites</h2></div></div></div><p>
				The following must be made on all content hosts to allow host management by remote execution.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Ensure that the <code class="literal">katello-host-tools</code> package is installed:
					</p><pre class="screen"># yum install katello-host-tools</pre></li><li class="listitem"><p class="simpara">
						Stop the goferd service:
					</p><pre class="screen"># systemctl stop goferd.service</pre></li><li class="listitem"><p class="simpara">
						Disable the goferd service:
					</p><pre class="screen"># systemctl disable goferd.service</pre></li><li class="listitem">
						Distribute the SSH keys to the content hosts by following <a class="xref" href="#sect-Managing_Hosts-Establishing_a_Secure_Connection_for_Remote_Commands" title="10.3. Distributing SSH Keys for Remote Execution">Section 10.3, “Distributing SSH Keys for Remote Execution”</a>.
					</li></ul></div></section><section class="section" id="sect-Red_Hat_Satellite-Managing_Hosts-Host_Management_without_Goferd-Making_Host_Management_without_Goferd_the_System_Default"><div class="titlepage"><div><div><h2 class="title">B.2. Configuring Host Management Without Goferd as the System Default</h2></div></div></div><p>
				These steps configure host management to use remote execution as the system default for future package deployments.
			</p><div class="orderedlist" id="proc-Red_Hat_Satellite-Managing_Hosts-Host_Management_without_Goferd-To_Make_Host_Management_without_Goferd_the_System_Default"><p class="title"><strong>To Configure Host Management Without Goferd as the System Default:</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log in to the Satellite web UI.
					</li><li class="listitem">
						Navigate to <span class="strong strong"><strong>Administer</strong></span> &gt; <span class="strong strong"><strong>Settings</strong></span>.
					</li><li class="listitem">
						Select the <span class="strong strong"><strong>Content</strong></span> tab.
					</li><li class="listitem">
						Set the <span class="strong strong"><strong>Use remote execution by default</strong></span> parameter to <span class="strong strong"><strong>Yes</strong></span>.
					</li></ol></div><p>
				The Satellite server now uses host management by remote execution instead of goferd.
			</p></section><section class="section" id="sect-Red_Hat_Satellite-Managing_Hosts-Host_Management_without_Goferd-Limitations_with_Hammer"><div class="titlepage"><div><div><h2 class="title">B.3. Limitations with Hammer</h2></div></div></div><p>
				The following applies if you are using the <code class="literal">hammer</code> command to push errata. The <code class="literal">hammer</code> command is dependent on goferd to manage errata on content hosts. As a workaround, use Satellite’s remote execution feature to apply errata.
			</p><div id="proc-Red_Hat_Satellite-Managing_Hosts-Host_Management_without_Goferd-To_Use_Hammer_remote_execution_commands" class="formalpara"><p class="title"><strong>To Use Hammer Remote Execution Commands:</strong></p><p>
					For example, perform a <code class="literal">yum -y update</code> on <span class="emphasis"><em>host123.example.org</em></span>:
				</p></div><pre class="screen"># hammer job-invocation create \
--job-template "Run Command - SSH Default" \
--inputs command="yum -y update" \
--search-query "name ~ host123"
Job invocation 24 created
[.........................................] [100%]
1 task(s), 1 success, 0 fail</pre></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm45628280709504"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"/>© 2020 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></div></div><script type="text/javascript">
                        jQuery(document).ready(function() {
                            initSwitchery();
                            jQuery('pre[class*="language-"]').each(function(i, block){hljs.highlightBlock(block);});
                        });
                    </script></body></html>